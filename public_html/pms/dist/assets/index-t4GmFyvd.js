(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),r}var _d={exports:{}},Ra={},jd={exports:{}},X={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mn=Symbol.for("react.element"),pm=Symbol.for("react.portal"),gm=Symbol.for("react.fragment"),xm=Symbol.for("react.strict_mode"),ym=Symbol.for("react.profiler"),vm=Symbol.for("react.provider"),wm=Symbol.for("react.context"),bm=Symbol.for("react.forward_ref"),_m=Symbol.for("react.suspense"),jm=Symbol.for("react.memo"),Nm=Symbol.for("react.lazy"),Bl=Symbol.iterator;function km(t){return t===null||typeof t!="object"?null:(t=Bl&&t[Bl]||t["@@iterator"],typeof t=="function"?t:null)}var Nd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kd=Object.assign,Sd={};function ms(t,e,r){this.props=t,this.context=e,this.refs=Sd,this.updater=r||Nd}ms.prototype.isReactComponent={};ms.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ms.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Cd(){}Cd.prototype=ms.prototype;function Bo(t,e,r){this.props=t,this.context=e,this.refs=Sd,this.updater=r||Nd}var qo=Bo.prototype=new Cd;qo.constructor=Bo;kd(qo,ms.prototype);qo.isPureReactComponent=!0;var ql=Array.isArray,Ed=Object.prototype.hasOwnProperty,Ho={current:null},Td={key:!0,ref:!0,__self:!0,__source:!0};function Dd(t,e,r){var s,a={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Ed.call(e,s)&&!Td.hasOwnProperty(s)&&(a[s]=e[s]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)a[s]===void 0&&(a[s]=l[s]);return{$$typeof:mn,type:t,key:i,ref:o,props:a,_owner:Ho.current}}function Sm(t,e){return{$$typeof:mn,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vo(t){return typeof t=="object"&&t!==null&&t.$$typeof===mn}function Cm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Hl=/\/+/g;function ti(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cm(""+t.key):e.toString(36)}function Bn(t,e,r,s,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case mn:case pm:o=!0}}if(o)return o=t,a=a(o),t=s===""?"."+ti(o,0):s,ql(a)?(r="",t!=null&&(r=t.replace(Hl,"$&/")+"/"),Bn(a,e,r,"",function(d){return d})):a!=null&&(Vo(a)&&(a=Sm(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Hl,"$&/")+"/")+t)),e.push(a)),1;if(o=0,s=s===""?".":s+":",ql(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+ti(i,l);o+=Bn(i,e,r,c,a)}else if(c=km(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+ti(i,l++),o+=Bn(i,e,r,c,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bn(t,e,r){if(t==null)return t;var s=[],a=0;return Bn(t,s,"","",function(i){return e.call(r,i,a++)}),s}function Em(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Be={current:null},qn={transition:null},Tm={ReactCurrentDispatcher:Be,ReactCurrentBatchConfig:qn,ReactCurrentOwner:Ho};function Rd(){throw Error("act(...) is not supported in production builds of React.")}X.Children={map:bn,forEach:function(t,e,r){bn(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return bn(t,function(){e++}),e},toArray:function(t){return bn(t,function(e){return e})||[]},only:function(t){if(!Vo(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};X.Component=ms;X.Fragment=gm;X.Profiler=ym;X.PureComponent=Bo;X.StrictMode=xm;X.Suspense=_m;X.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tm;X.act=Rd;X.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=kd({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ho.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Ed.call(e,c)&&!Td.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:mn,type:t.type,key:a,ref:i,props:s,_owner:o}};X.createContext=function(t){return t={$$typeof:wm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vm,_context:t},t.Consumer=t};X.createElement=Dd;X.createFactory=function(t){var e=Dd.bind(null,t);return e.type=t,e};X.createRef=function(){return{current:null}};X.forwardRef=function(t){return{$$typeof:bm,render:t}};X.isValidElement=Vo;X.lazy=function(t){return{$$typeof:Nm,_payload:{_status:-1,_result:t},_init:Em}};X.memo=function(t,e){return{$$typeof:jm,type:t,compare:e===void 0?null:e}};X.startTransition=function(t){var e=qn.transition;qn.transition={};try{t()}finally{qn.transition=e}};X.unstable_act=Rd;X.useCallback=function(t,e){return Be.current.useCallback(t,e)};X.useContext=function(t){return Be.current.useContext(t)};X.useDebugValue=function(){};X.useDeferredValue=function(t){return Be.current.useDeferredValue(t)};X.useEffect=function(t,e){return Be.current.useEffect(t,e)};X.useId=function(){return Be.current.useId()};X.useImperativeHandle=function(t,e,r){return Be.current.useImperativeHandle(t,e,r)};X.useInsertionEffect=function(t,e){return Be.current.useInsertionEffect(t,e)};X.useLayoutEffect=function(t,e){return Be.current.useLayoutEffect(t,e)};X.useMemo=function(t,e){return Be.current.useMemo(t,e)};X.useReducer=function(t,e,r){return Be.current.useReducer(t,e,r)};X.useRef=function(t){return Be.current.useRef(t)};X.useState=function(t){return Be.current.useState(t)};X.useSyncExternalStore=function(t,e,r){return Be.current.useSyncExternalStore(t,e,r)};X.useTransition=function(){return Be.current.useTransition()};X.version="18.3.1";jd.exports=X;var N=jd.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=N,Rm=Symbol.for("react.element"),Pm=Symbol.for("react.fragment"),Im=Object.prototype.hasOwnProperty,Om=Dm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$m={key:!0,ref:!0,__self:!0,__source:!0};function Pd(t,e,r){var s,a={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)Im.call(e,s)&&!$m.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:Rm,type:t,key:i,ref:o,props:a,_owner:Om.current}}Ra.Fragment=Pm;Ra.jsx=Pd;Ra.jsxs=Pd;_d.exports=Ra;var n=_d.exports,Id={exports:{}},et={},Od={exports:{}},$d={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(y,I){var O=y.length;y.push(I);e:for(;0<O;){var q=O-1>>>1,z=y[q];if(0<a(z,I))y[q]=I,y[O]=z,O=q;else break e}}function r(y){return y.length===0?null:y[0]}function s(y){if(y.length===0)return null;var I=y[0],O=y.pop();if(O!==I){y[0]=O;e:for(var q=0,z=y.length,$=z>>>1;q<$;){var B=2*(q+1)-1,H=y[B],V=B+1,he=y[V];if(0>a(H,O))V<z&&0>a(he,H)?(y[q]=he,y[V]=O,q=V):(y[q]=H,y[B]=O,q=B);else if(V<z&&0>a(he,O))y[q]=he,y[V]=O,q=V;else break e}}return I}function a(y,I){var O=y.sortIndex-I.sortIndex;return O!==0?O:y.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,x=!1,v=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(y){for(var I=r(d);I!==null;){if(I.callback===null)s(d);else if(I.startTime<=y)s(d),I.sortIndex=I.expirationTime,e(c,I);else break;I=r(d)}}function w(y){if(_=!1,p(y),!v)if(r(c)!==null)v=!0,te(S);else{var I=r(d);I!==null&&b(w,I.startTime-y)}}function S(y,I){v=!1,_&&(_=!1,g(E),E=-1),x=!0;var O=m;try{for(p(I),h=r(c);h!==null&&(!(h.expirationTime>I)||y&&!W());){var q=h.callback;if(typeof q=="function"){h.callback=null,m=h.priorityLevel;var z=q(h.expirationTime<=I);I=t.unstable_now(),typeof z=="function"?h.callback=z:h===r(c)&&s(c),p(I)}else s(c);h=r(c)}if(h!==null)var $=!0;else{var B=r(d);B!==null&&b(w,B.startTime-I),$=!1}return $}finally{h=null,m=O,x=!1}}var k=!1,j=null,E=-1,D=5,A=-1;function W(){return!(t.unstable_now()-A<D)}function ee(){if(j!==null){var y=t.unstable_now();A=y;var I=!0;try{I=j(!0,y)}finally{I?R():(k=!1,j=null)}}else k=!1}var R;if(typeof f=="function")R=function(){f(ee)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,Q=U.port2;U.port1.onmessage=ee,R=function(){Q.postMessage(null)}}else R=function(){C(ee,0)};function te(y){j=y,k||(k=!0,R())}function b(y,I){E=C(function(){y(t.unstable_now())},I)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(y){y.callback=null},t.unstable_continueExecution=function(){v||x||(v=!0,te(S))},t.unstable_forceFrameRate=function(y){0>y||125<y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<y?Math.floor(1e3/y):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(y){switch(m){case 1:case 2:case 3:var I=3;break;default:I=m}var O=m;m=I;try{return y()}finally{m=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(y,I){switch(y){case 1:case 2:case 3:case 4:case 5:break;default:y=3}var O=m;m=y;try{return I()}finally{m=O}},t.unstable_scheduleCallback=function(y,I,O){var q=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?q+O:q):O=q,y){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=O+z,y={id:u++,callback:I,priorityLevel:y,startTime:O,expirationTime:z,sortIndex:-1},O>q?(y.sortIndex=O,e(d,y),r(c)===null&&y===r(d)&&(_?(g(E),E=-1):_=!0,b(w,O-q))):(y.sortIndex=z,e(c,y),v||x||(v=!0,te(S))),y},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(y){var I=m;return function(){var O=m;m=I;try{return y.apply(this,arguments)}finally{m=O}}}})($d);Od.exports=$d;var Am=Od.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lm=N,Ze=Am;function P(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ad=new Set,Ws={};function Tr(t,e){as(t,e),as(t+"Capture",e)}function as(t,e){for(Ws[t]=e,t=0;t<e.length;t++)Ad.add(e[t])}var It=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ai=Object.prototype.hasOwnProperty,Mm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vl={},Wl={};function Um(t){return Ai.call(Wl,t)?!0:Ai.call(Vl,t)?!1:Mm.test(t)?Wl[t]=!0:(Vl[t]=!0,!1)}function zm(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Fm(t,e,r,s){if(e===null||typeof e>"u"||zm(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qe(t,e,r,s,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ie[t]=new qe(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ie[e]=new qe(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ie[t]=new qe(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ie[t]=new qe(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ie[t]=new qe(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ie[t]=new qe(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ie[t]=new qe(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ie[t]=new qe(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ie[t]=new qe(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wo=/[\-:]([a-z])/g;function Go(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wo,Go);Ie[e]=new qe(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wo,Go);Ie[e]=new qe(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wo,Go);Ie[e]=new qe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ie[t]=new qe(t,1,!1,t.toLowerCase(),null,!1,!1)});Ie.xlinkHref=new qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ie[t]=new qe(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ko(t,e,r,s){var a=Ie.hasOwnProperty(e)?Ie[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Fm(e,r,a,s)&&(r=null),s||a===null?Um(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,s=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var Lt=Lm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_n=Symbol.for("react.element"),Fr=Symbol.for("react.portal"),Br=Symbol.for("react.fragment"),Qo=Symbol.for("react.strict_mode"),Li=Symbol.for("react.profiler"),Ld=Symbol.for("react.provider"),Md=Symbol.for("react.context"),Jo=Symbol.for("react.forward_ref"),Mi=Symbol.for("react.suspense"),Ui=Symbol.for("react.suspense_list"),Yo=Symbol.for("react.memo"),qt=Symbol.for("react.lazy"),Ud=Symbol.for("react.offscreen"),Gl=Symbol.iterator;function vs(t){return t===null||typeof t!="object"?null:(t=Gl&&t[Gl]||t["@@iterator"],typeof t=="function"?t:null)}var ge=Object.assign,ri;function Es(t){if(ri===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ri=e&&e[1]||""}return`
`+ri+t}var si=!1;function ni(t,e){if(!t||si)return"";si=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=s.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{si=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Es(t):""}function Bm(t){switch(t.tag){case 5:return Es(t.type);case 16:return Es("Lazy");case 13:return Es("Suspense");case 19:return Es("SuspenseList");case 0:case 2:case 15:return t=ni(t.type,!1),t;case 11:return t=ni(t.type.render,!1),t;case 1:return t=ni(t.type,!0),t;default:return""}}function zi(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Br:return"Fragment";case Fr:return"Portal";case Li:return"Profiler";case Qo:return"StrictMode";case Mi:return"Suspense";case Ui:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Md:return(t.displayName||"Context")+".Consumer";case Ld:return(t._context.displayName||"Context")+".Provider";case Jo:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Yo:return e=t.displayName||null,e!==null?e:zi(t.type)||"Memo";case qt:e=t._payload,t=t._init;try{return zi(t(e))}catch{}}return null}function qm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zi(e);case 8:return e===Qo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ar(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zd(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hm(t){var e=zd(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jn(t){t._valueTracker||(t._valueTracker=Hm(t))}function Fd(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=zd(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function ta(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fi(t,e){var r=e.checked;return ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Kl(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=ar(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Bd(t,e){e=e.checked,e!=null&&Ko(t,"checked",e,!1)}function Bi(t,e){Bd(t,e);var r=ar(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qi(t,e.type,r):e.hasOwnProperty("defaultValue")&&qi(t,e.type,ar(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ql(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function qi(t,e,r){(e!=="number"||ta(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ts=Array.isArray;function Zr(t,e,r,s){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&s&&(t[r].defaultSelected=!0)}else{for(r=""+ar(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Hi(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(P(91));return ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jl(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(P(92));if(Ts(r)){if(1<r.length)throw Error(P(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ar(r)}}function qd(t,e){var r=ar(e.value),s=ar(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function Yl(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Hd(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vi(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Hd(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Nn,Vd=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Nn=Nn||document.createElement("div"),Nn.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nn.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gs(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Os={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vm=["Webkit","ms","Moz","O"];Object.keys(Os).forEach(function(t){Vm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Os[e]=Os[t]})});function Wd(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Os.hasOwnProperty(t)&&Os[t]?(""+e).trim():e+"px"}function Gd(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,a=Wd(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,a):t[r]=a}}var Wm=ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wi(t,e){if(e){if(Wm[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(P(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(P(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(P(61))}if(e.style!=null&&typeof e.style!="object")throw Error(P(62))}}function Gi(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ki=null;function Xo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qi=null,es=null,ts=null;function Xl(t){if(t=gn(t)){if(typeof Qi!="function")throw Error(P(280));var e=t.stateNode;e&&(e=Aa(e),Qi(t.stateNode,t.type,e))}}function Kd(t){es?ts?ts.push(t):ts=[t]:es=t}function Qd(){if(es){var t=es,e=ts;if(ts=es=null,Xl(t),e)for(t=0;t<e.length;t++)Xl(e[t])}}function Jd(t,e){return t(e)}function Yd(){}var ai=!1;function Xd(t,e,r){if(ai)return t(e,r);ai=!0;try{return Jd(t,e,r)}finally{ai=!1,(es!==null||ts!==null)&&(Yd(),Qd())}}function Ks(t,e){var r=t.stateNode;if(r===null)return null;var s=Aa(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(P(231,e,typeof r));return r}var Ji=!1;if(It)try{var ws={};Object.defineProperty(ws,"passive",{get:function(){Ji=!0}}),window.addEventListener("test",ws,ws),window.removeEventListener("test",ws,ws)}catch{Ji=!1}function Gm(t,e,r,s,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var $s=!1,ra=null,sa=!1,Yi=null,Km={onError:function(t){$s=!0,ra=t}};function Qm(t,e,r,s,a,i,o,l,c){$s=!1,ra=null,Gm.apply(Km,arguments)}function Jm(t,e,r,s,a,i,o,l,c){if(Qm.apply(this,arguments),$s){if($s){var d=ra;$s=!1,ra=null}else throw Error(P(198));sa||(sa=!0,Yi=d)}}function Dr(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Zd(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zl(t){if(Dr(t)!==t)throw Error(P(188))}function Ym(t){var e=t.alternate;if(!e){if(e=Dr(t),e===null)throw Error(P(188));return e!==t?null:t}for(var r=t,s=e;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){r=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Zl(a),t;if(i===s)return Zl(a),e;i=i.sibling}throw Error(P(188))}if(r.return!==s.return)r=a,s=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,s=i;break}if(l===s){o=!0,s=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,s=a;break}if(l===s){o=!0,s=i,r=a;break}l=l.sibling}if(!o)throw Error(P(189))}}if(r.alternate!==s)throw Error(P(190))}if(r.tag!==3)throw Error(P(188));return r.stateNode.current===r?t:e}function eu(t){return t=Ym(t),t!==null?tu(t):null}function tu(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=tu(t);if(e!==null)return e;t=t.sibling}return null}var ru=Ze.unstable_scheduleCallback,ec=Ze.unstable_cancelCallback,Xm=Ze.unstable_shouldYield,Zm=Ze.unstable_requestPaint,ye=Ze.unstable_now,ef=Ze.unstable_getCurrentPriorityLevel,Zo=Ze.unstable_ImmediatePriority,su=Ze.unstable_UserBlockingPriority,na=Ze.unstable_NormalPriority,tf=Ze.unstable_LowPriority,nu=Ze.unstable_IdlePriority,Pa=null,Nt=null;function rf(t){if(Nt&&typeof Nt.onCommitFiberRoot=="function")try{Nt.onCommitFiberRoot(Pa,t,void 0,(t.current.flags&128)===128)}catch{}}var gt=Math.clz32?Math.clz32:af,sf=Math.log,nf=Math.LN2;function af(t){return t>>>=0,t===0?32:31-(sf(t)/nf|0)|0}var kn=64,Sn=4194304;function Ds(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function aa(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,a=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?s=Ds(l):(i&=o,i!==0&&(s=Ds(i)))}else o=r&~a,o!==0?s=Ds(o):i!==0&&(s=Ds(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-gt(e),a=1<<r,s|=t[r],e&=~a;return s}function of(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lf(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-gt(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&s)&&(a[o]=of(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Xi(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function au(){var t=kn;return kn<<=1,!(kn&4194240)&&(kn=64),t}function ii(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function fn(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gt(e),t[e]=r}function cf(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-gt(r),i=1<<a;e[a]=0,s[a]=-1,t[a]=-1,r&=~i}}function el(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-gt(r),a=1<<s;a&e|t[s]&e&&(t[s]|=e),r&=~a}}var ae=0;function iu(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ou,tl,lu,cu,du,Zi=!1,Cn=[],Jt=null,Yt=null,Xt=null,Qs=new Map,Js=new Map,Vt=[],df="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tc(t,e){switch(t){case"focusin":case"focusout":Jt=null;break;case"dragenter":case"dragleave":Yt=null;break;case"mouseover":case"mouseout":Xt=null;break;case"pointerover":case"pointerout":Qs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Js.delete(e.pointerId)}}function bs(t,e,r,s,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},e!==null&&(e=gn(e),e!==null&&tl(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function uf(t,e,r,s,a){switch(e){case"focusin":return Jt=bs(Jt,t,e,r,s,a),!0;case"dragenter":return Yt=bs(Yt,t,e,r,s,a),!0;case"mouseover":return Xt=bs(Xt,t,e,r,s,a),!0;case"pointerover":var i=a.pointerId;return Qs.set(i,bs(Qs.get(i)||null,t,e,r,s,a)),!0;case"gotpointercapture":return i=a.pointerId,Js.set(i,bs(Js.get(i)||null,t,e,r,s,a)),!0}return!1}function uu(t){var e=xr(t.target);if(e!==null){var r=Dr(e);if(r!==null){if(e=r.tag,e===13){if(e=Zd(r),e!==null){t.blockedOn=e,du(t.priority,function(){lu(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hn(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=eo(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);Ki=s,r.target.dispatchEvent(s),Ki=null}else return e=gn(r),e!==null&&tl(e),t.blockedOn=r,!1;e.shift()}return!0}function rc(t,e,r){Hn(t)&&r.delete(e)}function hf(){Zi=!1,Jt!==null&&Hn(Jt)&&(Jt=null),Yt!==null&&Hn(Yt)&&(Yt=null),Xt!==null&&Hn(Xt)&&(Xt=null),Qs.forEach(rc),Js.forEach(rc)}function _s(t,e){t.blockedOn===e&&(t.blockedOn=null,Zi||(Zi=!0,Ze.unstable_scheduleCallback(Ze.unstable_NormalPriority,hf)))}function Ys(t){function e(a){return _s(a,t)}if(0<Cn.length){_s(Cn[0],t);for(var r=1;r<Cn.length;r++){var s=Cn[r];s.blockedOn===t&&(s.blockedOn=null)}}for(Jt!==null&&_s(Jt,t),Yt!==null&&_s(Yt,t),Xt!==null&&_s(Xt,t),Qs.forEach(e),Js.forEach(e),r=0;r<Vt.length;r++)s=Vt[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<Vt.length&&(r=Vt[0],r.blockedOn===null);)uu(r),r.blockedOn===null&&Vt.shift()}var rs=Lt.ReactCurrentBatchConfig,ia=!0;function mf(t,e,r,s){var a=ae,i=rs.transition;rs.transition=null;try{ae=1,rl(t,e,r,s)}finally{ae=a,rs.transition=i}}function ff(t,e,r,s){var a=ae,i=rs.transition;rs.transition=null;try{ae=4,rl(t,e,r,s)}finally{ae=a,rs.transition=i}}function rl(t,e,r,s){if(ia){var a=eo(t,e,r,s);if(a===null)gi(t,e,s,oa,r),tc(t,s);else if(uf(a,t,e,r,s))s.stopPropagation();else if(tc(t,s),e&4&&-1<df.indexOf(t)){for(;a!==null;){var i=gn(a);if(i!==null&&ou(i),i=eo(t,e,r,s),i===null&&gi(t,e,s,oa,r),i===a)break;a=i}a!==null&&s.stopPropagation()}else gi(t,e,s,null,r)}}var oa=null;function eo(t,e,r,s){if(oa=null,t=Xo(s),t=xr(t),t!==null)if(e=Dr(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Zd(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return oa=t,null}function hu(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ef()){case Zo:return 1;case su:return 4;case na:case tf:return 16;case nu:return 536870912;default:return 16}default:return 16}}var Kt=null,sl=null,Vn=null;function mu(){if(Vn)return Vn;var t,e=sl,r=e.length,s,a="value"in Kt?Kt.value:Kt.textContent,i=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(s=1;s<=o&&e[r-s]===a[i-s];s++);return Vn=a.slice(t,1<s?1-s:void 0)}function Wn(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function En(){return!0}function sc(){return!1}function tt(t){function e(r,s,a,i,o){this._reactName=r,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?En:sc,this.isPropagationStopped=sc,this}return ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=En)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=En)},persist:function(){},isPersistent:En}),e}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nl=tt(fs),pn=ge({},fs,{view:0,detail:0}),pf=tt(pn),oi,li,js,Ia=ge({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:al,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==js&&(js&&t.type==="mousemove"?(oi=t.screenX-js.screenX,li=t.screenY-js.screenY):li=oi=0,js=t),oi)},movementY:function(t){return"movementY"in t?t.movementY:li}}),nc=tt(Ia),gf=ge({},Ia,{dataTransfer:0}),xf=tt(gf),yf=ge({},pn,{relatedTarget:0}),ci=tt(yf),vf=ge({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),wf=tt(vf),bf=ge({},fs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_f=tt(bf),jf=ge({},fs,{data:0}),ac=tt(jf),Nf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cf(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Sf[t])?!!e[t]:!1}function al(){return Cf}var Ef=ge({},pn,{key:function(t){if(t.key){var e=Nf[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wn(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kf[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:al,charCode:function(t){return t.type==="keypress"?Wn(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wn(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Tf=tt(Ef),Df=ge({},Ia,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ic=tt(Df),Rf=ge({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:al}),Pf=tt(Rf),If=ge({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Of=tt(If),$f=ge({},Ia,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Af=tt($f),Lf=[9,13,27,32],il=It&&"CompositionEvent"in window,As=null;It&&"documentMode"in document&&(As=document.documentMode);var Mf=It&&"TextEvent"in window&&!As,fu=It&&(!il||As&&8<As&&11>=As),oc=" ",lc=!1;function pu(t,e){switch(t){case"keyup":return Lf.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gu(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qr=!1;function Uf(t,e){switch(t){case"compositionend":return gu(e);case"keypress":return e.which!==32?null:(lc=!0,oc);case"textInput":return t=e.data,t===oc&&lc?null:t;default:return null}}function zf(t,e){if(qr)return t==="compositionend"||!il&&pu(t,e)?(t=mu(),Vn=sl=Kt=null,qr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fu&&e.locale!=="ko"?null:e.data;default:return null}}var Ff={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ff[t.type]:e==="textarea"}function xu(t,e,r,s){Kd(s),e=la(e,"onChange"),0<e.length&&(r=new nl("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var Ls=null,Xs=null;function Bf(t){Eu(t,0)}function Oa(t){var e=Wr(t);if(Fd(e))return t}function qf(t,e){if(t==="change")return e}var yu=!1;if(It){var di;if(It){var ui="oninput"in document;if(!ui){var dc=document.createElement("div");dc.setAttribute("oninput","return;"),ui=typeof dc.oninput=="function"}di=ui}else di=!1;yu=di&&(!document.documentMode||9<document.documentMode)}function uc(){Ls&&(Ls.detachEvent("onpropertychange",vu),Xs=Ls=null)}function vu(t){if(t.propertyName==="value"&&Oa(Xs)){var e=[];xu(e,Xs,t,Xo(t)),Xd(Bf,e)}}function Hf(t,e,r){t==="focusin"?(uc(),Ls=e,Xs=r,Ls.attachEvent("onpropertychange",vu)):t==="focusout"&&uc()}function Vf(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Oa(Xs)}function Wf(t,e){if(t==="click")return Oa(e)}function Gf(t,e){if(t==="input"||t==="change")return Oa(e)}function Kf(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vt=typeof Object.is=="function"?Object.is:Kf;function Zs(t,e){if(vt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var a=r[s];if(!Ai.call(e,a)||!vt(t[a],e[a]))return!1}return!0}function hc(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mc(t,e){var r=hc(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hc(r)}}function wu(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wu(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bu(){for(var t=window,e=ta();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ta(t.document)}return e}function ol(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Qf(t){var e=bu(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&wu(r.ownerDocument.documentElement,r)){if(s!==null&&ol(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!t.extend&&i>s&&(a=s,s=i,i=a),a=mc(r,i);var o=mc(r,s);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Jf=It&&"documentMode"in document&&11>=document.documentMode,Hr=null,to=null,Ms=null,ro=!1;function fc(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ro||Hr==null||Hr!==ta(s)||(s=Hr,"selectionStart"in s&&ol(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ms&&Zs(Ms,s)||(Ms=s,s=la(to,"onSelect"),0<s.length&&(e=new nl("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=Hr)))}function Tn(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Vr={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionend:Tn("Transition","TransitionEnd")},hi={},_u={};It&&(_u=document.createElement("div").style,"AnimationEvent"in window||(delete Vr.animationend.animation,delete Vr.animationiteration.animation,delete Vr.animationstart.animation),"TransitionEvent"in window||delete Vr.transitionend.transition);function $a(t){if(hi[t])return hi[t];if(!Vr[t])return t;var e=Vr[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in _u)return hi[t]=e[r];return t}var ju=$a("animationend"),Nu=$a("animationiteration"),ku=$a("animationstart"),Su=$a("transitionend"),Cu=new Map,pc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function or(t,e){Cu.set(t,e),Tr(e,[t])}for(var mi=0;mi<pc.length;mi++){var fi=pc[mi],Yf=fi.toLowerCase(),Xf=fi[0].toUpperCase()+fi.slice(1);or(Yf,"on"+Xf)}or(ju,"onAnimationEnd");or(Nu,"onAnimationIteration");or(ku,"onAnimationStart");or("dblclick","onDoubleClick");or("focusin","onFocus");or("focusout","onBlur");or(Su,"onTransitionEnd");as("onMouseEnter",["mouseout","mouseover"]);as("onMouseLeave",["mouseout","mouseover"]);as("onPointerEnter",["pointerout","pointerover"]);as("onPointerLeave",["pointerout","pointerover"]);Tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function gc(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,Jm(s,e,void 0,t),t.currentTarget=null}function Eu(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],a=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;gc(a,l,d),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;gc(a,l,d),i=c}}}if(sa)throw t=Yi,sa=!1,Yi=null,t}function de(t,e){var r=e[oo];r===void 0&&(r=e[oo]=new Set);var s=t+"__bubble";r.has(s)||(Tu(e,t,2,!1),r.add(s))}function pi(t,e,r){var s=0;e&&(s|=4),Tu(r,t,s,e)}var Dn="_reactListening"+Math.random().toString(36).slice(2);function en(t){if(!t[Dn]){t[Dn]=!0,Ad.forEach(function(r){r!=="selectionchange"&&(Zf.has(r)||pi(r,!1,t),pi(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Dn]||(e[Dn]=!0,pi("selectionchange",!1,e))}}function Tu(t,e,r,s){switch(hu(e)){case 1:var a=mf;break;case 4:a=ff;break;default:a=rl}r=a.bind(null,e,r,t),a=void 0,!Ji||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function gi(t,e,r,s,a){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=xr(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}Xd(function(){var d=i,u=Xo(r),h=[];e:{var m=Cu.get(t);if(m!==void 0){var x=nl,v=t;switch(t){case"keypress":if(Wn(r)===0)break e;case"keydown":case"keyup":x=Tf;break;case"focusin":v="focus",x=ci;break;case"focusout":v="blur",x=ci;break;case"beforeblur":case"afterblur":x=ci;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=nc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=xf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Pf;break;case ju:case Nu:case ku:x=wf;break;case Su:x=Of;break;case"scroll":x=pf;break;case"wheel":x=Af;break;case"copy":case"cut":case"paste":x=_f;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=ic}var _=(e&4)!==0,C=!_&&t==="scroll",g=_?m!==null?m+"Capture":null:m;_=[];for(var f=d,p;f!==null;){p=f;var w=p.stateNode;if(p.tag===5&&w!==null&&(p=w,g!==null&&(w=Ks(f,g),w!=null&&_.push(tn(f,w,p)))),C)break;f=f.return}0<_.length&&(m=new x(m,v,null,r,u),h.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",m&&r!==Ki&&(v=r.relatedTarget||r.fromElement)&&(xr(v)||v[Ot]))break e;if((x||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,x?(v=r.relatedTarget||r.toElement,x=d,v=v?xr(v):null,v!==null&&(C=Dr(v),v!==C||v.tag!==5&&v.tag!==6)&&(v=null)):(x=null,v=d),x!==v)){if(_=nc,w="onMouseLeave",g="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(_=ic,w="onPointerLeave",g="onPointerEnter",f="pointer"),C=x==null?m:Wr(x),p=v==null?m:Wr(v),m=new _(w,f+"leave",x,r,u),m.target=C,m.relatedTarget=p,w=null,xr(u)===d&&(_=new _(g,f+"enter",v,r,u),_.target=p,_.relatedTarget=C,w=_),C=w,x&&v)t:{for(_=x,g=v,f=0,p=_;p;p=Ir(p))f++;for(p=0,w=g;w;w=Ir(w))p++;for(;0<f-p;)_=Ir(_),f--;for(;0<p-f;)g=Ir(g),p--;for(;f--;){if(_===g||g!==null&&_===g.alternate)break t;_=Ir(_),g=Ir(g)}_=null}else _=null;x!==null&&xc(h,m,x,_,!1),v!==null&&C!==null&&xc(h,C,v,_,!0)}}e:{if(m=d?Wr(d):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var S=qf;else if(cc(m))if(yu)S=Gf;else{S=Vf;var k=Hf}else(x=m.nodeName)&&x.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=Wf);if(S&&(S=S(t,d))){xu(h,S,r,u);break e}k&&k(t,m,d),t==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&qi(m,"number",m.value)}switch(k=d?Wr(d):window,t){case"focusin":(cc(k)||k.contentEditable==="true")&&(Hr=k,to=d,Ms=null);break;case"focusout":Ms=to=Hr=null;break;case"mousedown":ro=!0;break;case"contextmenu":case"mouseup":case"dragend":ro=!1,fc(h,r,u);break;case"selectionchange":if(Jf)break;case"keydown":case"keyup":fc(h,r,u)}var j;if(il)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else qr?pu(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(fu&&r.locale!=="ko"&&(qr||E!=="onCompositionStart"?E==="onCompositionEnd"&&qr&&(j=mu()):(Kt=u,sl="value"in Kt?Kt.value:Kt.textContent,qr=!0)),k=la(d,E),0<k.length&&(E=new ac(E,t,null,r,u),h.push({event:E,listeners:k}),j?E.data=j:(j=gu(r),j!==null&&(E.data=j)))),(j=Mf?Uf(t,r):zf(t,r))&&(d=la(d,"onBeforeInput"),0<d.length&&(u=new ac("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=j))}Eu(h,e)})}function tn(t,e,r){return{instance:t,listener:e,currentTarget:r}}function la(t,e){for(var r=e+"Capture",s=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ks(t,r),i!=null&&s.unshift(tn(t,i,a)),i=Ks(t,e),i!=null&&s.push(tn(t,i,a))),t=t.return}return s}function Ir(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xc(t,e,r,s,a){for(var i=e._reactName,o=[];r!==null&&r!==s;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,a?(c=Ks(r,i),c!=null&&o.unshift(tn(r,c,l))):a||(c=Ks(r,i),c!=null&&o.push(tn(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var ep=/\r\n?/g,tp=/\u0000|\uFFFD/g;function yc(t){return(typeof t=="string"?t:""+t).replace(ep,`
`).replace(tp,"")}function Rn(t,e,r){if(e=yc(e),yc(t)!==e&&r)throw Error(P(425))}function ca(){}var so=null,no=null;function ao(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var io=typeof setTimeout=="function"?setTimeout:void 0,rp=typeof clearTimeout=="function"?clearTimeout:void 0,vc=typeof Promise=="function"?Promise:void 0,sp=typeof queueMicrotask=="function"?queueMicrotask:typeof vc<"u"?function(t){return vc.resolve(null).then(t).catch(np)}:io;function np(t){setTimeout(function(){throw t})}function xi(t,e){var r=e,s=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(s===0){t.removeChild(a),Ys(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=a}while(r);Ys(e)}function Zt(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function wc(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ps=Math.random().toString(36).slice(2),jt="__reactFiber$"+ps,rn="__reactProps$"+ps,Ot="__reactContainer$"+ps,oo="__reactEvents$"+ps,ap="__reactListeners$"+ps,ip="__reactHandles$"+ps;function xr(t){var e=t[jt];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ot]||r[jt]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=wc(t);t!==null;){if(r=t[jt])return r;t=wc(t)}return e}t=r,r=t.parentNode}return null}function gn(t){return t=t[jt]||t[Ot],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Wr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(P(33))}function Aa(t){return t[rn]||null}var lo=[],Gr=-1;function lr(t){return{current:t}}function ue(t){0>Gr||(t.current=lo[Gr],lo[Gr]=null,Gr--)}function ce(t,e){Gr++,lo[Gr]=t.current,t.current=e}var ir={},Le=lr(ir),Ge=lr(!1),_r=ir;function is(t,e){var r=t.type.contextTypes;if(!r)return ir;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ke(t){return t=t.childContextTypes,t!=null}function da(){ue(Ge),ue(Le)}function bc(t,e,r){if(Le.current!==ir)throw Error(P(168));ce(Le,e),ce(Ge,r)}function Du(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(P(108,qm(t)||"Unknown",a));return ge({},r,s)}function ua(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ir,_r=Le.current,ce(Le,t),ce(Ge,Ge.current),!0}function _c(t,e,r){var s=t.stateNode;if(!s)throw Error(P(169));r?(t=Du(t,e,_r),s.__reactInternalMemoizedMergedChildContext=t,ue(Ge),ue(Le),ce(Le,t)):ue(Ge),ce(Ge,r)}var Tt=null,La=!1,yi=!1;function Ru(t){Tt===null?Tt=[t]:Tt.push(t)}function op(t){La=!0,Ru(t)}function cr(){if(!yi&&Tt!==null){yi=!0;var t=0,e=ae;try{var r=Tt;for(ae=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}Tt=null,La=!1}catch(a){throw Tt!==null&&(Tt=Tt.slice(t+1)),ru(Zo,cr),a}finally{ae=e,yi=!1}}return null}var Kr=[],Qr=0,ha=null,ma=0,st=[],nt=0,jr=null,Dt=1,Rt="";function mr(t,e){Kr[Qr++]=ma,Kr[Qr++]=ha,ha=t,ma=e}function Pu(t,e,r){st[nt++]=Dt,st[nt++]=Rt,st[nt++]=jr,jr=t;var s=Dt;t=Rt;var a=32-gt(s)-1;s&=~(1<<a),r+=1;var i=32-gt(e)+a;if(30<i){var o=a-a%5;i=(s&(1<<o)-1).toString(32),s>>=o,a-=o,Dt=1<<32-gt(e)+a|r<<a|s,Rt=i+t}else Dt=1<<i|r<<a|s,Rt=t}function ll(t){t.return!==null&&(mr(t,1),Pu(t,1,0))}function cl(t){for(;t===ha;)ha=Kr[--Qr],Kr[Qr]=null,ma=Kr[--Qr],Kr[Qr]=null;for(;t===jr;)jr=st[--nt],st[nt]=null,Rt=st[--nt],st[nt]=null,Dt=st[--nt],st[nt]=null}var Xe=null,Ye=null,me=!1,pt=null;function Iu(t,e){var r=at(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function jc(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xe=t,Ye=Zt(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xe=t,Ye=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=jr!==null?{id:Dt,overflow:Rt}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=at(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Xe=t,Ye=null,!0):!1;default:return!1}}function co(t){return(t.mode&1)!==0&&(t.flags&128)===0}function uo(t){if(me){var e=Ye;if(e){var r=e;if(!jc(t,e)){if(co(t))throw Error(P(418));e=Zt(r.nextSibling);var s=Xe;e&&jc(t,e)?Iu(s,r):(t.flags=t.flags&-4097|2,me=!1,Xe=t)}}else{if(co(t))throw Error(P(418));t.flags=t.flags&-4097|2,me=!1,Xe=t}}}function Nc(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xe=t}function Pn(t){if(t!==Xe)return!1;if(!me)return Nc(t),me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ao(t.type,t.memoizedProps)),e&&(e=Ye)){if(co(t))throw Ou(),Error(P(418));for(;e;)Iu(t,e),e=Zt(e.nextSibling)}if(Nc(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ye=Zt(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ye=null}}else Ye=Xe?Zt(t.stateNode.nextSibling):null;return!0}function Ou(){for(var t=Ye;t;)t=Zt(t.nextSibling)}function os(){Ye=Xe=null,me=!1}function dl(t){pt===null?pt=[t]:pt.push(t)}var lp=Lt.ReactCurrentBatchConfig;function Ns(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(P(309));var s=r.stateNode}if(!s)throw Error(P(147,t));var a=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(P(284));if(!r._owner)throw Error(P(290,t))}return t}function In(t,e){throw t=Object.prototype.toString.call(e),Error(P(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function kc(t){var e=t._init;return e(t._payload)}function $u(t){function e(g,f){if(t){var p=g.deletions;p===null?(g.deletions=[f],g.flags|=16):p.push(f)}}function r(g,f){if(!t)return null;for(;f!==null;)e(g,f),f=f.sibling;return null}function s(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function a(g,f){return g=sr(g,f),g.index=0,g.sibling=null,g}function i(g,f,p){return g.index=p,t?(p=g.alternate,p!==null?(p=p.index,p<f?(g.flags|=2,f):p):(g.flags|=2,f)):(g.flags|=1048576,f)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,f,p,w){return f===null||f.tag!==6?(f=ki(p,g.mode,w),f.return=g,f):(f=a(f,p),f.return=g,f)}function c(g,f,p,w){var S=p.type;return S===Br?u(g,f,p.props.children,w,p.key):f!==null&&(f.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===qt&&kc(S)===f.type)?(w=a(f,p.props),w.ref=Ns(g,f,p),w.return=g,w):(w=Zn(p.type,p.key,p.props,null,g.mode,w),w.ref=Ns(g,f,p),w.return=g,w)}function d(g,f,p,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=Si(p,g.mode,w),f.return=g,f):(f=a(f,p.children||[]),f.return=g,f)}function u(g,f,p,w,S){return f===null||f.tag!==7?(f=br(p,g.mode,w,S),f.return=g,f):(f=a(f,p),f.return=g,f)}function h(g,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=ki(""+f,g.mode,p),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case _n:return p=Zn(f.type,f.key,f.props,null,g.mode,p),p.ref=Ns(g,null,f),p.return=g,p;case Fr:return f=Si(f,g.mode,p),f.return=g,f;case qt:var w=f._init;return h(g,w(f._payload),p)}if(Ts(f)||vs(f))return f=br(f,g.mode,p,null),f.return=g,f;In(g,f)}return null}function m(g,f,p,w){var S=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return S!==null?null:l(g,f,""+p,w);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case _n:return p.key===S?c(g,f,p,w):null;case Fr:return p.key===S?d(g,f,p,w):null;case qt:return S=p._init,m(g,f,S(p._payload),w)}if(Ts(p)||vs(p))return S!==null?null:u(g,f,p,w,null);In(g,p)}return null}function x(g,f,p,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(p)||null,l(f,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _n:return g=g.get(w.key===null?p:w.key)||null,c(f,g,w,S);case Fr:return g=g.get(w.key===null?p:w.key)||null,d(f,g,w,S);case qt:var k=w._init;return x(g,f,p,k(w._payload),S)}if(Ts(w)||vs(w))return g=g.get(p)||null,u(f,g,w,S,null);In(f,w)}return null}function v(g,f,p,w){for(var S=null,k=null,j=f,E=f=0,D=null;j!==null&&E<p.length;E++){j.index>E?(D=j,j=null):D=j.sibling;var A=m(g,j,p[E],w);if(A===null){j===null&&(j=D);break}t&&j&&A.alternate===null&&e(g,j),f=i(A,f,E),k===null?S=A:k.sibling=A,k=A,j=D}if(E===p.length)return r(g,j),me&&mr(g,E),S;if(j===null){for(;E<p.length;E++)j=h(g,p[E],w),j!==null&&(f=i(j,f,E),k===null?S=j:k.sibling=j,k=j);return me&&mr(g,E),S}for(j=s(g,j);E<p.length;E++)D=x(j,g,E,p[E],w),D!==null&&(t&&D.alternate!==null&&j.delete(D.key===null?E:D.key),f=i(D,f,E),k===null?S=D:k.sibling=D,k=D);return t&&j.forEach(function(W){return e(g,W)}),me&&mr(g,E),S}function _(g,f,p,w){var S=vs(p);if(typeof S!="function")throw Error(P(150));if(p=S.call(p),p==null)throw Error(P(151));for(var k=S=null,j=f,E=f=0,D=null,A=p.next();j!==null&&!A.done;E++,A=p.next()){j.index>E?(D=j,j=null):D=j.sibling;var W=m(g,j,A.value,w);if(W===null){j===null&&(j=D);break}t&&j&&W.alternate===null&&e(g,j),f=i(W,f,E),k===null?S=W:k.sibling=W,k=W,j=D}if(A.done)return r(g,j),me&&mr(g,E),S;if(j===null){for(;!A.done;E++,A=p.next())A=h(g,A.value,w),A!==null&&(f=i(A,f,E),k===null?S=A:k.sibling=A,k=A);return me&&mr(g,E),S}for(j=s(g,j);!A.done;E++,A=p.next())A=x(j,g,E,A.value,w),A!==null&&(t&&A.alternate!==null&&j.delete(A.key===null?E:A.key),f=i(A,f,E),k===null?S=A:k.sibling=A,k=A);return t&&j.forEach(function(ee){return e(g,ee)}),me&&mr(g,E),S}function C(g,f,p,w){if(typeof p=="object"&&p!==null&&p.type===Br&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case _n:e:{for(var S=p.key,k=f;k!==null;){if(k.key===S){if(S=p.type,S===Br){if(k.tag===7){r(g,k.sibling),f=a(k,p.props.children),f.return=g,g=f;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===qt&&kc(S)===k.type){r(g,k.sibling),f=a(k,p.props),f.ref=Ns(g,k,p),f.return=g,g=f;break e}r(g,k);break}else e(g,k);k=k.sibling}p.type===Br?(f=br(p.props.children,g.mode,w,p.key),f.return=g,g=f):(w=Zn(p.type,p.key,p.props,null,g.mode,w),w.ref=Ns(g,f,p),w.return=g,g=w)}return o(g);case Fr:e:{for(k=p.key;f!==null;){if(f.key===k)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){r(g,f.sibling),f=a(f,p.children||[]),f.return=g,g=f;break e}else{r(g,f);break}else e(g,f);f=f.sibling}f=Si(p,g.mode,w),f.return=g,g=f}return o(g);case qt:return k=p._init,C(g,f,k(p._payload),w)}if(Ts(p))return v(g,f,p,w);if(vs(p))return _(g,f,p,w);In(g,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(r(g,f.sibling),f=a(f,p),f.return=g,g=f):(r(g,f),f=ki(p,g.mode,w),f.return=g,g=f),o(g)):r(g,f)}return C}var ls=$u(!0),Au=$u(!1),fa=lr(null),pa=null,Jr=null,ul=null;function hl(){ul=Jr=pa=null}function ml(t){var e=fa.current;ue(fa),t._currentValue=e}function ho(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function ss(t,e){pa=t,ul=Jr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(We=!0),t.firstContext=null)}function lt(t){var e=t._currentValue;if(ul!==t)if(t={context:t,memoizedValue:e,next:null},Jr===null){if(pa===null)throw Error(P(308));Jr=t,pa.dependencies={lanes:0,firstContext:t}}else Jr=Jr.next=t;return e}var yr=null;function fl(t){yr===null?yr=[t]:yr.push(t)}function Lu(t,e,r,s){var a=e.interleaved;return a===null?(r.next=r,fl(e)):(r.next=a.next,a.next=r),e.interleaved=r,$t(t,s)}function $t(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ht=!1;function pl(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mu(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function er(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,se&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,$t(t,r)}return a=s.interleaved,a===null?(e.next=e,fl(s)):(e.next=a.next,a.next=e),s.interleaved=e,$t(t,r)}function Gn(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,el(t,r)}}function Sc(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=e:i=i.next=e}else a=i=e;r={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ga(t,e,r,s){var a=t.updateQueue;Ht=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;o=0,u=d=c=null,l=i;do{var m=l.lane,x=l.eventTime;if((s&m)===m){u!==null&&(u=u.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,_=l;switch(m=e,x=r,_.tag){case 1:if(v=_.payload,typeof v=="function"){h=v.call(x,h,m);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,m=typeof v=="function"?v.call(x,h,m):v,m==null)break e;h=ge({},h,m);break e;case 2:Ht=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else x={eventTime:x,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=x,c=h):u=u.next=x,o|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(u===null&&(c=h),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);kr|=o,t.lanes=o,t.memoizedState=h}}function Cc(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=r,typeof a!="function")throw Error(P(191,a));a.call(s)}}}var xn={},kt=lr(xn),sn=lr(xn),nn=lr(xn);function vr(t){if(t===xn)throw Error(P(174));return t}function gl(t,e){switch(ce(nn,e),ce(sn,t),ce(kt,xn),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vi(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vi(e,t)}ue(kt),ce(kt,e)}function cs(){ue(kt),ue(sn),ue(nn)}function Uu(t){vr(nn.current);var e=vr(kt.current),r=Vi(e,t.type);e!==r&&(ce(sn,t),ce(kt,r))}function xl(t){sn.current===t&&(ue(kt),ue(sn))}var fe=lr(0);function xa(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vi=[];function yl(){for(var t=0;t<vi.length;t++)vi[t]._workInProgressVersionPrimary=null;vi.length=0}var Kn=Lt.ReactCurrentDispatcher,wi=Lt.ReactCurrentBatchConfig,Nr=0,pe=null,_e=null,Se=null,ya=!1,Us=!1,an=0,cp=0;function Oe(){throw Error(P(321))}function vl(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!vt(t[r],e[r]))return!1;return!0}function wl(t,e,r,s,a,i){if(Nr=i,pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Kn.current=t===null||t.memoizedState===null?mp:fp,t=r(s,a),Us){i=0;do{if(Us=!1,an=0,25<=i)throw Error(P(301));i+=1,Se=_e=null,e.updateQueue=null,Kn.current=pp,t=r(s,a)}while(Us)}if(Kn.current=va,e=_e!==null&&_e.next!==null,Nr=0,Se=_e=pe=null,ya=!1,e)throw Error(P(300));return t}function bl(){var t=an!==0;return an=0,t}function bt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?pe.memoizedState=Se=t:Se=Se.next=t,Se}function ct(){if(_e===null){var t=pe.alternate;t=t!==null?t.memoizedState:null}else t=_e.next;var e=Se===null?pe.memoizedState:Se.next;if(e!==null)Se=e,_e=t;else{if(t===null)throw Error(P(310));_e=t,t={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},Se===null?pe.memoizedState=Se=t:Se=Se.next=t}return Se}function on(t,e){return typeof e=="function"?e(t):e}function bi(t){var e=ct(),r=e.queue;if(r===null)throw Error(P(311));r.lastRenderedReducer=t;var s=_e,a=s.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}s.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,s=s.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Nr&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=s):c=c.next=h,pe.lanes|=u,kr|=u}d=d.next}while(d!==null&&d!==i);c===null?o=s:c.next=l,vt(s,e.memoizedState)||(We=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}if(t=r.interleaved,t!==null){a=t;do i=a.lane,pe.lanes|=i,kr|=i,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function _i(t){var e=ct(),r=e.queue;if(r===null)throw Error(P(311));r.lastRenderedReducer=t;var s=r.dispatch,a=r.pending,i=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);vt(i,e.memoizedState)||(We=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,s]}function zu(){}function Fu(t,e){var r=pe,s=ct(),a=e(),i=!vt(s.memoizedState,a);if(i&&(s.memoizedState=a,We=!0),s=s.queue,_l(Hu.bind(null,r,s,t),[t]),s.getSnapshot!==e||i||Se!==null&&Se.memoizedState.tag&1){if(r.flags|=2048,ln(9,qu.bind(null,r,s,a,e),void 0,null),Ce===null)throw Error(P(349));Nr&30||Bu(r,e,a)}return a}function Bu(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function qu(t,e,r,s){e.value=r,e.getSnapshot=s,Vu(e)&&Wu(t)}function Hu(t,e,r){return r(function(){Vu(e)&&Wu(t)})}function Vu(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!vt(t,r)}catch{return!0}}function Wu(t){var e=$t(t,1);e!==null&&xt(e,t,1,-1)}function Ec(t){var e=bt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:on,lastRenderedState:t},e.queue=t,t=t.dispatch=hp.bind(null,pe,t),[e.memoizedState,t]}function ln(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function Gu(){return ct().memoizedState}function Qn(t,e,r,s){var a=bt();pe.flags|=t,a.memoizedState=ln(1|e,r,void 0,s===void 0?null:s)}function Ma(t,e,r,s){var a=ct();s=s===void 0?null:s;var i=void 0;if(_e!==null){var o=_e.memoizedState;if(i=o.destroy,s!==null&&vl(s,o.deps)){a.memoizedState=ln(e,r,i,s);return}}pe.flags|=t,a.memoizedState=ln(1|e,r,i,s)}function Tc(t,e){return Qn(8390656,8,t,e)}function _l(t,e){return Ma(2048,8,t,e)}function Ku(t,e){return Ma(4,2,t,e)}function Qu(t,e){return Ma(4,4,t,e)}function Ju(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yu(t,e,r){return r=r!=null?r.concat([t]):null,Ma(4,4,Ju.bind(null,e,t),r)}function jl(){}function Xu(t,e){var r=ct();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&vl(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function Zu(t,e){var r=ct();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&vl(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function eh(t,e,r){return Nr&21?(vt(r,e)||(r=au(),pe.lanes|=r,kr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,We=!0),t.memoizedState=r)}function dp(t,e){var r=ae;ae=r!==0&&4>r?r:4,t(!0);var s=wi.transition;wi.transition={};try{t(!1),e()}finally{ae=r,wi.transition=s}}function th(){return ct().memoizedState}function up(t,e,r){var s=rr(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},rh(t))sh(e,r);else if(r=Lu(t,e,r,s),r!==null){var a=Fe();xt(r,t,s,a),nh(r,e,s)}}function hp(t,e,r){var s=rr(t),a={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(rh(t))sh(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,vt(l,o)){var c=e.interleaved;c===null?(a.next=a,fl(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=Lu(t,e,a,s),r!==null&&(a=Fe(),xt(r,t,s,a),nh(r,e,s))}}function rh(t){var e=t.alternate;return t===pe||e!==null&&e===pe}function sh(t,e){Us=ya=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function nh(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,el(t,r)}}var va={readContext:lt,useCallback:Oe,useContext:Oe,useEffect:Oe,useImperativeHandle:Oe,useInsertionEffect:Oe,useLayoutEffect:Oe,useMemo:Oe,useReducer:Oe,useRef:Oe,useState:Oe,useDebugValue:Oe,useDeferredValue:Oe,useTransition:Oe,useMutableSource:Oe,useSyncExternalStore:Oe,useId:Oe,unstable_isNewReconciler:!1},mp={readContext:lt,useCallback:function(t,e){return bt().memoizedState=[t,e===void 0?null:e],t},useContext:lt,useEffect:Tc,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Qn(4194308,4,Ju.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Qn(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qn(4,2,t,e)},useMemo:function(t,e){var r=bt();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=bt();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=up.bind(null,pe,t),[s.memoizedState,t]},useRef:function(t){var e=bt();return t={current:t},e.memoizedState=t},useState:Ec,useDebugValue:jl,useDeferredValue:function(t){return bt().memoizedState=t},useTransition:function(){var t=Ec(!1),e=t[0];return t=dp.bind(null,t[1]),bt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=pe,a=bt();if(me){if(r===void 0)throw Error(P(407));r=r()}else{if(r=e(),Ce===null)throw Error(P(349));Nr&30||Bu(s,e,r)}a.memoizedState=r;var i={value:r,getSnapshot:e};return a.queue=i,Tc(Hu.bind(null,s,i,t),[t]),s.flags|=2048,ln(9,qu.bind(null,s,i,r,e),void 0,null),r},useId:function(){var t=bt(),e=Ce.identifierPrefix;if(me){var r=Rt,s=Dt;r=(s&~(1<<32-gt(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=an++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=cp++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fp={readContext:lt,useCallback:Xu,useContext:lt,useEffect:_l,useImperativeHandle:Yu,useInsertionEffect:Ku,useLayoutEffect:Qu,useMemo:Zu,useReducer:bi,useRef:Gu,useState:function(){return bi(on)},useDebugValue:jl,useDeferredValue:function(t){var e=ct();return eh(e,_e.memoizedState,t)},useTransition:function(){var t=bi(on)[0],e=ct().memoizedState;return[t,e]},useMutableSource:zu,useSyncExternalStore:Fu,useId:th,unstable_isNewReconciler:!1},pp={readContext:lt,useCallback:Xu,useContext:lt,useEffect:_l,useImperativeHandle:Yu,useInsertionEffect:Ku,useLayoutEffect:Qu,useMemo:Zu,useReducer:_i,useRef:Gu,useState:function(){return _i(on)},useDebugValue:jl,useDeferredValue:function(t){var e=ct();return _e===null?e.memoizedState=t:eh(e,_e.memoizedState,t)},useTransition:function(){var t=_i(on)[0],e=ct().memoizedState;return[t,e]},useMutableSource:zu,useSyncExternalStore:Fu,useId:th,unstable_isNewReconciler:!1};function ht(t,e){if(t&&t.defaultProps){e=ge({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function mo(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:ge({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ua={isMounted:function(t){return(t=t._reactInternals)?Dr(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=Fe(),a=rr(t),i=Pt(s,a);i.payload=e,r!=null&&(i.callback=r),e=er(t,i,a),e!==null&&(xt(e,t,a,s),Gn(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=Fe(),a=rr(t),i=Pt(s,a);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=er(t,i,a),e!==null&&(xt(e,t,a,s),Gn(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Fe(),s=rr(t),a=Pt(r,s);a.tag=2,e!=null&&(a.callback=e),e=er(t,a,s),e!==null&&(xt(e,t,s,r),Gn(e,t,s))}};function Dc(t,e,r,s,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Zs(r,s)||!Zs(a,i):!0}function ah(t,e,r){var s=!1,a=ir,i=e.contextType;return typeof i=="object"&&i!==null?i=lt(i):(a=Ke(e)?_r:Le.current,s=e.contextTypes,i=(s=s!=null)?is(t,a):ir),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ua,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function Rc(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&Ua.enqueueReplaceState(e,e.state,null)}function fo(t,e,r,s){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},pl(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=lt(i):(i=Ke(e)?_r:Le.current,a.context=is(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(mo(t,e,i,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Ua.enqueueReplaceState(a,a.state,null),ga(t,r,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function ds(t,e){try{var r="",s=e;do r+=Bm(s),s=s.return;while(s);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function ji(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function po(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var gp=typeof WeakMap=="function"?WeakMap:Map;function ih(t,e,r){r=Pt(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){ba||(ba=!0,ko=s),po(t,e)},r}function oh(t,e,r){r=Pt(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;r.payload=function(){return s(a)},r.callback=function(){po(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){po(t,e),typeof s!="function"&&(tr===null?tr=new Set([this]):tr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Pc(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new gp;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(r)||(a.add(r),t=Dp.bind(null,t,e,r),e.then(t,t))}function Ic(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Oc(t,e,r,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Pt(-1,1),e.tag=2,er(r,e,1))),r.lanes|=1),t)}var xp=Lt.ReactCurrentOwner,We=!1;function ze(t,e,r,s){e.child=t===null?Au(e,null,r,s):ls(e,t.child,r,s)}function $c(t,e,r,s,a){r=r.render;var i=e.ref;return ss(e,a),s=wl(t,e,r,s,i,a),r=bl(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,At(t,e,a)):(me&&r&&ll(e),e.flags|=1,ze(t,e,s,a),e.child)}function Ac(t,e,r,s,a){if(t===null){var i=r.type;return typeof i=="function"&&!Rl(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,lh(t,e,i,s,a)):(t=Zn(r.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Zs,r(o,s)&&t.ref===e.ref)return At(t,e,a)}return e.flags|=1,t=sr(i,s),t.ref=e.ref,t.return=e,e.child=t}function lh(t,e,r,s,a){if(t!==null){var i=t.memoizedProps;if(Zs(i,s)&&t.ref===e.ref)if(We=!1,e.pendingProps=s=i,(t.lanes&a)!==0)t.flags&131072&&(We=!0);else return e.lanes=t.lanes,At(t,e,a)}return go(t,e,r,s,a)}function ch(t,e,r){var s=e.pendingProps,a=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(Xr,Je),Je|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ce(Xr,Je),Je|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,ce(Xr,Je),Je|=s}else i!==null?(s=i.baseLanes|r,e.memoizedState=null):s=r,ce(Xr,Je),Je|=s;return ze(t,e,a,r),e.child}function dh(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function go(t,e,r,s,a){var i=Ke(r)?_r:Le.current;return i=is(e,i),ss(e,a),r=wl(t,e,r,s,i,a),s=bl(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,At(t,e,a)):(me&&s&&ll(e),e.flags|=1,ze(t,e,r,a),e.child)}function Lc(t,e,r,s,a){if(Ke(r)){var i=!0;ua(e)}else i=!1;if(ss(e,a),e.stateNode===null)Jn(t,e),ah(e,r,s),fo(e,r,s,a),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=lt(d):(d=Ke(r)?_r:Le.current,d=is(e,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&Rc(e,o,s,d),Ht=!1;var m=e.memoizedState;o.state=m,ga(e,s,o,a),c=e.memoizedState,l!==s||m!==c||Ge.current||Ht?(typeof u=="function"&&(mo(e,r,u,s),c=e.memoizedState),(l=Ht||Dc(e,r,l,s,m,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,Mu(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ht(e.type,l),o.props=d,h=e.pendingProps,m=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=lt(c):(c=Ke(r)?_r:Le.current,c=is(e,c));var x=r.getDerivedStateFromProps;(u=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||m!==c)&&Rc(e,o,s,c),Ht=!1,m=e.memoizedState,o.state=m,ga(e,s,o,a);var v=e.memoizedState;l!==h||m!==v||Ge.current||Ht?(typeof x=="function"&&(mo(e,r,x,s),v=e.memoizedState),(d=Ht||Dc(e,r,d,s,m,v,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=v),o.props=s,o.state=v,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),s=!1)}return xo(t,e,r,s,i,a)}function xo(t,e,r,s,a,i){dh(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return a&&_c(e,r,!1),At(t,e,i);s=e.stateNode,xp.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=ls(e,t.child,null,i),e.child=ls(e,null,l,i)):ze(t,e,l,i),e.memoizedState=s.state,a&&_c(e,r,!0),e.child}function uh(t){var e=t.stateNode;e.pendingContext?bc(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bc(t,e.context,!1),gl(t,e.containerInfo)}function Mc(t,e,r,s,a){return os(),dl(a),e.flags|=256,ze(t,e,r,s),e.child}var yo={dehydrated:null,treeContext:null,retryLane:0};function vo(t){return{baseLanes:t,cachePool:null,transitions:null}}function hh(t,e,r){var s=e.pendingProps,a=fe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),ce(fe,a&1),t===null)return uo(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ba(o,s,0,null),t=br(t,s,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=vo(r),e.memoizedState=yo,t):Nl(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return yp(t,e,o,s,l,a,r);if(i){i=s.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=sr(a,c),s.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=sr(l,i):(i=br(i,o,r,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?vo(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=yo,s}return i=t.child,t=i.sibling,s=sr(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function Nl(t,e){return e=Ba({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function On(t,e,r,s){return s!==null&&dl(s),ls(e,t.child,null,r),t=Nl(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yp(t,e,r,s,a,i,o){if(r)return e.flags&256?(e.flags&=-257,s=ji(Error(P(422))),On(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,a=e.mode,s=Ba({mode:"visible",children:s.children},a,0,null),i=br(i,a,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&ls(e,t.child,null,o),e.child.memoizedState=vo(o),e.memoizedState=yo,i);if(!(e.mode&1))return On(t,e,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(P(419)),s=ji(i,s,void 0),On(t,e,o,s)}if(l=(o&t.childLanes)!==0,We||l){if(s=Ce,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,$t(t,a),xt(s,t,a,-1))}return Dl(),s=ji(Error(P(421))),On(t,e,o,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=Rp.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,Ye=Zt(a.nextSibling),Xe=e,me=!0,pt=null,t!==null&&(st[nt++]=Dt,st[nt++]=Rt,st[nt++]=jr,Dt=t.id,Rt=t.overflow,jr=e),e=Nl(e,s.children),e.flags|=4096,e)}function Uc(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),ho(t.return,e,r)}function Ni(t,e,r,s,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=a)}function mh(t,e,r){var s=e.pendingProps,a=s.revealOrder,i=s.tail;if(ze(t,e,s.children,r),s=fe.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Uc(t,r,e);else if(t.tag===19)Uc(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ce(fe,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&xa(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),Ni(e,!1,a,r,i);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&xa(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}Ni(e,!0,r,null,i);break;case"together":Ni(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jn(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function At(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),kr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(P(153));if(e.child!==null){for(t=e.child,r=sr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=sr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function vp(t,e,r){switch(e.tag){case 3:uh(e),os();break;case 5:Uu(e);break;case 1:Ke(e.type)&&ua(e);break;case 4:gl(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;ce(fa,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ce(fe,fe.current&1),e.flags|=128,null):r&e.child.childLanes?hh(t,e,r):(ce(fe,fe.current&1),t=At(t,e,r),t!==null?t.sibling:null);ce(fe,fe.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return mh(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ce(fe,fe.current),s)break;return null;case 22:case 23:return e.lanes=0,ch(t,e,r)}return At(t,e,r)}var fh,wo,ph,gh;fh=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wo=function(){};ph=function(t,e,r,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,vr(kt.current);var i=null;switch(r){case"input":a=Fi(t,a),s=Fi(t,s),i=[];break;case"select":a=ge({},a,{value:void 0}),s=ge({},s,{value:void 0}),i=[];break;case"textarea":a=Hi(t,a),s=Hi(t,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=ca)}Wi(r,s);var o;r=null;for(d in a)if(!s.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ws.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=a!=null?a[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ws.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&de("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};gh=function(t,e,r,s){r!==s&&(e.flags|=4)};function ks(t,e){if(!me)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function $e(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function wp(t,e,r){var s=e.pendingProps;switch(cl(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(e),null;case 1:return Ke(e.type)&&da(),$e(e),null;case 3:return s=e.stateNode,cs(),ue(Ge),ue(Le),yl(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Pn(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,pt!==null&&(Eo(pt),pt=null))),wo(t,e),$e(e),null;case 5:xl(e);var a=vr(nn.current);if(r=e.type,t!==null&&e.stateNode!=null)ph(t,e,r,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(P(166));return $e(e),null}if(t=vr(kt.current),Pn(e)){s=e.stateNode,r=e.type;var i=e.memoizedProps;switch(s[jt]=e,s[rn]=i,t=(e.mode&1)!==0,r){case"dialog":de("cancel",s),de("close",s);break;case"iframe":case"object":case"embed":de("load",s);break;case"video":case"audio":for(a=0;a<Rs.length;a++)de(Rs[a],s);break;case"source":de("error",s);break;case"img":case"image":case"link":de("error",s),de("load",s);break;case"details":de("toggle",s);break;case"input":Kl(s,i),de("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},de("invalid",s);break;case"textarea":Jl(s,i),de("invalid",s)}Wi(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Rn(s.textContent,l,t),a=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Rn(s.textContent,l,t),a=["children",""+l]):Ws.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&de("scroll",s)}switch(r){case"input":jn(s),Ql(s,i,!0);break;case"textarea":jn(s),Yl(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=ca)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Hd(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(r,{is:s.is}):(t=o.createElement(r),r==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,r),t[jt]=e,t[rn]=s,fh(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gi(r,s),r){case"dialog":de("cancel",t),de("close",t),a=s;break;case"iframe":case"object":case"embed":de("load",t),a=s;break;case"video":case"audio":for(a=0;a<Rs.length;a++)de(Rs[a],t);a=s;break;case"source":de("error",t),a=s;break;case"img":case"image":case"link":de("error",t),de("load",t),a=s;break;case"details":de("toggle",t),a=s;break;case"input":Kl(t,s),a=Fi(t,s),de("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=ge({},s,{value:void 0}),de("invalid",t);break;case"textarea":Jl(t,s),a=Hi(t,s),de("invalid",t);break;default:a=s}Wi(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Gd(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Vd(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Gs(t,c):typeof c=="number"&&Gs(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ws.hasOwnProperty(i)?c!=null&&i==="onScroll"&&de("scroll",t):c!=null&&Ko(t,i,c,o))}switch(r){case"input":jn(t),Ql(t,s,!1);break;case"textarea":jn(t),Yl(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ar(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Zr(t,!!s.multiple,i,!1):s.defaultValue!=null&&Zr(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=ca)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $e(e),null;case 6:if(t&&e.stateNode!=null)gh(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(P(166));if(r=vr(nn.current),vr(kt.current),Pn(e)){if(s=e.stateNode,r=e.memoizedProps,s[jt]=e,(i=s.nodeValue!==r)&&(t=Xe,t!==null))switch(t.tag){case 3:Rn(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Rn(s.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[jt]=e,e.stateNode=s}return $e(e),null;case 13:if(ue(fe),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(me&&Ye!==null&&e.mode&1&&!(e.flags&128))Ou(),os(),e.flags|=98560,i=!1;else if(i=Pn(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(P(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(P(317));i[jt]=e}else os(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$e(e),i=!1}else pt!==null&&(Eo(pt),pt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||fe.current&1?Ne===0&&(Ne=3):Dl())),e.updateQueue!==null&&(e.flags|=4),$e(e),null);case 4:return cs(),wo(t,e),t===null&&en(e.stateNode.containerInfo),$e(e),null;case 10:return ml(e.type._context),$e(e),null;case 17:return Ke(e.type)&&da(),$e(e),null;case 19:if(ue(fe),i=e.memoizedState,i===null)return $e(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)ks(i,!1);else{if(Ne!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xa(t),o!==null){for(e.flags|=128,ks(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)i=r,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ce(fe,fe.current&1|2),e.child}t=t.sibling}i.tail!==null&&ye()>us&&(e.flags|=128,s=!0,ks(i,!1),e.lanes=4194304)}else{if(!s)if(t=xa(o),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ks(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!me)return $e(e),null}else 2*ye()-i.renderingStartTime>us&&r!==1073741824&&(e.flags|=128,s=!0,ks(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ye(),e.sibling=null,r=fe.current,ce(fe,s?r&1|2:r&1),e):($e(e),null);case 22:case 23:return Tl(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Je&1073741824&&($e(e),e.subtreeFlags&6&&(e.flags|=8192)):$e(e),null;case 24:return null;case 25:return null}throw Error(P(156,e.tag))}function bp(t,e){switch(cl(e),e.tag){case 1:return Ke(e.type)&&da(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cs(),ue(Ge),ue(Le),yl(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return xl(e),null;case 13:if(ue(fe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(P(340));os()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ue(fe),null;case 4:return cs(),null;case 10:return ml(e.type._context),null;case 22:case 23:return Tl(),null;case 24:return null;default:return null}}var $n=!1,Ae=!1,_p=typeof WeakSet=="function"?WeakSet:Set,M=null;function Yr(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){xe(t,e,s)}else r.current=null}function bo(t,e,r){try{r()}catch(s){xe(t,e,s)}}var zc=!1;function jp(t,e){if(so=ia,t=bu(),ol(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=t,m=null;t:for(;;){for(var x;h!==r||a!==0&&h.nodeType!==3||(l=o+a),h!==i||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(x=h.firstChild)!==null;)m=h,h=x;for(;;){if(h===t)break t;if(m===r&&++d===a&&(l=o),m===i&&++u===s&&(c=o),(x=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=x}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(no={focusedElem:t,selectionRange:r},ia=!1,M=e;M!==null;)if(e=M,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,M=t;else for(;M!==null;){e=M;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var _=v.memoizedProps,C=v.memoizedState,g=e.stateNode,f=g.getSnapshotBeforeUpdate(e.elementType===e.type?_:ht(e.type,_),C);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=e.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(w){xe(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,M=t;break}M=e.return}return v=zc,zc=!1,v}function zs(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&bo(e,r,i)}a=a.next}while(a!==s)}}function za(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function _o(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function xh(t){var e=t.alternate;e!==null&&(t.alternate=null,xh(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jt],delete e[rn],delete e[oo],delete e[ap],delete e[ip])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yh(t){return t.tag===5||t.tag===3||t.tag===4}function Fc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jo(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ca));else if(s!==4&&(t=t.child,t!==null))for(jo(t,e,r),t=t.sibling;t!==null;)jo(t,e,r),t=t.sibling}function No(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(No(t,e,r),t=t.sibling;t!==null;)No(t,e,r),t=t.sibling}var Re=null,mt=!1;function zt(t,e,r){for(r=r.child;r!==null;)vh(t,e,r),r=r.sibling}function vh(t,e,r){if(Nt&&typeof Nt.onCommitFiberUnmount=="function")try{Nt.onCommitFiberUnmount(Pa,r)}catch{}switch(r.tag){case 5:Ae||Yr(r,e);case 6:var s=Re,a=mt;Re=null,zt(t,e,r),Re=s,mt=a,Re!==null&&(mt?(t=Re,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Re.removeChild(r.stateNode));break;case 18:Re!==null&&(mt?(t=Re,r=r.stateNode,t.nodeType===8?xi(t.parentNode,r):t.nodeType===1&&xi(t,r),Ys(t)):xi(Re,r.stateNode));break;case 4:s=Re,a=mt,Re=r.stateNode.containerInfo,mt=!0,zt(t,e,r),Re=s,mt=a;break;case 0:case 11:case 14:case 15:if(!Ae&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&bo(r,e,o),a=a.next}while(a!==s)}zt(t,e,r);break;case 1:if(!Ae&&(Yr(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){xe(r,e,l)}zt(t,e,r);break;case 21:zt(t,e,r);break;case 22:r.mode&1?(Ae=(s=Ae)||r.memoizedState!==null,zt(t,e,r),Ae=s):zt(t,e,r);break;default:zt(t,e,r)}}function Bc(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new _p),e.forEach(function(s){var a=Pp.bind(null,t,s);r.has(s)||(r.add(s),s.then(a,a))})}}function dt(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var a=r[s];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Re=l.stateNode,mt=!1;break e;case 3:Re=l.stateNode.containerInfo,mt=!0;break e;case 4:Re=l.stateNode.containerInfo,mt=!0;break e}l=l.return}if(Re===null)throw Error(P(160));vh(i,o,a),Re=null,mt=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){xe(a,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wh(e,t),e=e.sibling}function wh(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dt(e,t),wt(t),s&4){try{zs(3,t,t.return),za(3,t)}catch(_){xe(t,t.return,_)}try{zs(5,t,t.return)}catch(_){xe(t,t.return,_)}}break;case 1:dt(e,t),wt(t),s&512&&r!==null&&Yr(r,r.return);break;case 5:if(dt(e,t),wt(t),s&512&&r!==null&&Yr(r,r.return),t.flags&32){var a=t.stateNode;try{Gs(a,"")}catch(_){xe(t,t.return,_)}}if(s&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Bd(a,i),Gi(l,o);var d=Gi(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?Gd(a,h):u==="dangerouslySetInnerHTML"?Vd(a,h):u==="children"?Gs(a,h):Ko(a,u,h,d)}switch(l){case"input":Bi(a,i);break;case"textarea":qd(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Zr(a,!!i.multiple,x,!1):m!==!!i.multiple&&(i.defaultValue!=null?Zr(a,!!i.multiple,i.defaultValue,!0):Zr(a,!!i.multiple,i.multiple?[]:"",!1))}a[rn]=i}catch(_){xe(t,t.return,_)}}break;case 6:if(dt(e,t),wt(t),s&4){if(t.stateNode===null)throw Error(P(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(_){xe(t,t.return,_)}}break;case 3:if(dt(e,t),wt(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ys(e.containerInfo)}catch(_){xe(t,t.return,_)}break;case 4:dt(e,t),wt(t);break;case 13:dt(e,t),wt(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Cl=ye())),s&4&&Bc(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Ae=(d=Ae)||u,dt(e,t),Ae=d):dt(e,t),wt(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(M=t,u=t.child;u!==null;){for(h=M=u;M!==null;){switch(m=M,x=m.child,m.tag){case 0:case 11:case 14:case 15:zs(4,m,m.return);break;case 1:Yr(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){s=m,r=m.return;try{e=s,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(_){xe(s,r,_)}}break;case 5:Yr(m,m.return);break;case 22:if(m.memoizedState!==null){Hc(h);continue}}x!==null?(x.return=m,M=x):Hc(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Wd("display",o))}catch(_){xe(t,t.return,_)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(_){xe(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:dt(e,t),wt(t),s&4&&Bc(t);break;case 21:break;default:dt(e,t),wt(t)}}function wt(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(yh(r)){var s=r;break e}r=r.return}throw Error(P(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Gs(a,""),s.flags&=-33);var i=Fc(t);No(t,i,a);break;case 3:case 4:var o=s.stateNode.containerInfo,l=Fc(t);jo(t,l,o);break;default:throw Error(P(161))}}catch(c){xe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Np(t,e,r){M=t,bh(t)}function bh(t,e,r){for(var s=(t.mode&1)!==0;M!==null;){var a=M,i=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||$n;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ae;l=$n;var d=Ae;if($n=o,(Ae=c)&&!d)for(M=a;M!==null;)o=M,c=o.child,o.tag===22&&o.memoizedState!==null?Vc(a):c!==null?(c.return=o,M=c):Vc(a);for(;i!==null;)M=i,bh(i),i=i.sibling;M=a,$n=l,Ae=d}qc(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,M=i):qc(t)}}function qc(t){for(;M!==null;){var e=M;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ae||za(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ae)if(r===null)s.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:ht(e.type,r.memoizedProps);s.componentDidUpdate(a,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Cc(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Cc(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ys(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}Ae||e.flags&512&&_o(e)}catch(m){xe(e,e.return,m)}}if(e===t){M=null;break}if(r=e.sibling,r!==null){r.return=e.return,M=r;break}M=e.return}}function Hc(t){for(;M!==null;){var e=M;if(e===t){M=null;break}var r=e.sibling;if(r!==null){r.return=e.return,M=r;break}M=e.return}}function Vc(t){for(;M!==null;){var e=M;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{za(4,e)}catch(c){xe(e,r,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(c){xe(e,a,c)}}var i=e.return;try{_o(e)}catch(c){xe(e,i,c)}break;case 5:var o=e.return;try{_o(e)}catch(c){xe(e,o,c)}}}catch(c){xe(e,e.return,c)}if(e===t){M=null;break}var l=e.sibling;if(l!==null){l.return=e.return,M=l;break}M=e.return}}var kp=Math.ceil,wa=Lt.ReactCurrentDispatcher,kl=Lt.ReactCurrentOwner,it=Lt.ReactCurrentBatchConfig,se=0,Ce=null,ve=null,Pe=0,Je=0,Xr=lr(0),Ne=0,cn=null,kr=0,Fa=0,Sl=0,Fs=null,He=null,Cl=0,us=1/0,Ct=null,ba=!1,ko=null,tr=null,An=!1,Qt=null,_a=0,Bs=0,So=null,Yn=-1,Xn=0;function Fe(){return se&6?ye():Yn!==-1?Yn:Yn=ye()}function rr(t){return t.mode&1?se&2&&Pe!==0?Pe&-Pe:lp.transition!==null?(Xn===0&&(Xn=au()),Xn):(t=ae,t!==0||(t=window.event,t=t===void 0?16:hu(t.type)),t):1}function xt(t,e,r,s){if(50<Bs)throw Bs=0,So=null,Error(P(185));fn(t,r,s),(!(se&2)||t!==Ce)&&(t===Ce&&(!(se&2)&&(Fa|=r),Ne===4&&Wt(t,Pe)),Qe(t,s),r===1&&se===0&&!(e.mode&1)&&(us=ye()+500,La&&cr()))}function Qe(t,e){var r=t.callbackNode;lf(t,e);var s=aa(t,t===Ce?Pe:0);if(s===0)r!==null&&ec(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&ec(r),e===1)t.tag===0?op(Wc.bind(null,t)):Ru(Wc.bind(null,t)),sp(function(){!(se&6)&&cr()}),r=null;else{switch(iu(s)){case 1:r=Zo;break;case 4:r=su;break;case 16:r=na;break;case 536870912:r=nu;break;default:r=na}r=Th(r,_h.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function _h(t,e){if(Yn=-1,Xn=0,se&6)throw Error(P(327));var r=t.callbackNode;if(ns()&&t.callbackNode!==r)return null;var s=aa(t,t===Ce?Pe:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=ja(t,s);else{e=s;var a=se;se|=2;var i=Nh();(Ce!==t||Pe!==e)&&(Ct=null,us=ye()+500,wr(t,e));do try{Ep();break}catch(l){jh(t,l)}while(!0);hl(),wa.current=i,se=a,ve!==null?e=0:(Ce=null,Pe=0,e=Ne)}if(e!==0){if(e===2&&(a=Xi(t),a!==0&&(s=a,e=Co(t,a))),e===1)throw r=cn,wr(t,0),Wt(t,s),Qe(t,ye()),r;if(e===6)Wt(t,s);else{if(a=t.current.alternate,!(s&30)&&!Sp(a)&&(e=ja(t,s),e===2&&(i=Xi(t),i!==0&&(s=i,e=Co(t,i))),e===1))throw r=cn,wr(t,0),Wt(t,s),Qe(t,ye()),r;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(P(345));case 2:fr(t,He,Ct);break;case 3:if(Wt(t,s),(s&130023424)===s&&(e=Cl+500-ye(),10<e)){if(aa(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){Fe(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=io(fr.bind(null,t,He,Ct),e);break}fr(t,He,Ct);break;case 4:if(Wt(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var o=31-gt(s);i=1<<o,o=e[o],o>a&&(a=o),s&=~i}if(s=a,s=ye()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*kp(s/1960))-s,10<s){t.timeoutHandle=io(fr.bind(null,t,He,Ct),s);break}fr(t,He,Ct);break;case 5:fr(t,He,Ct);break;default:throw Error(P(329))}}}return Qe(t,ye()),t.callbackNode===r?_h.bind(null,t):null}function Co(t,e){var r=Fs;return t.current.memoizedState.isDehydrated&&(wr(t,e).flags|=256),t=ja(t,e),t!==2&&(e=He,He=r,e!==null&&Eo(e)),t}function Eo(t){He===null?He=t:He.push.apply(He,t)}function Sp(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var a=r[s],i=a.getSnapshot;a=a.value;try{if(!vt(i(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wt(t,e){for(e&=~Sl,e&=~Fa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-gt(e),s=1<<r;t[r]=-1,e&=~s}}function Wc(t){if(se&6)throw Error(P(327));ns();var e=aa(t,0);if(!(e&1))return Qe(t,ye()),null;var r=ja(t,e);if(t.tag!==0&&r===2){var s=Xi(t);s!==0&&(e=s,r=Co(t,s))}if(r===1)throw r=cn,wr(t,0),Wt(t,e),Qe(t,ye()),r;if(r===6)throw Error(P(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fr(t,He,Ct),Qe(t,ye()),null}function El(t,e){var r=se;se|=1;try{return t(e)}finally{se=r,se===0&&(us=ye()+500,La&&cr())}}function Sr(t){Qt!==null&&Qt.tag===0&&!(se&6)&&ns();var e=se;se|=1;var r=it.transition,s=ae;try{if(it.transition=null,ae=1,t)return t()}finally{ae=s,it.transition=r,se=e,!(se&6)&&cr()}}function Tl(){Je=Xr.current,ue(Xr)}function wr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,rp(r)),ve!==null)for(r=ve.return;r!==null;){var s=r;switch(cl(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&da();break;case 3:cs(),ue(Ge),ue(Le),yl();break;case 5:xl(s);break;case 4:cs();break;case 13:ue(fe);break;case 19:ue(fe);break;case 10:ml(s.type._context);break;case 22:case 23:Tl()}r=r.return}if(Ce=t,ve=t=sr(t.current,null),Pe=Je=e,Ne=0,cn=null,Sl=Fa=kr=0,He=Fs=null,yr!==null){for(e=0;e<yr.length;e++)if(r=yr[e],s=r.interleaved,s!==null){r.interleaved=null;var a=s.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,s.next=o}r.pending=s}yr=null}return t}function jh(t,e){do{var r=ve;try{if(hl(),Kn.current=va,ya){for(var s=pe.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}ya=!1}if(Nr=0,Se=_e=pe=null,Us=!1,an=0,kl.current=null,r===null||r.return===null){Ne=1,cn=e,ve=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=Pe,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var x=Ic(o);if(x!==null){x.flags&=-257,Oc(x,o,l,i,e),x.mode&1&&Pc(i,d,e),e=x,c=d;var v=e.updateQueue;if(v===null){var _=new Set;_.add(c),e.updateQueue=_}else v.add(c);break e}else{if(!(e&1)){Pc(i,d,e),Dl();break e}c=Error(P(426))}}else if(me&&l.mode&1){var C=Ic(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Oc(C,o,l,i,e),dl(ds(c,l));break e}}i=c=ds(c,l),Ne!==4&&(Ne=2),Fs===null?Fs=[i]:Fs.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=ih(i,c,e);Sc(i,g);break e;case 1:l=c;var f=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(tr===null||!tr.has(p)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=oh(i,l,e);Sc(i,w);break e}}i=i.return}while(i!==null)}Sh(r)}catch(S){e=S,ve===r&&r!==null&&(ve=r=r.return);continue}break}while(!0)}function Nh(){var t=wa.current;return wa.current=va,t===null?va:t}function Dl(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),Ce===null||!(kr&268435455)&&!(Fa&268435455)||Wt(Ce,Pe)}function ja(t,e){var r=se;se|=2;var s=Nh();(Ce!==t||Pe!==e)&&(Ct=null,wr(t,e));do try{Cp();break}catch(a){jh(t,a)}while(!0);if(hl(),se=r,wa.current=s,ve!==null)throw Error(P(261));return Ce=null,Pe=0,Ne}function Cp(){for(;ve!==null;)kh(ve)}function Ep(){for(;ve!==null&&!Xm();)kh(ve)}function kh(t){var e=Eh(t.alternate,t,Je);t.memoizedProps=t.pendingProps,e===null?Sh(t):ve=e,kl.current=null}function Sh(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=bp(r,e),r!==null){r.flags&=32767,ve=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ne=6,ve=null;return}}else if(r=wp(r,e,Je),r!==null){ve=r;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);Ne===0&&(Ne=5)}function fr(t,e,r){var s=ae,a=it.transition;try{it.transition=null,ae=1,Tp(t,e,r,s)}finally{it.transition=a,ae=s}return null}function Tp(t,e,r,s){do ns();while(Qt!==null);if(se&6)throw Error(P(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(P(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(cf(t,i),t===Ce&&(ve=Ce=null,Pe=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||An||(An=!0,Th(na,function(){return ns(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=it.transition,it.transition=null;var o=ae;ae=1;var l=se;se|=4,kl.current=null,jp(t,r),wh(r,t),Qf(no),ia=!!so,no=so=null,t.current=r,Np(r),Zm(),se=l,ae=o,it.transition=i}else t.current=r;if(An&&(An=!1,Qt=t,_a=a),i=t.pendingLanes,i===0&&(tr=null),rf(r.stateNode),Qe(t,ye()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],s(a.value,{componentStack:a.stack,digest:a.digest});if(ba)throw ba=!1,t=ko,ko=null,t;return _a&1&&t.tag!==0&&ns(),i=t.pendingLanes,i&1?t===So?Bs++:(Bs=0,So=t):Bs=0,cr(),null}function ns(){if(Qt!==null){var t=iu(_a),e=it.transition,r=ae;try{if(it.transition=null,ae=16>t?16:t,Qt===null)var s=!1;else{if(t=Qt,Qt=null,_a=0,se&6)throw Error(P(331));var a=se;for(se|=4,M=t.current;M!==null;){var i=M,o=i.child;if(M.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(M=d;M!==null;){var u=M;switch(u.tag){case 0:case 11:case 15:zs(8,u,i)}var h=u.child;if(h!==null)h.return=u,M=h;else for(;M!==null;){u=M;var m=u.sibling,x=u.return;if(xh(u),u===d){M=null;break}if(m!==null){m.return=x,M=m;break}M=x}}}var v=i.alternate;if(v!==null){var _=v.child;if(_!==null){v.child=null;do{var C=_.sibling;_.sibling=null,_=C}while(_!==null)}}M=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,M=o;else e:for(;M!==null;){if(i=M,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zs(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,M=g;break e}M=i.return}}var f=t.current;for(M=f;M!==null;){o=M;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,M=p;else e:for(o=f;M!==null;){if(l=M,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:za(9,l)}}catch(S){xe(l,l.return,S)}if(l===o){M=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,M=w;break e}M=l.return}}if(se=a,cr(),Nt&&typeof Nt.onPostCommitFiberRoot=="function")try{Nt.onPostCommitFiberRoot(Pa,t)}catch{}s=!0}return s}finally{ae=r,it.transition=e}}return!1}function Gc(t,e,r){e=ds(r,e),e=ih(t,e,1),t=er(t,e,1),e=Fe(),t!==null&&(fn(t,1,e),Qe(t,e))}function xe(t,e,r){if(t.tag===3)Gc(t,t,r);else for(;e!==null;){if(e.tag===3){Gc(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(tr===null||!tr.has(s))){t=ds(r,t),t=oh(e,t,1),e=er(e,t,1),t=Fe(),e!==null&&(fn(e,1,t),Qe(e,t));break}}e=e.return}}function Dp(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=Fe(),t.pingedLanes|=t.suspendedLanes&r,Ce===t&&(Pe&r)===r&&(Ne===4||Ne===3&&(Pe&130023424)===Pe&&500>ye()-Cl?wr(t,0):Sl|=r),Qe(t,e)}function Ch(t,e){e===0&&(t.mode&1?(e=Sn,Sn<<=1,!(Sn&130023424)&&(Sn=4194304)):e=1);var r=Fe();t=$t(t,e),t!==null&&(fn(t,e,r),Qe(t,r))}function Rp(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Ch(t,r)}function Pp(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(P(314))}s!==null&&s.delete(e),Ch(t,r)}var Eh;Eh=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ge.current)We=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return We=!1,vp(t,e,r);We=!!(t.flags&131072)}else We=!1,me&&e.flags&1048576&&Pu(e,ma,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Jn(t,e),t=e.pendingProps;var a=is(e,Le.current);ss(e,r),a=wl(null,e,s,t,a,r);var i=bl();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ke(s)?(i=!0,ua(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,pl(e),a.updater=Ua,e.stateNode=a,a._reactInternals=e,fo(e,s,t,r),e=xo(null,e,s,!0,i,r)):(e.tag=0,me&&i&&ll(e),ze(null,e,a,r),e=e.child),e;case 16:s=e.elementType;e:{switch(Jn(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=Op(s),t=ht(s,t),a){case 0:e=go(null,e,s,t,r);break e;case 1:e=Lc(null,e,s,t,r);break e;case 11:e=$c(null,e,s,t,r);break e;case 14:e=Ac(null,e,s,ht(s.type,t),r);break e}throw Error(P(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ht(s,a),go(t,e,s,a,r);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ht(s,a),Lc(t,e,s,a,r);case 3:e:{if(uh(e),t===null)throw Error(P(387));s=e.pendingProps,i=e.memoizedState,a=i.element,Mu(t,e),ga(e,s,null,r);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=ds(Error(P(423)),e),e=Mc(t,e,s,r,a);break e}else if(s!==a){a=ds(Error(P(424)),e),e=Mc(t,e,s,r,a);break e}else for(Ye=Zt(e.stateNode.containerInfo.firstChild),Xe=e,me=!0,pt=null,r=Au(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(os(),s===a){e=At(t,e,r);break e}ze(t,e,s,r)}e=e.child}return e;case 5:return Uu(e),t===null&&uo(e),s=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,ao(s,a)?o=null:i!==null&&ao(s,i)&&(e.flags|=32),dh(t,e),ze(t,e,o,r),e.child;case 6:return t===null&&uo(e),null;case 13:return hh(t,e,r);case 4:return gl(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ls(e,null,s,r):ze(t,e,s,r),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ht(s,a),$c(t,e,s,a,r);case 7:return ze(t,e,e.pendingProps,r),e.child;case 8:return ze(t,e,e.pendingProps.children,r),e.child;case 12:return ze(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,ce(fa,s._currentValue),s._currentValue=o,i!==null)if(vt(i.value,o)){if(i.children===a.children&&!Ge.current){e=At(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Pt(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ho(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(P(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),ho(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ze(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,ss(e,r),a=lt(a),s=s(a),e.flags|=1,ze(t,e,s,r),e.child;case 14:return s=e.type,a=ht(s,e.pendingProps),a=ht(s.type,a),Ac(t,e,s,a,r);case 15:return lh(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ht(s,a),Jn(t,e),e.tag=1,Ke(s)?(t=!0,ua(e)):t=!1,ss(e,r),ah(e,s,a),fo(e,s,a,r),xo(null,e,s,!0,t,r);case 19:return mh(t,e,r);case 22:return ch(t,e,r)}throw Error(P(156,e.tag))};function Th(t,e){return ru(t,e)}function Ip(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function at(t,e,r,s){return new Ip(t,e,r,s)}function Rl(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Op(t){if(typeof t=="function")return Rl(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jo)return 11;if(t===Yo)return 14}return 2}function sr(t,e){var r=t.alternate;return r===null?(r=at(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Zn(t,e,r,s,a,i){var o=2;if(s=t,typeof t=="function")Rl(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Br:return br(r.children,a,i,e);case Qo:o=8,a|=8;break;case Li:return t=at(12,r,e,a|2),t.elementType=Li,t.lanes=i,t;case Mi:return t=at(13,r,e,a),t.elementType=Mi,t.lanes=i,t;case Ui:return t=at(19,r,e,a),t.elementType=Ui,t.lanes=i,t;case Ud:return Ba(r,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ld:o=10;break e;case Md:o=9;break e;case Jo:o=11;break e;case Yo:o=14;break e;case qt:o=16,s=null;break e}throw Error(P(130,t==null?t:typeof t,""))}return e=at(o,r,e,a),e.elementType=t,e.type=s,e.lanes=i,e}function br(t,e,r,s){return t=at(7,t,s,e),t.lanes=r,t}function Ba(t,e,r,s){return t=at(22,t,s,e),t.elementType=Ud,t.lanes=r,t.stateNode={isHidden:!1},t}function ki(t,e,r){return t=at(6,t,null,e),t.lanes=r,t}function Si(t,e,r){return e=at(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $p(t,e,r,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ii(0),this.expirationTimes=ii(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ii(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Pl(t,e,r,s,a,i,o,l,c){return t=new $p(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=at(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},pl(i),t}function Ap(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fr,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function Dh(t){if(!t)return ir;t=t._reactInternals;e:{if(Dr(t)!==t||t.tag!==1)throw Error(P(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ke(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(P(171))}if(t.tag===1){var r=t.type;if(Ke(r))return Du(t,r,e)}return e}function Rh(t,e,r,s,a,i,o,l,c){return t=Pl(r,s,!0,t,a,i,o,l,c),t.context=Dh(null),r=t.current,s=Fe(),a=rr(r),i=Pt(s,a),i.callback=e??null,er(r,i,a),t.current.lanes=a,fn(t,a,s),Qe(t,s),t}function qa(t,e,r,s){var a=e.current,i=Fe(),o=rr(a);return r=Dh(r),e.context===null?e.context=r:e.pendingContext=r,e=Pt(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=er(a,e,o),t!==null&&(xt(t,a,o,i),Gn(t,a,o)),o}function Na(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Kc(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Il(t,e){Kc(t,e),(t=t.alternate)&&Kc(t,e)}function Lp(){return null}var Ph=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ol(t){this._internalRoot=t}Ha.prototype.render=Ol.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(P(409));qa(t,e,null,null)};Ha.prototype.unmount=Ol.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Sr(function(){qa(null,t,null,null)}),e[Ot]=null}};function Ha(t){this._internalRoot=t}Ha.prototype.unstable_scheduleHydration=function(t){if(t){var e=cu();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Vt.length&&e!==0&&e<Vt[r].priority;r++);Vt.splice(r,0,t),r===0&&uu(t)}};function $l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Va(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qc(){}function Mp(t,e,r,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var d=Na(o);i.call(d)}}var o=Rh(e,s,t,0,null,!1,!1,"",Qc);return t._reactRootContainer=o,t[Ot]=o.current,en(t.nodeType===8?t.parentNode:t),Sr(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var l=s;s=function(){var d=Na(c);l.call(d)}}var c=Pl(t,0,!1,null,null,!1,!1,"",Qc);return t._reactRootContainer=c,t[Ot]=c.current,en(t.nodeType===8?t.parentNode:t),Sr(function(){qa(e,c,r,s)}),c}function Wa(t,e,r,s,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=Na(o);l.call(c)}}qa(e,o,t,a)}else o=Mp(r,e,t,a,s);return Na(o)}ou=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ds(e.pendingLanes);r!==0&&(el(e,r|1),Qe(e,ye()),!(se&6)&&(us=ye()+500,cr()))}break;case 13:Sr(function(){var s=$t(t,1);if(s!==null){var a=Fe();xt(s,t,1,a)}}),Il(t,1)}};tl=function(t){if(t.tag===13){var e=$t(t,134217728);if(e!==null){var r=Fe();xt(e,t,134217728,r)}Il(t,134217728)}};lu=function(t){if(t.tag===13){var e=rr(t),r=$t(t,e);if(r!==null){var s=Fe();xt(r,t,e,s)}Il(t,e)}};cu=function(){return ae};du=function(t,e){var r=ae;try{return ae=t,e()}finally{ae=r}};Qi=function(t,e,r){switch(e){case"input":if(Bi(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var a=Aa(s);if(!a)throw Error(P(90));Fd(s),Bi(s,a)}}}break;case"textarea":qd(t,r);break;case"select":e=r.value,e!=null&&Zr(t,!!r.multiple,e,!1)}};Jd=El;Yd=Sr;var Up={usingClientEntryPoint:!1,Events:[gn,Wr,Aa,Kd,Qd,El]},Ss={findFiberByHostInstance:xr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zp={bundleType:Ss.bundleType,version:Ss.version,rendererPackageName:Ss.rendererPackageName,rendererConfig:Ss.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=eu(t),t===null?null:t.stateNode},findFiberByHostInstance:Ss.findFiberByHostInstance||Lp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ln=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ln.isDisabled&&Ln.supportsFiber)try{Pa=Ln.inject(zp),Nt=Ln}catch{}}et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Up;et.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$l(e))throw Error(P(200));return Ap(t,e,null,r)};et.createRoot=function(t,e){if(!$l(t))throw Error(P(299));var r=!1,s="",a=Ph;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Pl(t,1,!1,null,null,r,!1,s,a),t[Ot]=e.current,en(t.nodeType===8?t.parentNode:t),new Ol(e)};et.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(P(188)):(t=Object.keys(t).join(","),Error(P(268,t)));return t=eu(e),t=t===null?null:t.stateNode,t};et.flushSync=function(t){return Sr(t)};et.hydrate=function(t,e,r){if(!Va(e))throw Error(P(200));return Wa(null,t,e,!0,r)};et.hydrateRoot=function(t,e,r){if(!$l(t))throw Error(P(405));var s=r!=null&&r.hydratedSources||null,a=!1,i="",o=Ph;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Rh(e,null,t,1,r??null,a,!1,i,o),t[Ot]=e.current,en(t),s)for(t=0;t<s.length;t++)r=s[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new Ha(e)};et.render=function(t,e,r){if(!Va(e))throw Error(P(200));return Wa(null,t,e,!1,r)};et.unmountComponentAtNode=function(t){if(!Va(t))throw Error(P(40));return t._reactRootContainer?(Sr(function(){Wa(null,null,t,!1,function(){t._reactRootContainer=null,t[Ot]=null})}),!0):!1};et.unstable_batchedUpdates=El;et.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!Va(r))throw Error(P(200));if(t==null||t._reactInternals===void 0)throw Error(P(38));return Wa(t,e,r,!1,s)};et.version="18.3.1-next-f1338f8080-20240426";function Ih(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ih)}catch(t){console.error(t)}}Ih(),Id.exports=et;var Fp=Id.exports,Oh,Jc=Fp;Oh=Jc.createRoot,Jc.hydrateRoot;const Bp="modulepreload",qp=function(t){return"/pms/"+t},Yc={},yn=function(e,r,s){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=qp(c),c in Yc)return;Yc[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Bp,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,x)=>{h.addEventListener("load",m),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Hp=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>yn(async()=>{const{default:s}=await Promise.resolve().then(()=>gs);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class Al extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Vp extends Al{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Xc extends Al{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Zc extends Al{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var To;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(To||(To={}));var Wp=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class Gp{constructor(e,{headers:r={},customFetch:s,region:a=To.Any}={}){this.url=e,this.headers=r,this.region=a,this.fetch=Hp(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return Wp(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:u}).catch(_=>{throw new Vp(_)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Xc(h);if(!h.ok)throw new Zc(h);let x=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),v;return x==="application/json"?v=yield h.json():x==="application/octet-stream"?v=yield h.blob():x==="text/event-stream"?v=h:x==="multipart/form-data"?v=yield h.formData():v=yield h.text(),{data:v,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Zc||a instanceof Xc?a.context:void 0}}})}}var Ve={},Ll={},Ga={},vn={},Ka={},Qa={},Kp=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},hs=Kp();const Qp=hs.fetch,$h=hs.fetch.bind(hs),Ah=hs.Headers,Jp=hs.Request,Yp=hs.Response,gs=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ah,Request:Jp,Response:Yp,default:$h,fetch:Qp},Symbol.toStringTag,{value:"Module"})),Xp=fm(gs);var Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});let Zp=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ja.default=Zp;var Lh=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qa,"__esModule",{value:!0});const eg=Lh(Xp),tg=Lh(Ja);let rg=class{constructor(e){var r,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=eg.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c,d;let u=null,h=null,m=null,x=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const f=await i.text();f===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?h=f:h=JSON.parse(f))}const C=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),g=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");C&&g&&g.length>1&&(m=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,m=null,x=406,v="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const C=await i.text();try{u=JSON.parse(C),Array.isArray(u)&&i.status===404&&(h=[],u=null,x=200,v="OK")}catch{i.status===404&&C===""?(x=204,v="No Content"):u={message:C}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,x=200,v="OK"),u&&this.shouldThrowOnError)throw new tg.default(u)}return{error:u,data:h,count:m,status:x,statusText:v}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,r)}returns(){return this}overrideTypes(){return this}};Qa.default=rg;var sg=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ka,"__esModule",{value:!0});const ng=sg(Qa);let ag=class extends ng.default{select(e){let r=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:s,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,r,{foreignTable:s,referencedTable:a=s}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:s=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,r?"verbose":null,s?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Ka.default=ag;var ig=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vn,"__esModule",{value:!0});const og=ig(Ka);let lg=class extends og.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const s=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:s,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${r}`),this}match(e){return Object.entries(e).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(e,r,s){return this.url.searchParams.append(e,`not.${r}.${s}`),this}or(e,{foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,r,s){return this.url.searchParams.append(e,`${r}.${s}`),this}};vn.default=lg;var cg=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ga,"__esModule",{value:!0});const Cs=cg(vn);let dg=class{constructor(e,{headers:r={},schema:s,fetch:a}){this.url=e,this.headers=new Headers(r),this.schema=s,this.fetch=a}select(e,{head:r=!1,count:s}={}){const a=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new Cs.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:s=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Cs.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:s=!1,count:a,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Cs.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:r}={}){var s;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Cs.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var r;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Cs.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Ga.default=dg;var Mh=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ll,"__esModule",{value:!0});const ug=Mh(Ga),hg=Mh(vn);let mg=class Uh{constructor(e,{headers:r={},schema:s,fetch:a}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(e){const r=new URL(`${this.url}/${e}`);return new ug.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Uh(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:a=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;s||a?(l=s?"HEAD":"GET",Object.entries(r).filter(([h,m])=>m!==void 0).map(([h,m])=>[h,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([h,m])=>{c.searchParams.append(h,m)})):(l="POST",d=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new hg.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Ll.default=mg;var xs=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.PostgrestError=Ve.PostgrestBuilder=Ve.PostgrestTransformBuilder=Ve.PostgrestFilterBuilder=Ve.PostgrestQueryBuilder=Ve.PostgrestClient=void 0;const zh=xs(Ll);Ve.PostgrestClient=zh.default;const Fh=xs(Ga);Ve.PostgrestQueryBuilder=Fh.default;const Bh=xs(vn);Ve.PostgrestFilterBuilder=Bh.default;const qh=xs(Ka);Ve.PostgrestTransformBuilder=qh.default;const Hh=xs(Qa);Ve.PostgrestBuilder=Hh.default;const Vh=xs(Ja);Ve.PostgrestError=Vh.default;var fg=Ve.default={PostgrestClient:zh.default,PostgrestQueryBuilder:Fh.default,PostgrestFilterBuilder:Bh.default,PostgrestTransformBuilder:qh.default,PostgrestBuilder:Hh.default,PostgrestError:Vh.default};const{PostgrestClient:pg,PostgrestQueryBuilder:ay,PostgrestFilterBuilder:iy,PostgrestTransformBuilder:oy,PostgrestBuilder:ly,PostgrestError:cy}=fg;class gg{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const xg="2.15.5",yg=`realtime-js/${xg}`,vg="1.0.0",Do=1e4,wg=1e3,bg=100;var qs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(qs||(qs={}));var we;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(we||(we={}));var ft;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ft||(ft={}));var Ro;(function(t){t.websocket="websocket"})(Ro||(Ro={}));var gr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(gr||(gr={}));class _g{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const a=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+a));o=o+a;const c=s.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Wh{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var le;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(le||(le={}));const ed=(t,e,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=jg(o,t,e,a),i),{})},jg=(t,e,r,s)=>{const a=e.find(l=>l.name===t),i=a==null?void 0:a.type,o=r[t];return i&&!s.includes(i)?Gh(i,o):Po(o)},Gh=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Cg(e,r)}switch(t){case le.bool:return Ng(e);case le.float4:case le.float8:case le.int2:case le.int4:case le.int8:case le.numeric:case le.oid:return kg(e);case le.json:case le.jsonb:return Sg(e);case le.timestamp:return Eg(e);case le.abstime:case le.date:case le.daterange:case le.int4range:case le.int8range:case le.money:case le.reltime:case le.text:case le.time:case le.timestamptz:case le.timetz:case le.tsrange:case le.tstzrange:return Po(e);default:return Po(e)}},Po=t=>t,Ng=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},kg=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Sg=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Cg=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Gh(e,l))}return t},Eg=t=>typeof t=="string"?t.replace(" ","T"):t,Kh=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Ci{constructor(e,r,s={},a=Do){this.channel=e,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var td;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(td||(td={}));class Hs{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Hs.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Hs.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Hs.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,a){const i=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const m=u.map(C=>C.presence_ref),x=h.map(C=>C.presence_ref),v=u.filter(C=>x.indexOf(C.presence_ref)<0),_=h.filter(C=>m.indexOf(C.presence_ref)<0);v.length>0&&(l[d]=v),_.length>0&&(c[d]=_)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},s,a)}static syncDiff(e,r,s,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(x=>x.presence_ref),m=u.filter(x=>h.indexOf(x.presence_ref)<0);e[l].unshift(...m)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,a(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const a=e[s];return"metas"in a?r[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=a,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var rd;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(rd||(rd={}));var Vs;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Vs||(Vs={}));var Et;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Et||(Et={}));class Ml{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=we.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ci(this,ft.join,this.params,this.timeout),this.rejoinTimer=new Wh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=we.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=we.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ft.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Hs(this),this.broadcastEndpointURL=Kh(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==we.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(x=>x.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Vs.PRESENCE]&&this.bindings[Vs.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},m={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(Et.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(Et.CLOSED)),this.updateJoinPayload(Object.assign({config:m},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var v;if(this.socket.setAuth(),x===void 0){e==null||e(Et.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,C=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,g=[];for(let f=0;f<C;f++){const p=_[f],{filter:{event:w,schema:S,table:k,filter:j}}=p,E=x&&x[f];if(E&&E.event===w&&E.schema===S&&E.table===k&&E.filter===j)g.push(Object.assign(Object.assign({},p),{id:E.id}));else{this.unsubscribe(),this.state=we.errored,e==null||e(Et.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Et.SUBSCRIBED);return}}).receive("error",x=>{this.state=we.errored,e==null||e(Et.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Et.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===we.joined&&e===Vs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,s)}async send(e,r={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=we.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ft.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Ci(this,ft.leave,{},e),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=we.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ci(this,e,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bg){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=ft;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let m=this._onMessage(o,r,s);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var v,_,C;return((v=x.filter)===null||v===void 0?void 0:v.event)==="*"||((C=(_=x.filter)===null||_===void 0?void 0:_.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===o}).map(x=>x.callback(m,s)):(i=this.bindings[o])===null||i===void 0||i.filter(x=>{var v,_,C,g,f,p;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in x){const w=x.id,S=(v=x.filter)===null||v===void 0?void 0:v.event;return w&&((_=r.ids)===null||_===void 0?void 0:_.includes(w))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((C=r.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const w=(f=(g=x==null?void 0:x.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===o}).map(x=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:_,table:C,commit_timestamp:g,type:f,errors:p}=v;m=Object.assign(Object.assign({},{schema:_,table:C,commit_timestamp:g,eventType:f,new:{},old:{},errors:p}),this._getPayloadRecords(v))}x.callback(m,s)})}_isClosed(){return this.state===we.closed}_isJoined(){return this.state===we.joined}_isJoining(){return this.state===we.joining}_isLeaving(){return this.state===we.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const a=e.toLocaleLowerCase(),i={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Ml.isEqual(a.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ft.close,{},e)}_onError(e){this._on(ft.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=we.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=ed(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=ed(e.columns,e.old_record)),r}}const Ei=()=>{},Mn={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Tg=[1e3,2e3,5e3,1e4],Dg=1e4,Rg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pg{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Do,this.transport=null,this.heartbeatIntervalMs=Mn.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ei,this.ref=0,this.reconnectTimer=null,this.logger=Ei,this.conn=null,this.sendBuffer=[],this.serializer=new _g,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>yn(async()=>{const{default:l}=await Promise.resolve().then(()=>gs);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Ro.websocket}`,this.httpEndpoint=Kh(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gg.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vg}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qs.connecting:return gr.Connecting;case qs.open:return gr.Open;case qs.closing:return gr.Closing;default:return gr.Closed}}isConnected(){return this.connectionState()===gr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new Ml(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(wg,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Mn.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ft.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${e}${s}${a}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([Rg],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:yg};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(ft.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Wh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Mn.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,a,i,o,l,c,d,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Do,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:Mn.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Ei,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:h=>Tg[h-1]||Dg,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(h,m)=>m(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Ul extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function be(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Ig extends Ul{constructor(e,r,s){super(e),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Io extends Ul{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Og=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Qh=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>yn(async()=>{const{default:s}=await Promise.resolve().then(()=>gs);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},$g=()=>Og(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield yn(()=>Promise.resolve().then(()=>gs),void 0)).Response:Response}),Oo=t=>{if(Array.isArray(t))return t.map(r=>Oo(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Oo(s)}),e},Ag=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Rr=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Ti=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Lg=(t,e,r)=>Rr(void 0,void 0,void 0,function*(){const s=yield $g();t instanceof s&&!(r!=null&&r.noResolveJson)?t.json().then(a=>{const i=t.status||500,o=(a==null?void 0:a.statusCode)||i+"";e(new Ig(Ti(a),i,o))}).catch(a=>{e(new Io(Ti(a),a))}):e(new Io(Ti(t),t))}),Mg=(t,e,r,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?a:(Ag(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(s)):a.body=s,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),r))};function wn(t,e,r,s,a,i){return Rr(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,Mg(e,s,a,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Lg(c,l,s))})})}function ka(t,e,r,s){return Rr(this,void 0,void 0,function*(){return wn(t,"GET",e,r,s)})}function _t(t,e,r,s,a){return Rr(this,void 0,void 0,function*(){return wn(t,"POST",e,s,a,r)})}function $o(t,e,r,s,a){return Rr(this,void 0,void 0,function*(){return wn(t,"PUT",e,s,a,r)})}function Ug(t,e,r,s){return Rr(this,void 0,void 0,function*(){return wn(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Jh(t,e,r,s,a){return Rr(this,void 0,void 0,function*(){return wn(t,"DELETE",e,s,a,r)})}var Ue=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const zg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Fg{constructor(e,r={},s,a){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=s,this.fetch=Qh(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,s,a){return Ue(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},sd),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(e=="PUT"?$o:_t)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(be(i))return{data:null,error:i};throw i}})}upload(e,r,s){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,a){return Ue(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:sd.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield $o(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(be(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return Ue(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield _t(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Ul("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s))return{data:null,error:s};throw s}})}update(e,r,s){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return Ue(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(be(a))return{data:null,error:a};throw a}})}copy(e,r,s){return Ue(this,void 0,void 0,function*(){try{return{data:{path:(yield _t(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(be(a))return{data:null,error:a};throw a}})}createSignedUrl(e,r,s){return Ue(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield _t(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(be(a))return{data:null,error:a};throw a}})}createSignedUrls(e,r,s){return Ue(this,void 0,void 0,function*(){try{const a=yield _t(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(be(a))return{data:null,error:a};throw a}})}download(e,r){return Ue(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield ka(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(be(l))return{data:null,error:l};throw l}})}info(e){return Ue(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield ka(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Oo(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s))return{data:null,error:s};throw s}})}exists(e){return Ue(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Ug(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s)&&s instanceof Io){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return Ue(this,void 0,void 0,function*(){try{return{data:yield Jh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(be(r))return{data:null,error:r};throw r}})}list(e,r,s){return Ue(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},zg),r),{prefix:e||""});return{data:yield _t(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(be(a))return{data:null,error:a};throw a}})}listV2(e,r){return Ue(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield _t(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Bg="2.12.1",qg={"X-Client-Info":`storage-js/${Bg}`};var Or=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class Hg{constructor(e,r={},s,a){this.shouldThrowOnError=!1;const i=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},qg),r),this.fetch=Qh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Or(this,void 0,void 0,function*(){try{return{data:yield ka(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(be(e))return{data:null,error:e};throw e}})}getBucket(e){return Or(this,void 0,void 0,function*(){try{return{data:yield ka(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(be(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Or(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Or(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(be(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Or(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(be(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Or(this,void 0,void 0,function*(){try{return{data:yield Jh(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(be(r))return{data:null,error:r};throw r}})}}class Vg extends Hg{constructor(e,r={},s,a){super(e,r,s,a)}from(e){return new Fg(this.url,this.headers,e,this.fetch)}}const Wg="2.57.4";let Ps="";typeof Deno<"u"?Ps="deno":typeof document<"u"?Ps="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ps="react-native":Ps="node";const Gg={"X-Client-Info":`supabase-js-${Ps}/${Wg}`},Kg={headers:Gg},Qg={schema:"public"},Jg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yg={};var Xg=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Zg=t=>{let e;return t?e=t:typeof fetch>"u"?e=$h:e=fetch,(...r)=>e(...r)},e0=()=>typeof Headers>"u"?Ah:Headers,t0=(t,e,r)=>{const s=Zg(r),a=e0();return(i,o)=>Xg(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:d}))})};var r0=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};function s0(t){return t.endsWith("/")?t:t+"/"}function n0(t,e){var r,s;const{db:a,auth:i,realtime:o,global:l}=t,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>r0(this,void 0,void 0,function*(){return""})};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}function a0(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(s0(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Yh="2.71.1",Ur=30*1e3,Ao=3,Di=Ao*Ur,i0="http://localhost:9999",o0="supabase.auth.token",l0={"X-Client-Info":`gotrue-js/${Yh}`},Lo="X-Supabase-Api-Version",Xh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},c0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,d0=10*60*1e3;class zl extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function K(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class u0 extends zl{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function h0(t){return K(t)&&t.name==="AuthApiError"}class Zh extends zl{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class dr extends zl{constructor(e,r,s,a){super(e,s,a),this.name=r,this.status=s}}class Bt extends dr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function m0(t){return K(t)&&t.name==="AuthSessionMissingError"}class Un extends dr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class zn extends dr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Fn extends dr{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function f0(t){return K(t)&&t.name==="AuthImplicitGrantRedirectError"}class nd extends dr{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mo extends dr{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ri(t){return K(t)&&t.name==="AuthRetryableFetchError"}class ad extends dr{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Uo extends dr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),id=` 	
\r=`.split(""),p0=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<id.length;e+=1)t[id[e].charCodeAt(0)]=-2;for(let e=0;e<Sa.length;e+=1)t[Sa[e].charCodeAt(0)]=e;return t})();function od(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Sa[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Sa[s]),e.queuedBits-=6}}function em(t,e,r){const s=p0[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ld(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{y0(o,s,r)};for(let o=0;o<t.length;o+=1)em(t.charCodeAt(o),a,i);return e.join("")}function g0(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function x0(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}g0(s,e)}}function y0(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function v0(t){const e=[],r={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)em(t.charCodeAt(a),r,s);return new Uint8Array(e)}function w0(t){const e=[];return x0(t,r=>e.push(r)),new Uint8Array(e)}function b0(t){const e=[],r={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>od(a,r,s)),od(null,r,s),e.join("")}function _0(t){return Math.round(Date.now()/1e3)+t}function j0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ut=()=>typeof window<"u"&&typeof document<"u",ur={tested:!1,writable:!1},tm=()=>{if(!ut())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ur.tested)return ur.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ur.tested=!0,ur.writable=!0}catch{ur.tested=!0,ur.writable=!1}return ur.writable};function N0(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return r.searchParams.forEach((s,a)=>{e[a]=s}),e}const rm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>yn(async()=>{const{default:s}=await Promise.resolve().then(()=>gs);return{default:s}},void 0).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},k0=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",zr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},hr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ft=async(t,e)=>{await t.removeItem(e)};class Ya{constructor(){this.promise=new Ya.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Ya.promiseConstructor=Promise;function Pi(t){const e=t.split(".");if(e.length!==3)throw new Uo("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!c0.test(e[s]))throw new Uo("JWT not in base64url format");return{header:JSON.parse(ld(e[0])),payload:JSON.parse(ld(e[1])),signature:v0(e[2]),raw:{header:e[0],payload:e[1]}}}async function S0(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function C0(t,e){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function E0(t){return("0"+t.toString(16)).substr(-2)}function T0(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,E0).join("")}async function D0(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function R0(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await D0(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $r(t,e,r=!1){const s=T0();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await zr(t,`${e}-code-verifier`,a);const i=await R0(s);return[i,s===i?"plain":"s256"]}const P0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function I0(t){const e=t.headers.get(Lo);if(!e||!e.match(P0))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function O0(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function $0(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const A0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ar(t){if(!A0.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ii(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cd(t){return JSON.parse(JSON.stringify(t))}var L0=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(r[s[a]]=t[s[a]]);return r};const pr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),M0=[502,503,504];async function dd(t){var e;if(!k0(t))throw new Mo(pr(t),0);if(M0.includes(t.status))throw new Mo(pr(t),t.status);let r;try{r=await t.json()}catch(i){throw new Zh(pr(i),i)}let s;const a=I0(t);if(a&&a.getTime()>=Xh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new ad(pr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Bt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ad(pr(r),t.status,r.weak_password.reasons);throw new u0(pr(r),t.status||500,s)}const U0=(t,e,r,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Y(t,e,r,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[Lo]||(i[Lo]=Xh["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await z0(t,e,r+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function z0(t,e,r,s,a,i){const o=U0(e,s,a,i);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Mo(pr(c),0)}if(l.ok||await dd(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await dd(c)}}function St(t){var e;let r=null;H0(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=_0(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function ud(t){const e=St(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Gt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function F0(t){return{data:t,error:null}}function B0(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i}=t,o=L0(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function q0(t){return t}function H0(t){return t.access_token&&t.refresh_token&&t.expires_in}const Oi=["global","local","others"];var V0=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(r[s[a]]=t[s[a]]);return r};class W0{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=rm(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Oi[0]){if(Oi.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Oi.join(", ")}`);try{return await Y(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await Y(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gt})}catch(s){if(K(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=V0(e,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Y(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:B0,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(K(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Y(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Gt})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Y(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:q0});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return x.length>0&&(x.forEach(v=>{const _=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(v.split(";")[1].split("=")[1]);d[`${C}Page`]=_}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(K(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ar(e);try{return await Y(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Gt})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ar(e);try{return await Y(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Gt})}catch(s){if(K(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Ar(e);try{return await Y(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gt})}catch(s){if(K(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ar(e.userId);try{const{data:r,error:s}=await Y(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(K(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ar(e.userId),Ar(e.id);try{return{data:await Y(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}}}function hd(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function G0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lr={debug:!!(globalThis&&tm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class K0 extends sm{}async function Q0(t,e,r){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await r()}finally{Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new K0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}G0();const J0={url:i0,storageKey:o0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:l0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function md(t,e,r){return await r()}const Mr={};class dn{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dn.nextInstanceID,dn.nextInstanceID+=1,this.instanceID>0&&ut()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},J0),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new W0({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=rm(a.fetch),this.lock=a.lock||md,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ut()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Q0:this.lock=md,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:tm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hd(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=hd(this.memoryStorage)),ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yh}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=N0(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),ut()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),f0(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return K(r)?{error:r}:{error:new Zh("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,a;try{const i=await Y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:St}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(K(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,a;try{let i;if("email"in e){const{email:u,password:h,options:m}=e;let x=null,v=null;this.flowType==="pkce"&&([x,v]=await $r(this.storage,this.storageKey)),i=await Y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:x,code_challenge_method:v},xform:St})}else if("phone"in e){const{phone:u,password:h,options:m}=e;i=await Y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:St})}else throw new zn("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(K(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:l}=e;r=await Y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ud})}else if("phone"in e){const{phone:i,password:o,options:l}=e;r=await Y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ud})}else throw new zn("You must provide either an email or phone number and a password");const{data:s,error:a}=r;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Un}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(K(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,a,i,o,l,c,d,u,h,m,x;let v,_;if("message"in e)v=e.message,_=e.signature;else{const{chain:C,wallet:g,statement:f,options:p}=e;let w;if(ut())if(typeof g=="object")w=g;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))w=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const S=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const k=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),f?{statement:f}:null));let j;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")j=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)j=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)v=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),_=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${S.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(s=p==null?void 0:p.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((d=p==null?void 0:p.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((h=(u=p==null?void 0:p.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...p.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const k=await w.signMessage(new TextEncoder().encode(v),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=k}}try{const{data:C,error:g}=await Y(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:b0(_)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:St});if(g)throw g;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new Un}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:g})}catch(C){if(K(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(e){const r=await hr(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{const{data:i,error:o}=await Y(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:St});if(await Ft(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Un}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(K(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:a,access_token:i,nonce:o}=e,l=await Y(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:St}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Un}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(K(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await $r(this.storage,this.storageKey));const{error:h}=await Y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await Y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new zn("You must provide either an email or phone number.")}catch(l){if(K(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,s;try{let a,i;"options"in e&&(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await Y(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:St});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(K(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var r,s,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await $r(this.storage,this.storageKey)),await Y(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:F0})}catch(i){if(K(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Bt;const{error:a}=await Y(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(K(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:i}=e,{error:o}=await Y(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:a,options:i}=e,{data:o,error:l}=await Y(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new zn("You must provide either an email or phone number and a type")}catch(r){if(K(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await hr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Di:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await hr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Ii()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Gt}):await this._useSession(async r=>{var s,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bt}:await Y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Gt})})}catch(r){if(K(r))return m0(r)&&(await this._removeSession(),await Ft(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new Bt;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await $r(this.storage,this.storageKey));const{data:d,error:u}=await Y(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Gt});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(K(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Bt;const r=Date.now()/1e3;let s=r,a=!0,i=null;const{payload:o}=Pi(e.access_token);if(o.exp&&(s=o.exp,a=s<=r),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(K(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Bt;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(K(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!ut())throw new Fn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Fn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new nd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Fn("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nd("No code detected.");const{data:f,error:p}=await this._exchangeCodeForSession(e.code);if(p)throw p;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new Fn("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const x=m-u;x*1e3<=Ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${h}s`);const v=m-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,u);const{data:_,error:C}=await this._getUser(i);if(C)throw C;const g={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(K(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await hr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return{error:i};const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(h0(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ft(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=j0(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await $r(this.storage,this.storageKey,!0));try{return await Y(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(K(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:m}=i;if(m)throw m;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Y(this.fetch,"GET",x,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return ut()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(K(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)throw o;return await Y(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(K(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await C0(async a=>(a>0&&await S0(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Y(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:St})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Ri(i)&&Date.now()+o-s<Ur})}catch(s){if(this._debug(r,"error",s),K(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),ut()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await hr(this.storage,this.storageKey);if(a&&this.userStorage){let o=await hr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await zr(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Ii()}else if(a&&!a.user&&!a.user){const o=await hr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Ft(this.storage,this.storageKey+"-user"),await zr(this.storage,this.storageKey,a)):a.user=Ii()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Di;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Di}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),Ri(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Bt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ya;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Bt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),K(i)){const o={session:null,error:i};return Ri(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,r,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await zr(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=cd(a);await zr(this.storage,this.storageKey,i)}else{const a=cd(r);await zr(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ft(this.storage,this.storageKey),await Ft(this.storage,this.storageKey+"-code-verifier"),await Ft(this.storage,this.storageKey+"-user"),this.userStorage&&await Ft(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ut()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/Ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ur}ms, refresh threshold is ${Ao} ticks`),a<=Ao&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof sm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ut()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await $r(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;return i?{data:null,error:i}:await Y(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(K(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Y(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(K(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=await Y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(K(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;return i?{data:null,error:i}:await Y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(K(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=(e==null?void 0:e.factors)||[],a=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Pi(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+d0>a)return s;const{data:i,error:o}=await Y(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:x,error:v}=await this.getSession();if(v||!x.session)return{data:null,error:v};s=x.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=Pi(s);r!=null&&r.allowExpired||O0(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:x}=await this.getUser(s);if(x)throw x;return{data:{claims:i,header:a,signature:o},error:null}}const u=$0(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,w0(`${l}.${c}`)))throw new Uo("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}}dn.nextInstanceID=0;const Y0=dn;class X0 extends Y0{constructor(e){super(e)}}var Z0=function(t,e,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class ex{constructor(e,r,s){var a,i,o;this.supabaseUrl=e,this.supabaseKey=r;const l=a0(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Qg,realtime:Yg,auth:Object.assign(Object.assign({},Jg),{storageKey:c}),global:Kg},u=n0(s??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=t0(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new pg(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Vg(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Gp(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return Z0(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d},u,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new X0({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:i,flowType:l,lock:c,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Pg(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const tx=(t,e,r)=>new ex(t,e,r);function rx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}rx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sx="https://fomhfjndcqhwbucubmkr.supabase.co",nx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZvbWhmam5kY3Fod2J1Y3VibWtyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc0MDUzMTYsImV4cCI6MjA4Mjk4MTMxNn0.FJmp4QWKqbQu6hlH916z2I6hTi2SGLbFzXyALoUniHs",T=tx(sx,nx),nm=N.createContext(void 0);function ax({children:t}){const[e,r]=N.useState(null),[s,a]=N.useState(null),[i,o]=N.useState(!0);N.useEffect(()=>{T.auth.getSession().then(({data:{session:h}})=>{r((h==null?void 0:h.user)??null),h!=null&&h.user?l(h.user.id):o(!1)});const{data:{subscription:u}}=T.auth.onAuthStateChange((h,m)=>{(async()=>(r((m==null?void 0:m.user)??null),m!=null&&m.user?await l(m.user.id):(a(null),o(!1))))()});return()=>u.unsubscribe()},[]);const l=async u=>{try{const{data:h,error:m}=await T.from("user_profiles").select("*").eq("id",u).maybeSingle();if(m){m.code==="42P17"?console.error("RLS policy error - infinite recursion detected. Please check user_profiles policies."):m.code==="42501"?console.error("Permission denied - user may not have access to their profile."):console.error("Error loading profile:",m.code,m.message),a(null);return}h||console.warn("No profile found for user. User may need to complete profile setup."),a(h)}catch(h){console.error("Unexpected error loading profile:",h),a(null)}finally{o(!1)}},c=async(u,h)=>{try{const{data:m,error:x}=await T.auth.signInWithPassword({email:u,password:h});if(x){let v=x.message;return x.message.includes("Invalid login credentials")?v="Invalid email or password. Please try again.":x.message.includes("Email not confirmed")?v="Please verify your email before signing in.":x.message.includes("Too many requests")?v="Too many login attempts. Please wait a moment and try again.":x.message.includes("User not found")&&(v="No account found with this email address."),{error:new Error(v)}}if(m.user)try{const{data:v}=await T.from("user_profiles").select("full_name").eq("id",m.user.id).maybeSingle();await T.from("login_logs").insert([{user_id:m.user.id,user_email:m.user.email||u,user_name:(v==null?void 0:v.full_name)||"Unknown",login_time:new Date().toISOString(),user_agent:navigator.userAgent}])}catch(v){console.warn("Failed to record login:",v)}return{error:null}}catch(m){return console.error("Sign in error:",m),{error:new Error("An unexpected error occurred. Please try again.")}}},d=async()=>{await T.auth.signOut(),r(null),a(null)};return n.jsx(nm.Provider,{value:{user:e,profile:s,loading:i,signIn:c,signOut:d},children:t})}function Mt(){const t=N.useContext(nm);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ix={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),G=(t,e)=>{const r=N.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>N.createElement("svg",{ref:u,...ix,width:a,height:a,stroke:s,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${ox(t)}`,l].join(" "),...d},[...e.map(([h,m])=>N.createElement(h,m)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=G("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=G("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=G("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=G("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=G("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=G("CalendarPlus",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 16v6",key:"tddt3s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=G("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=G("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=G("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=G("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=G("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=G("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=G("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=G("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=G("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=G("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=G("DoorClosed",[["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}],["path",{d:"M14 12v.01",key:"xfcn54"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=G("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=G("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=G("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=G("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=G("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=G("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=G("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=G("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=G("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=G("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=G("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=G("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=G("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _x=G("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=G("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=G("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=G("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=G("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=G("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=G("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=G("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=G("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=G("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=G("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=G("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=G("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=G("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=G("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=G("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=G("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=G("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Cx(){const[t,e]=N.useState(""),[r,s]=N.useState(""),[a,i]=N.useState(""),[o,l]=N.useState(!1),{signIn:c}=Mt(),d=async u=>{u.preventDefault(),i(""),l(!0);const{error:h}=await c(t,r);h&&(i(h.message||"Invalid credentials"),l(!1))};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-md p-8",children:[n.jsx("div",{className:"flex items-center justify-center mb-8",children:n.jsx("div",{className:"bg-blue-600 p-3 rounded-lg",children:n.jsx(Ea,{className:"w-8 h-8 text-white"})})}),n.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Hotel Front Office PMS"}),n.jsx("p",{className:"text-center text-gray-600 mb-8",children:"Sign in to continue"}),n.jsxs("form",{onSubmit:d,className:"space-y-6",children:[a&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:a}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),n.jsx("input",{id:"email",type:"email",value:t,onChange:u=>e(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"your@email.com",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),n.jsx("input",{id:"password",type:"password",value:r,onChange:u=>s(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"",required:!0})]}),n.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Signing in...":"Sign In"})]}),n.jsx("div",{className:"mt-6 text-center text-sm text-gray-600",children:n.jsx("p",{children:"Contact your manager for account credentials"})})]})})}function Ex({children:t,requireRole:e}){const{user:r,profile:s,loading:a}=Mt();return a?n.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):!r||!s?n.jsx(Cx,{}):e&&s.role!==e?n.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Access Denied"}),n.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):n.jsx(n.Fragment,{children:t})}function ke({children:t}){const{profile:e,signOut:r}=Mt(),[s,a]=N.useState(!1),[i,o]=N.useState(window.location.hash);N.useEffect(()=>{const d=()=>{o(window.location.hash)};return window.addEventListener("hashchange",d),()=>window.removeEventListener("hashchange",d)},[]);const l=[{name:"Dashboard",icon:bx,href:"#dashboard"},{name:"Tape Chart",icon:im,href:"#tapechart"},{name:"Reservations",icon:cm,href:"#reservations"},{name:"Check-In",icon:Is,href:"#checkin"},{name:"Guests",icon:Da,href:"#guests"},{name:"In-House",icon:ea,href:"#inhouse"},...(e==null?void 0:e.role)==="manager"?[{name:"Night Audit",icon:dm,href:"#nightaudit"},{name:"Rate Calendar",icon:lm,href:"#ratecalendar"},{name:"Reports",icon:Xa,href:"#reports"},{name:"Settings",icon:kx,href:"#settings"}]:[]],c=d=>{const u=d.slice(1);return i===d||i===""&&u==="dashboard"};return n.jsx("div",{className:"min-h-screen bg-gray-50",children:n.jsxs("div",{className:"flex h-screen overflow-hidden",children:[n.jsx("aside",{className:`
          fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out
          lg:relative lg:translate-x-0
          ${s?"translate-x-0":"-translate-x-full"}
        `,children:n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Hotel PMS"}),n.jsx("button",{onClick:()=>a(!1),className:"lg:hidden text-gray-600 hover:text-gray-800",children:n.jsx(je,{className:"w-6 h-6"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:n.jsx("nav",{className:"space-y-1 px-3",children:l.map(d=>{const u=d.icon,h=c(d.href);return n.jsxs("a",{href:d.href,className:`flex items-center px-4 py-3 rounded-lg transition ${h?"bg-blue-50 text-blue-600 font-medium":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}`,children:[n.jsx(u,{className:"w-5 h-5 mr-3"}),d.name]},d.name)})})}),n.jsxs("div",{className:"border-t p-4",children:[n.jsx("div",{className:"flex items-center justify-between mb-3",children:n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:e==null?void 0:e.full_name}),n.jsx("p",{className:"text-xs text-gray-500 capitalize",children:e==null?void 0:e.role})]})}),n.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition",children:[n.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]})}),s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>a(!1)}),n.jsxs("main",{className:"flex-1 overflow-y-auto",children:[n.jsx("div",{className:"lg:hidden bg-white shadow-sm border-b",children:n.jsxs("div",{className:"flex items-center justify-between p-4",children:[n.jsx("button",{onClick:()=>a(!0),className:"text-gray-600 hover:text-gray-800",children:n.jsx(_x,{className:"w-6 h-6"})}),n.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Hotel PMS"}),n.jsx("div",{className:"w-6"})]})}),n.jsx("div",{className:"p-6",children:t})]})]})})}function mm({tables:t,onUpdate:e,enabled:r=!0}){const s=N.useRef(null),a=N.useRef(e);N.useEffect(()=>{a.current=e},[e]);const i=N.useCallback(()=>{if(!r||t.length===0)return;const o=`realtime-sync-${t.join("-")}-${Date.now()}`,l=T.channel(o);return t.forEach(c=>{l.on("postgres_changes",{event:"*",schema:"public",table:c},d=>{console.log(`[Realtime] ${c} changed:`,d.eventType),a.current()})}),l.subscribe(c=>{c==="SUBSCRIBED"&&console.log(`[Realtime] Subscribed to: ${t.join(", ")}`)}),s.current=l,()=>{s.current&&(T.removeChannel(s.current),s.current=null)}},[r,t]);N.useEffect(()=>i(),[i])}function Za(t,e=!0){mm({tables:["rooms","bookings","reservations"],onUpdate:t,enabled:e})}function Tx(t,e=!0){mm({tables:["payments","folio_charges"],onUpdate:t,enabled:e})}const yd=[{value:"vacant_clean",label:"Vacant Clean",color:"bg-green-500",description:"Ready for check-in"},{value:"vacant_dirty",label:"Vacant Dirty",color:"bg-yellow-500",description:"Needs housekeeping"},{value:"occupied",label:"Occupied",color:"bg-red-500",description:"Guest in room"},{value:"out_of_order",label:"Out of Order",color:"bg-gray-500",description:"Under maintenance"}];function Dx(){const[t,e]=N.useState([]),[r,s]=N.useState({totalRooms:0,occupied:0,available:0,dirty:0,outOfOrder:0,checkoutsToday:0,checkinsToday:0,todayRevenue:0}),[a,i]=N.useState(!0),[o,l]=N.useState(null),[c,d]=N.useState(!1),[u,h]=N.useState(!1),[m,x]=N.useState(!1),[v,_]=N.useState(!1),[C,g]=N.useState(!1),[f,p]=N.useState([]),[w,S]=N.useState([]),[k,j]=N.useState([]),[E,D]=N.useState(!1);N.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:y,error:I}=await T.from("rooms").select("*, room_types(*)").order("room_number");if(I)throw I;const O=y;e(O||[]);const q=new Date().toISOString().split("T")[0],{data:z}=await T.from("bookings").select("*").eq("status","checked_in").eq("expected_check_out_date",q),{data:$}=await T.from("reservations").select("*").eq("status","confirmed").eq("check_in_date",q),{data:B}=await T.from("payments").select("amount").gte("payment_date",`${q}T00:00:00`).lte("payment_date",`${q}T23:59:59`),H=(B==null?void 0:B.reduce((V,he)=>V+Number(he.amount),0))||0;s({totalRooms:(O==null?void 0:O.length)||0,occupied:(O==null?void 0:O.filter(V=>V.status==="occupied").length)||0,available:(O==null?void 0:O.filter(V=>V.status==="vacant_clean").length)||0,dirty:(O==null?void 0:O.filter(V=>V.status==="vacant_dirty").length)||0,outOfOrder:(O==null?void 0:O.filter(V=>V.status==="out_of_order").length)||0,checkoutsToday:(z==null?void 0:z.length)||0,checkinsToday:($==null?void 0:$.length)||0,todayRevenue:H})}catch(y){console.error("Error loading dashboard data:",y)}finally{i(!1)}};Za(A);const W=async()=>{D(!0);const y=new Date().toISOString().split("T")[0],{data:I}=await T.from("reservations").select("*, guests(full_name, mobile), room_types(name)").eq("status","confirmed").eq("check_in_date",y).order("check_in_date");p(I||[]),h(!0),D(!1)},ee=async()=>{D(!0);const y=new Date().toISOString().split("T")[0],{data:I}=await T.from("bookings").select("*, guests(full_name, mobile), rooms(room_number, room_types(name))").eq("status","checked_in").eq("expected_check_out_date",y).order("expected_check_out_date");S(I||[]),x(!0),D(!1)},R=async()=>{D(!0);const y=new Date().toISOString().split("T")[0],{data:I}=await T.from("payments").select("*, bookings(guests(full_name), rooms(room_number))").gte("payment_date",`${y}T00:00:00`).lte("payment_date",`${y}T23:59:59`).order("payment_date",{ascending:!1});j(I||[]),_(!0),D(!1)},U=async y=>{await Q(y,"vacant_clean"),g(!1),A()},Q=async(y,I)=>{d(!0);try{const{error:O}=await T.from("rooms").update({status:I,updated_at:new Date().toISOString()}).eq("id",y);if(O)throw O;e(t.map(z=>z.id===y?{...z,status:I}:z));const q=t.map(z=>z.id===y?{...z,status:I}:z);s(z=>({...z,occupied:q.filter($=>$.status==="occupied").length,available:q.filter($=>$.status==="vacant_clean").length,dirty:q.filter($=>$.status==="vacant_dirty").length,outOfOrder:q.filter($=>$.status==="out_of_order").length})),l(null)}catch(O){console.error("Error updating room status:",O),alert("Failed to update room status. Please try again.")}finally{d(!1)}},te=y=>{switch(y){case"vacant_clean":return"bg-green-100 border-green-300 text-green-800";case"vacant_dirty":return"bg-yellow-100 border-yellow-300 text-yellow-800";case"occupied":return"bg-red-100 border-red-300 text-red-800";case"out_of_order":return"bg-gray-100 border-gray-300 text-gray-800";default:return"bg-gray-100 border-gray-300 text-gray-800"}},b=y=>y.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase());return a?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Front Desk Dashboard"}),n.jsx("p",{className:"text-gray-600",children:"Real-time room availability and operations"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Rooms"}),n.jsx(fd,{className:"w-5 h-5 text-blue-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-gray-800",children:r.totalRooms})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Available"}),n.jsx(cm,{className:"w-5 h-5 text-green-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.available})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Occupied"}),n.jsx(gx,{className:"w-5 h-5 text-red-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-red-600",children:r.occupied})]}),n.jsxs("button",{onClick:R,className:"bg-white rounded-lg shadow p-6 text-left hover:shadow-lg hover:ring-2 hover:ring-blue-300 transition cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Today's Revenue"}),n.jsx(Ca,{className:"w-5 h-5 text-blue-600"})]}),n.jsxs("p",{className:"text-3xl font-bold text-gray-800",children:["",r.todayRevenue.toFixed(0)]}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Click to view details "})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[n.jsxs("button",{onClick:W,className:"bg-white rounded-lg shadow p-6 text-left hover:shadow-lg hover:ring-2 hover:ring-blue-300 transition cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Arrivals Today"}),n.jsx(Ea,{className:"w-5 h-5 text-blue-600"})]}),n.jsx("p",{className:"text-4xl font-bold text-blue-600",children:r.checkinsToday}),n.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Click to view guests "})]}),n.jsxs("button",{onClick:ee,className:"bg-white rounded-lg shadow p-6 text-left hover:shadow-lg hover:ring-2 hover:ring-orange-300 transition cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Departures Today"}),n.jsx(Ta,{className:"w-5 h-5 text-orange-600"})]}),n.jsx("p",{className:"text-4xl font-bold text-orange-600",children:r.checkoutsToday}),n.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"Click to view guests "})]}),n.jsxs("button",{onClick:()=>g(!0),className:"bg-white rounded-lg shadow p-6 text-left hover:shadow-lg hover:ring-2 hover:ring-yellow-300 transition cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Needs Cleaning"}),n.jsx(gd,{className:"w-5 h-5 text-yellow-600"})]}),n.jsx("p",{className:"text-4xl font-bold text-yellow-600",children:r.dirty}),n.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"Click to mark clean "})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Out of Order"}),n.jsx(am,{className:"w-5 h-5 text-gray-600"})]}),n.jsx("p",{className:"text-4xl font-bold text-gray-600",children:r.outOfOrder})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsxs("div",{className:"p-6 border-b",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Room Status Overview"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click on a room to change its status"})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:yd.map(y=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-4 h-4 rounded ${y.color}`}),n.jsx("span",{className:"text-sm text-gray-600",children:y.label})]},y.value))}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4",children:t.map(y=>n.jsx("button",{onClick:()=>l(y),className:`p-4 rounded-lg border-2 transition hover:shadow-lg hover:scale-105 ${te(y.status)}`,children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-2xl font-bold mb-1",children:y.room_number}),n.jsx("p",{className:"text-xs font-medium",children:y.room_types.name}),n.jsx("p",{className:"text-xs mt-2",children:b(y.status)})]})},y.id))}),t.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx(fd,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No rooms configured yet"}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Contact your manager to set up room inventory"})]})]})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Room ",o.room_number]}),n.jsxs("p",{className:"text-gray-600",children:[o.room_types.name,"  Floor ",o.floor]})]}),n.jsx("button",{onClick:()=>l(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Current Status"}),n.jsx("div",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${te(o.status)}`,children:b(o.status)})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Change Status To:"}),n.jsx("div",{className:"space-y-2",children:yd.map(y=>n.jsxs("button",{onClick:()=>Q(o.id,y.value),disabled:c||o.status===y.value,className:`w-full flex items-center justify-between p-3 rounded-lg border transition ${o.status===y.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"} ${c?"opacity-50 cursor-not-allowed":""}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-4 h-4 rounded ${y.color}`}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"font-medium text-gray-800",children:y.label}),n.jsx("p",{className:"text-xs text-gray-500",children:y.description})]})]}),o.status===y.value&&n.jsx(un,{className:"w-5 h-5 text-blue-600"})]},y.value))})]}),c&&n.jsx("div",{className:"mt-4 text-center text-sm text-gray-600",children:"Updating room status..."})]})}),u&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 max-h-[80vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Today's Arrivals"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Expected check-ins for ",new Date().toLocaleDateString("en-IN")]})]}),n.jsx("button",{onClick:()=>h(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),E?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}):f.length>0?n.jsx("div",{className:"space-y-3",children:f.map(y=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:y.guests.full_name}),n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",y.guests.mobile]}),n.jsxs("p",{className:"text-sm text-gray-500",children:[y.room_types.name,"  ",y.number_of_guests," guest(s)"]})]}),n.jsx("div",{className:"text-right",children:n.jsx("span",{className:"px-3 py-1 bg-blue-600 text-white rounded-full text-xs",children:"Pending Check-In"})})]},y.id))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Ea,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No arrivals expected today"})]})]})}),m&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 max-h-[80vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Today's Departures"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Expected check-outs for ",new Date().toLocaleDateString("en-IN")]})]}),n.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),E?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"w-6 h-6 border-2 border-orange-600 border-t-transparent rounded-full animate-spin"})}):w.length>0?n.jsx("div",{className:"space-y-3",children:w.map(y=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 rounded-lg border border-orange-200",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:y.guests.full_name}),n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",y.guests.mobile]}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Room ",y.rooms.room_number,"  ",y.rooms.room_types.name]})]}),n.jsx("div",{className:"text-right",children:n.jsx("span",{className:"px-3 py-1 bg-orange-600 text-white rounded-full text-xs",children:"Pending Check-Out"})})]},y.id))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Ta,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No departures expected today"})]})]})}),v&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 max-h-[80vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Today's Revenue"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Payments received on ",new Date().toLocaleDateString("en-IN")]})]}),n.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),E?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"w-6 h-6 border-2 border-green-600 border-t-transparent rounded-full animate-spin"})}):k.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[n.jsx("p",{className:"text-sm text-green-700",children:"Total Revenue"}),n.jsxs("p",{className:"text-3xl font-bold text-green-700",children:["",r.todayRevenue.toLocaleString("en-IN")]})]}),n.jsx("div",{className:"space-y-2",children:k.map(y=>{var I,O,q,z;return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:((O=(I=y.bookings)==null?void 0:I.guests)==null?void 0:O.full_name)||"Guest"}),n.jsxs("p",{className:"text-sm text-gray-500",children:[(z=(q=y.bookings)==null?void 0:q.rooms)!=null&&z.room_number?`Room ${y.bookings.rooms.room_number}`:""," ",y.payment_mode.toUpperCase()," ",new Date(y.payment_date).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})]})]}),n.jsxs("p",{className:"font-bold text-green-600",children:["",y.amount.toLocaleString("en-IN")]})]},y.id)})})]}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Ca,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No payments received today"})]})]})}),C&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6 max-h-[80vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Rooms Needing Cleaning"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Click to mark as clean"})]}),n.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),t.filter(y=>y.status==="vacant_dirty").length>0?n.jsx("div",{className:"space-y-2",children:t.filter(y=>y.status==="vacant_dirty").map(y=>n.jsxs("button",{onClick:()=>U(y.id),className:"w-full flex items-center justify-between p-4 bg-yellow-50 rounded-lg border border-yellow-200 hover:bg-yellow-100 transition",children:[n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"font-bold text-lg text-gray-800",children:y.room_number}),n.jsxs("p",{className:"text-sm text-gray-600",children:[y.room_types.name,"  Floor ",y.floor]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[n.jsx(gd,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm font-medium",children:"Mark Clean"})]})]},y.id))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(un,{className:"w-12 h-12 mx-auto mb-3 text-green-500"}),n.jsx("p",{className:"font-medium text-green-600",children:"All rooms are clean!"})]})]})})]})}function Rx(){const{user:t}=Mt(),[e,r]=N.useState([]),[s,a]=N.useState([]),[i,o]=N.useState(!1),[l,c]=N.useState(!0);N.useEffect(()=>{d(),u()},[]);const d=async()=>{try{const{data:x,error:v}=await T.from("reservations").select("*, guests(*), room_types(*)").neq("status","checked_in").order("check_in_date",{ascending:!0});if(v)throw v;r(x||[])}catch(x){console.error("Error loading reservations:",x)}finally{c(!1)}},u=async()=>{const{data:x}=await T.from("room_types").select("*").order("name");a(x||[])},h=async x=>{x.preventDefault();const v=new FormData(x.currentTarget);try{const _={full_name:v.get("guest_name"),mobile:v.get("mobile"),email:v.get("email"),address:v.get("address")},{data:C}=await T.from("guests").select("*").eq("mobile",_.mobile).maybeSingle();let g=C==null?void 0:C.id;if(!g){const{data:w,error:S}=await T.from("guests").insert([_]).select().single();if(S)throw S;g=w.id}const f={guest_id:g,room_type_id:v.get("room_type_id"),check_in_date:v.get("check_in_date"),check_out_date:v.get("check_out_date"),number_of_guests:parseInt(v.get("number_of_guests")),notes:v.get("notes"),created_by:t==null?void 0:t.id,status:"confirmed"},{error:p}=await T.from("reservations").insert([f]);if(p)throw p;o(!1),d()}catch(_){alert("Error creating reservation: "+(_.message||"Unknown error"))}},m=async x=>{confirm("Are you sure you want to cancel this reservation?")&&(await T.from("reservations").update({status:"cancelled"}).eq("id",x),d())};return l?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading reservations..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Reservations"}),n.jsx("p",{className:"text-gray-600",children:"Manage future bookings and walk-ins"})]}),n.jsxs("button",{onClick:()=>o(!0),className:"flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:[n.jsx(Er,{className:"w-5 h-5 mr-2"}),"New Reservation"]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guest"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room Type"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check-In"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check-Out"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guests"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(x=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(nr,{className:"w-5 h-5 text-gray-400 mr-2"}),n.jsx("span",{className:"text-sm font-medium text-gray-800",children:x.guests.full_name})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(hn,{className:"w-4 h-4 mr-1"}),x.guests.mobile]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x.room_types.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(yt,{className:"w-4 h-4 mr-1"}),new Date(x.check_in_date).toLocaleDateString()]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(yt,{className:"w-4 h-4 mr-1"}),new Date(x.check_out_date).toLocaleDateString()]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x.number_of_guests}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x.status==="confirmed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:x.status==="confirmed"&&n.jsx("button",{onClick:()=>m(x.id),className:"text-red-600 hover:text-red-800",children:"Cancel"})})]},x.id))})]})}),e.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx(yt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No reservations found"}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Create your first reservation to get started"})]})]})]}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:"New Reservation"}),n.jsxs("form",{onSubmit:h,children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx("div",{className:"md:col-span-2",children:n.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Guest Information"})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),n.jsx("input",{type:"text",name:"guest_name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number *"}),n.jsx("input",{type:"tel",name:"mobile",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",name:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("input",{type:"text",name:"address",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("div",{className:"md:col-span-2 mt-4",children:n.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Booking Details"})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room Type *"}),n.jsxs("select",{name:"room_type_id",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"Select Room Type"}),s.map(x=>n.jsxs("option",{value:x.id,children:[x.name," - ",x.base_rate,"/night"]},x.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Guests *"}),n.jsx("input",{type:"number",name:"number_of_guests",min:"1",defaultValue:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-In Date *"}),n.jsx("input",{type:"date",name:"check_in_date",min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-Out Date *"}),n.jsx("input",{type:"date",name:"check_out_date",min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{name:"notes",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Reservation"})]})]})]})})]})}const ie={name:"Hotel Sharda Palace",tagline:"Experience Divine Hospitality",contact:{phone:"+91 98765 43210",email:"info@shardapalace.com",website:"www.shardapalace.com"},address:{line1:"Vrindavan, Mathura",line2:"Uttar Pradesh, India",pincode:"281121",full:"Vrindavan, Mathura, Uttar Pradesh, India - 281121"},gstin:"XXGSTIN1234567XX",invoice:{prefix:"INV",termsAndConditions:["Payment is due upon checkout.","All disputes are subject to Mathura jurisdiction.","This is a computer generated invoice."]},grc:{prefix:"GRC",formTitle:"Guest Registration Certificate"}};function Px(t,e){const{guest:r,room:s,stay:a,charges:i,payments:o,taxes:l,totals:c,hotel:d,document_date:u}=e,h=i.map(x=>`
      <tr>
        <td style="padding: 8px; border-bottom: 1px solid #e5e7eb; font-size: 14px;">${new Date(x.charge_date).toLocaleDateString("en-IN")}</td>
        <td style="padding: 8px; border-bottom: 1px solid #e5e7eb; font-size: 14px;">${x.description}</td>
        <td style="padding: 8px; border-bottom: 1px solid #e5e7eb; font-size: 14px; text-align: right;">${x.amount.toFixed(2)}</td>
      </tr>
    `).join(""),m=o.map(x=>`
      <div style="display: flex; justify-content: space-between; padding: 4px 0;">
        <span>${new Date(x.payment_date).toLocaleDateString("en-IN")} - ${x.payment_mode.toUpperCase()}</span>
        <span>${x.amount.toFixed(2)}</span>
      </div>
    `).join("");return`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${t}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
    .container { max-width: 800px; margin: 0 auto; }
    .header { border-bottom: 2px solid #1f2937; padding-bottom: 16px; margin-bottom: 24px; }
    .hotel-name { font-size: 28px; font-weight: bold; color: #111; }
    .invoice-title { font-size: 22px; font-weight: bold; color: #1d4ed8; }
    .section { background: #f9fafb; padding: 16px; border-radius: 8px; margin-bottom: 16px; }
    .section-title { font-weight: 600; font-size: 14px; color: #374151; margin-bottom: 8px; }
    table { width: 100%; border-collapse: collapse; }
    th { background: #1f2937; color: white; padding: 10px 8px; text-align: left; font-size: 13px; }
    .totals { width: 300px; margin-left: auto; }
    .total-row { display: flex; justify-content: space-between; padding: 6px 0; }
    .grand-total { font-size: 18px; font-weight: bold; border-top: 2px solid #1f2937; padding-top: 8px; margin-top: 8px; }
    .footer { margin-top: 32px; padding-top: 16px; border-top: 1px solid #e5e7eb; text-align: center; color: #6b7280; font-size: 14px; }
    .archived-stamp { position: absolute; top: 20px; right: 20px; background: #059669; color: white; padding: 4px 12px; font-size: 12px; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="archived-stamp">ARCHIVED COPY</div>
    
    <div class="header">
      <div style="display: flex; justify-content: space-between;">
        <div>
          <div class="hotel-name">${d.name}</div>
          <div style="color: #6b7280; margin-top: 4px;">${d.address}</div>
          <div style="color: #6b7280; font-size: 14px; margin-top: 8px;"> ${d.phone} |  ${d.email}</div>
          <div style="color: #6b7280; font-size: 14px;">GSTIN: ${d.gstin}</div>
        </div>
        <div style="text-align: right;">
          <div class="invoice-title">TAX INVOICE</div>
          <div style="margin-top: 8px;"><strong>Invoice No:</strong> ${t}</div>
          <div><strong>Date:</strong> ${u}</div>
        </div>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
      <div class="section">
        <div class="section-title">Bill To:</div>
        <div style="font-weight: 500;">${r.full_name}</div>
        <div> ${r.mobile}</div>
        ${r.address?`<div style="font-size: 14px; margin-top: 4px;">${r.address}</div>`:""}
        ${r.id_proof_type?`<div style="font-size: 14px; margin-top: 4px;"><strong>ID:</strong> ${r.id_proof_type.toUpperCase()} - ${r.id_proof_number}</div>`:""}
      </div>
      <div class="section">
        <div class="section-title">Stay Details:</div>
        <div><strong>Room:</strong> ${s.room_number} (${s.room_type})</div>
        <div><strong>Check-In:</strong> ${new Date(a.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}</div>
        <div><strong>Check-Out:</strong> ${new Date(a.check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}</div>
        <div><strong>Guests:</strong> ${a.number_of_guests}</div>
      </div>
    </div>

    <table style="margin-bottom: 24px;">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th style="text-align: right;">Amount ()</th>
        </tr>
      </thead>
      <tbody>
        ${h}
      </tbody>
    </table>

    <div class="totals">
      <div class="total-row"><span>Subtotal</span><span>${c.subtotal.toFixed(2)}</span></div>
      <div class="total-row"><span>CGST (${l.cgst}%)</span><span>${c.cgst_amount.toFixed(2)}</span></div>
      <div class="total-row"><span>SGST (${l.sgst}%)</span><span>${c.sgst_amount.toFixed(2)}</span></div>
      <div class="total-row grand-total"><span>Grand Total</span><span>${c.grand_total.toFixed(2)}</span></div>
      <div class="total-row" style="color: #059669;"><span>Amount Paid</span><span>${c.total_paid.toFixed(2)}</span></div>
      ${c.balance>0?`<div class="total-row" style="color: #dc2626; font-weight: 600;"><span>Balance Due</span><span>${c.balance.toFixed(2)}</span></div>`:'<div class="total-row" style="color: #059669; font-weight: 600;"><span>Status</span><span>PAID </span></div>'}
    </div>

    ${o.length>0?`
    <div style="margin-top: 24px;">
      <div class="section-title">Payment History:</div>
      <div style="font-size: 14px; color: #6b7280;">
        ${m}
      </div>
    </div>
    `:""}

    <div class="footer">
      <p>Thank you for staying with us!</p>
      <p style="font-weight: 600;">${d.name}</p>
    </div>
  </div>
</body>
</html>
  `.trim()}function Ix(t,e){const{guest:r,room:s,stay:a,hotel:i,document_date:o}=e,l=c=>c?{aadhaar:"Aadhaar Card",passport:"Passport",driving_license:"Driving License",other:"Other"}[c]||c:"N/A";return`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GRC ${t}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
    .container { max-width: 800px; margin: 0 auto; }
    .header { border-bottom: 2px solid #1f2937; padding-bottom: 16px; margin-bottom: 24px; text-align: center; }
    .hotel-name { font-size: 28px; font-weight: bold; color: #111; }
    .grc-title { font-size: 20px; font-weight: bold; color: #1d4ed8; text-transform: uppercase; letter-spacing: 1px; margin-top: 16px; }
    .section { border: 1px solid #d1d5db; padding: 16px; border-radius: 8px; margin-bottom: 16px; }
    .section-title { font-weight: bold; font-size: 15px; color: #1f2937; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid #e5e7eb; }
    .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .info-item label { font-size: 13px; color: #6b7280; display: block; margin-bottom: 2px; }
    .info-item span { font-weight: 500; }
    .declaration { background: #f9fafb; border: 1px solid #d1d5db; padding: 16px; border-radius: 8px; margin: 24px 0; font-size: 14px; }
    .signatures { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-top: 48px; }
    .signature-box { text-align: center; }
    .signature-line { border-top: 1px solid #9ca3af; padding-top: 8px; margin: 0 32px; }
    .footer { margin-top: 48px; padding-top: 16px; border-top: 1px solid #e5e7eb; text-align: center; color: #6b7280; font-size: 14px; }
    .archived-stamp { position: absolute; top: 20px; right: 20px; background: #059669; color: white; padding: 4px 12px; font-size: 12px; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="archived-stamp">ARCHIVED COPY</div>
    
    <div class="header">
      <div class="hotel-name">${i.name}</div>
      <div style="color: #6b7280; margin-top: 4px;">${i.address}</div>
      <div style="color: #6b7280; font-size: 14px;"> ${i.phone} |  ${i.email}</div>
      <div class="grc-title">Guest Registration Card</div>
      <div style="color: #6b7280; font-size: 13px;">(Form C - As per Government Regulations)</div>
    </div>

    <div style="display: flex; justify-content: space-between; margin-bottom: 24px; color: #374151;">
      <div><strong>GRC No:</strong> ${t}</div>
      <div><strong>Date:</strong> ${o}</div>
    </div>

    <div class="section">
      <div class="section-title">Guest Information</div>
      <div class="info-grid">
        <div class="info-item">
          <label>Full Name</label>
          <span>${r.full_name}</span>
        </div>
        <div class="info-item">
          <label>Mobile Number</label>
          <span>${r.mobile}</span>
        </div>
        ${r.email?`
        <div class="info-item">
          <label>Email</label>
          <span>${r.email}</span>
        </div>
        `:""}
        <div class="info-item">
          <label>Number of Guests</label>
          <span>${a.number_of_guests}</span>
        </div>
        ${r.address?`
        <div class="info-item" style="grid-column: span 2;">
          <label>Address</label>
          <span>${r.address}</span>
        </div>
        `:""}
      </div>
    </div>

    <div class="section">
      <div class="section-title">Identity Verification</div>
      <div class="info-grid">
        <div class="info-item">
          <label>ID Proof Type</label>
          <span>${l(r.id_proof_type)}</span>
        </div>
        <div class="info-item">
          <label>ID Proof Number</label>
          <span>${r.id_proof_number||"N/A"}</span>
        </div>
        <div class="info-item">
          <label>Nationality</label>
          <span>Indian</span>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Accommodation Details</div>
      <div class="info-grid">
        <div class="info-item">
          <label>Room Number</label>
          <span style="font-size: 18px;">${s.room_number}</span>
        </div>
        <div class="info-item">
          <label>Room Type</label>
          <span>${s.room_type}</span>
        </div>
        <div class="info-item">
          <label>Check-In Date & Time</label>
          <span>${new Date(a.check_in_date).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}</span>
        </div>
        <div class="info-item">
          <label>Expected Check-Out Date</label>
          <span>${new Date(a.check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}</span>
        </div>
      </div>
    </div>

    <div class="declaration">
      I hereby declare that the information provided above is true and correct to the best of my knowledge.
      I agree to abide by the hotel rules and regulations during my stay.
    </div>

    <div class="signatures">
      <div class="signature-box">
        <div class="signature-line">
          <div style="font-size: 13px; color: #6b7280;">Guest Signature</div>
          <div style="font-weight: 500; margin-top: 4px;">${r.full_name}</div>
        </div>
      </div>
      <div class="signature-box">
        <div class="signature-line">
          <div style="font-size: 13px; color: #6b7280;">Front Desk Signature</div>
          <div style="font-weight: 500; margin-top: 4px;">Authorized Signatory</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>Thank you for choosing ${i.name}</p>
      <p style="font-size: 12px;">This is a computer-generated document</p>
    </div>
  </div>
</body>
</html>
  `.trim()}async function Ox(t,e,r,s){try{const a=`${ie.invoice.prefix}-${t.id.slice(0,8).toUpperCase()}`,i=new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),o=e.reduce((_,C)=>_+Number(C.amount),0),l=o*s.cgst/100,c=o*s.sgst/100,d=o+l+c,u=r.reduce((_,C)=>_+Number(C.amount),0),h=d-u,m={guest:{id:t.guests.id,full_name:t.guests.full_name,mobile:t.guests.mobile,email:t.guests.email,address:t.guests.address,id_proof_type:t.guests.id_proof_type,id_proof_number:t.guests.id_proof_number},room:{room_number:t.rooms.room_number,room_type:t.rooms.room_types.name,base_rate:t.rooms.room_types.base_rate},stay:{check_in_date:t.check_in_date,check_out_date:t.actual_check_out_date||t.expected_check_out_date,number_of_guests:t.number_of_guests},charges:e,payments:r,taxes:s,totals:{subtotal:o,cgst_amount:l,sgst_amount:c,grand_total:d,total_paid:u,balance:h},hotel:{name:ie.name,address:ie.address.full,phone:ie.contact.phone,email:ie.contact.email,gstin:ie.gstin},document_date:i},x=Px(a,m),{error:v}=await T.from("guest_documents").insert([{booking_id:t.id,guest_id:t.guests.id,document_type:"invoice",document_number:a,document_html:x,document_data:m}]);if(v)throw v;return{success:!0,documentNumber:a}}catch(a){return{success:!1,error:a.message||"Failed to archive invoice"}}}async function $x(t,e){try{const r=`${ie.grc.prefix}-${t.id.slice(0,8).toUpperCase()}`,s=new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),a={guest:{id:t.guests.id,full_name:t.guests.full_name,mobile:t.guests.mobile,email:t.guests.email,address:t.guests.address,id_proof_type:t.guests.id_proof_type,id_proof_number:t.guests.id_proof_number},room:{room_number:t.rooms.room_number,room_type:t.rooms.room_types.name,base_rate:t.rooms.room_types.base_rate},stay:{check_in_date:t.check_in_date,check_out_date:t.actual_check_out_date||t.expected_check_out_date,number_of_guests:t.number_of_guests},charges:[],payments:[],taxes:e,totals:{subtotal:0,cgst_amount:0,sgst_amount:0,grand_total:0,total_paid:0,balance:0},hotel:{name:ie.name,address:ie.address.full,phone:ie.contact.phone,email:ie.contact.email,gstin:ie.gstin},document_date:s},i=Ix(r,a),{error:o}=await T.from("guest_documents").insert([{booking_id:t.id,guest_id:t.guests.id,document_type:"grc",document_number:r,document_html:i,document_data:a}]);if(o)throw o;return{success:!0,documentNumber:r}}catch(r){return{success:!1,error:r.message||"Failed to archive GRC"}}}async function Ax(t){const{data:e,error:r}=await T.from("guest_documents").select("*").eq("booking_id",t).order("created_at");if(r)throw r;return e||[]}async function vd(t){const{data:e}=await T.from("guests").select("*").eq("id",t).single(),{data:r}=await T.from("bookings").select("*, rooms(room_number, room_types(name, base_rate))").eq("guest_id",t).order("check_in_date",{ascending:!1}),{data:s}=await T.from("guest_documents").select("document_type, document_number, document_data, created_at").eq("guest_id",t).order("created_at",{ascending:!1}),a=[];for(const o of r||[]){const{data:l}=await T.from("folio_charges").select("*").eq("booking_id",o.id),{data:c}=await T.from("payments").select("*").eq("booking_id",o.id);a.push({...o,charges:l||[],payments:c||[]})}return{export_date:new Date().toISOString(),export_type:"guest_full_record",guest:e,stay_history:a,archived_documents:s}}function Lx(t,e){const r=new Blob([t],{type:"text/html"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}function Mx(t,e){const r=JSON.stringify(t,null,2),s=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}function wd(t){if(!t.length)return"";const e=Object.keys(t[0]),r=[e.join(",")];for(const s of t){const a=e.map(i=>{const o=s[i];return`"${String(o??"").replace(/"/g,'""')}"`});r.push(a.join(","))}return r.join(`
`)}function Ux(t,e){const r=new Blob([t],{type:"text/csv"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}function zx({document:t,onClose:e}){const[r,s]=N.useState(!1),a=()=>{s(!0);const l=window.open("","_blank");l?(l.document.write(t.document_html),l.document.close(),l.onload=()=>{l.print(),s(!1)}):(s(!1),alert("Please allow popups to print the document"))},i=()=>{const l=`${t.document_number}.html`;Lx(t.document_html,l)},o=t.document_type==="invoice"?"Invoice":"GRC";return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Xa,{className:"w-6 h-6 text-blue-600"}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Archived ",o]}),n.jsx("p",{className:"text-sm text-gray-600",children:t.document_number})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:i,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm",children:[n.jsx(Fl,{className:"w-4 h-4 mr-2"}),"Download"]}),n.jsxs("button",{onClick:a,disabled:r,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm disabled:opacity-50",children:[n.jsx(um,{className:"w-4 h-4 mr-2"}),r?"Printing...":"Print"]}),n.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]})]}),n.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100",children:n.jsx("div",{className:"bg-white shadow-lg mx-auto",style:{maxWidth:"800px"},children:n.jsx("iframe",{srcDoc:t.document_html,title:`${o} Preview`,className:"w-full border-0",style:{height:"70vh"}})})}),n.jsx("div",{className:"p-4 border-t bg-gray-50",children:n.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Archived on ",new Date(t.created_at).toLocaleString("en-IN"),"  This is a legally preserved copy of the original document"]})})]})})}function Fx({guestId:t,guestName:e,onClose:r}){const[s,a]=N.useState(!1),[i,o]=N.useState(null),l=async()=>{a(!0),o("json");try{const d=await vd(t),u=`guest_${e.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.json`;Mx(d,u)}catch(d){console.error("Export failed:",d),alert("Failed to export data. Please try again.")}finally{a(!1),o(null)}},c=async()=>{var d,u,h,m,x,v,_,C;a(!0),o("csv");try{const g=await vd(t),f=wd([{id:(d=g.guest)==null?void 0:d.id,full_name:(u=g.guest)==null?void 0:u.full_name,mobile:(h=g.guest)==null?void 0:h.mobile,email:((m=g.guest)==null?void 0:m.email)||"",address:((x=g.guest)==null?void 0:x.address)||"",id_proof_type:((v=g.guest)==null?void 0:v.id_proof_type)||"",id_proof_number:((_=g.guest)==null?void 0:_.id_proof_number)||""}]),p=((C=g.stay_history)==null?void 0:C.map(j=>{var E,D,A,W,ee;return{booking_id:j.id,check_in:j.check_in_date,expected_checkout:j.expected_check_out_date,actual_checkout:j.actual_check_out_date||"",status:j.status,room_number:((E=j.rooms)==null?void 0:E.room_number)||"",room_type:((A=(D=j.rooms)==null?void 0:D.room_types)==null?void 0:A.name)||"",total_charges:((W=j.charges)==null?void 0:W.reduce((R,U)=>R+U.amount,0))||0,total_payments:((ee=j.payments)==null?void 0:ee.reduce((R,U)=>R+U.amount,0))||0}}))||[],w=wd(p),S=`GUEST INFORMATION
${f}

STAY HISTORY
${w}`,k=`guest_${e.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`;Ux(S,k)}catch(g){console.error("Export failed:",g),alert("Failed to export data. Please try again.")}finally{a(!1),o(null)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Export Guest Data"}),n.jsx("p",{className:"text-sm text-gray-600",children:e})]}),n.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Export complete guest records including profile, stay history, charges, payments, and archived documents for offline backup."}),n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Export includes:"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:" Guest profile & ID details"}),n.jsx("li",{children:" Complete stay history"}),n.jsx("li",{children:" All charges & payments"}),n.jsx("li",{children:" Archived Invoice & GRC data"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:l,disabled:s,className:"flex items-center justify-center px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:[s&&i==="json"?n.jsx(pd,{className:"w-5 h-5 mr-2 animate-spin"}):n.jsx(xx,{className:"w-5 h-5 mr-2"}),"Export JSON"]}),n.jsxs("button",{onClick:c,disabled:s,className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[s&&i==="csv"?n.jsx(pd,{className:"w-5 h-5 mr-2 animate-spin"}):n.jsx(yx,{className:"w-5 h-5 mr-2"}),"Export CSV"]})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Files will be downloaded to your device for offline storage"})]})})}function Bx(){const{user:t}=Mt(),[e,r]=N.useState([]),[s,a]=N.useState([]),[i,o]=N.useState(""),[l,c]=N.useState(null),[d,u]=N.useState([]),[h,m]=N.useState([]),[x,v]=N.useState({totalStays:0,totalSpend:0,isVIP:!1}),[_,C]=N.useState([]),[g,f]=N.useState(!1),[p,w]=N.useState(null),[S,k]=N.useState(!0),[j,E]=N.useState(!1),[D,A]=N.useState(null),[W,ee]=N.useState(!1);N.useEffect(()=>{R()},[]),N.useEffect(()=>{const b=e.filter(y=>y.full_name.toLowerCase().includes(i.toLowerCase())||y.mobile.includes(i));a(b)},[i,e]);const R=async()=>{try{const{data:b,error:y}=await T.from("guests").select("*").order("created_at",{ascending:!1});if(y)throw y;r(b||[]),a(b||[])}catch(b){console.error("Error loading guests:",b)}finally{k(!1)}},U=async b=>{c(b),E(!0);const y=new Date().toISOString().split("T")[0],{data:I}=await T.from("reservations").select("*, room_types(*)").eq("guest_id",b.id).eq("status","confirmed").lte("check_in_date",y).order("check_in_date");u(I||[]);const{data:O}=await T.from("bookings").select("*, rooms(room_number, room_types(name))").eq("guest_id",b.id).order("check_in_date",{ascending:!1});let q=0;const z=[];for(const $ of O||[]){const{data:B}=await T.from("folio_charges").select("amount").eq("booking_id",$.id),{data:H}=await T.from("payments").select("amount").eq("booking_id",$.id);let V=[];try{V=await Ax($.id)}catch{}const he=(B==null?void 0:B.reduce((Ee,Te)=>Ee+Number(Te.amount),0))||0,Me=(H==null?void 0:H.reduce((Ee,Te)=>Ee+Number(Te.amount),0))||0;q+=Me,z.push({...$,totalCharges:he,totalPayments:Me,archivedDocs:V})}m(z),v({totalStays:z.length,totalSpend:q,isVIP:z.length>=3||q>=5e4}),E(!1)},Q=async(b=null)=>{w(b);const y=b==null?void 0:b.room_types.id,{data:I}=await T.from("rooms").select("*, room_types(*)").eq("status","vacant_clean").order("room_number");let O=I||[];y&&(O=O.filter(q=>q.room_type_id===y)),C(O||[]),f(!0)},te=async b=>{if(b.preventDefault(),!l)return;const y=new FormData(b.currentTarget),I=y.get("room_id"),O=y.get("check_out_date"),q=parseInt(y.get("number_of_guests")),z=parseFloat(y.get("advance_payment")||"0"),$=y.get("id_proof_type"),B=y.get("id_proof_number");try{await T.from("guests").update({id_proof_type:$,id_proof_number:B}).eq("id",l.id);const{data:H,error:V}=await T.from("bookings").insert([{reservation_id:(p==null?void 0:p.id)||null,guest_id:l.id,room_id:I,check_in_date:new Date().toISOString(),expected_check_out_date:O,number_of_guests:q,advance_payment:z,checked_in_by:t==null?void 0:t.id,status:"checked_in"}]).select().single();if(V)throw V;await T.from("rooms").update({status:"occupied"}).eq("id",I),p&&await T.from("reservations").update({status:"checked_in"}).eq("id",p.id);const he=_.find(Me=>Me.id===I);if(he){const Me=Math.ceil((new Date(O).getTime()-new Date().getTime())/864e5);for(let Ee=0;Ee<Me;Ee++){const Te=new Date;Te.setDate(Te.getDate()+Ee),await T.from("folio_charges").insert([{booking_id:H.id,charge_date:Te.toISOString().split("T")[0],description:`Room Rent - ${he.room_types.name} (Night ${Ee+1})`,amount:he.room_types.base_rate,charge_type:"room_rent",posted_by:t==null?void 0:t.id}])}}z>0&&await T.from("payments").insert([{booking_id:H.id,payment_date:new Date().toISOString(),amount:z,payment_mode:"cash",received_by:t==null?void 0:t.id}]),f(!1),c(null),w(null),alert("Check-in completed successfully!")}catch(H){alert("Error during check-in: "+(H.message||"Unknown error"))}};return S?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading guests..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Guests"}),n.jsx("p",{className:"text-gray-600",children:"View guest records and perform check-ins"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[n.jsx("div",{className:"p-4 border-b",children:n.jsxs("div",{className:"relative",children:[n.jsx(hm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search by name or mobile number...",value:i,onChange:b=>o(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mobile"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID Proof"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:s.map(b=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(nr,{className:"w-5 h-5 text-gray-400 mr-2"}),n.jsx("span",{className:"text-sm font-medium text-gray-800",children:b.full_name})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(hn,{className:"w-4 h-4 mr-1"}),b.mobile]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:b.email||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:b.id_proof_number?n.jsxs("span",{className:"capitalize",children:[b.id_proof_type,": ",b.id_proof_number]}):n.jsx("span",{className:"text-red-600",children:"Not provided"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:n.jsx("button",{onClick:()=>U(b),className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})})]},b.id))})]})}),s.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx(nr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No guests found"})]})]})]}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Guest Details"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Name"}),n.jsx("p",{className:"font-medium text-gray-800",children:l.full_name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Mobile"}),n.jsx("p",{className:"font-medium text-gray-800",children:l.mobile})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),n.jsx("p",{className:"font-medium text-gray-800",children:l.email||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),n.jsx("p",{className:"font-medium text-gray-800",children:l.address||"-"})]})]}),d.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Active Reservations"}),n.jsx("div",{className:"space-y-2",children:d.map(b=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(yt,{className:"w-5 h-5 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:b.room_types.name}),n.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(b.check_in_date).toLocaleDateString()," - ",new Date(b.check_out_date).toLocaleDateString()]})]})]}),n.jsxs("button",{onClick:()=>Q(b),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[n.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Check In"]})]},b.id))})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[x.isVIP&&n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium",children:[n.jsx(Sx,{className:"w-4 h-4"}),"VIP Guest"]}),x.totalStays>0&&n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[n.jsx(cx,{className:"w-4 h-4"}),x.totalStays," ",x.totalStays===1?"Stay":"Stays"]})]}),x.totalStays>0&&n.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Stays"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:x.totalStays})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Spend"}),n.jsxs("p",{className:"text-xl font-bold text-green-600 flex items-center",children:[n.jsx(Ca,{className:"w-5 h-5"}),x.totalSpend.toLocaleString("en-IN")]})]})]})]}),j?n.jsxs("div",{className:"flex items-center justify-center py-8",children:[n.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),n.jsx("span",{className:"ml-2 text-gray-600",children:"Loading history..."})]}):h.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[n.jsx(vx,{className:"w-5 h-5 text-gray-600"}),"Stay History"]}),n.jsxs("button",{onClick:()=>ee(!0),className:"flex items-center text-sm px-3 py-1 text-purple-600 hover:bg-purple-50 rounded-lg transition",children:[n.jsx(Fl,{className:"w-4 h-4 mr-1"}),"Export All Data"]})]}),n.jsx("div",{className:"max-h-64 overflow-y-auto space-y-3",children:h.map(b=>n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${b.status==="checked_in"?"bg-green-500":"bg-gray-400"}`}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-gray-800",children:["Room ",b.rooms.room_number," - ",b.rooms.room_types.name]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(b.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),b.actual_check_out_date&&n.jsxs(n.Fragment,{children:["  ",new Date(b.actual_check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})]})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"font-medium text-gray-800",children:["",b.totalPayments.toLocaleString("en-IN")]}),n.jsx("p",{className:`text-xs ${b.status==="checked_in"?"text-green-600":"text-gray-500"}`,children:b.status==="checked_in"?"Current":"Completed"})]})]}),b.archivedDocs.length>0&&n.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-200",children:[b.archivedDocs.map(y=>n.jsxs("button",{onClick:()=>A(y),className:"flex items-center text-xs px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 transition",children:[n.jsx(Xa,{className:"w-3 h-3 mr-1 text-blue-600"}),y.document_type==="invoice"?"Invoice":"GRC"]},y.id)),n.jsx("span",{className:"text-xs text-green-600 flex items-center ml-auto",children:" Archived"})]}),b.status==="checked_out"&&b.archivedDocs.length===0&&n.jsx("p",{className:"text-xs text-orange-500 mt-2 pt-2 border-t border-gray-200",children:" No archived documents (checked out before archival feature)"})]},b.id))})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>c(null),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Close"}),n.jsx("button",{onClick:()=>Q(null),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Walk-In Check In"})]})]})}),g&&l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:["Check In - ",l.full_name]}),n.jsxs("form",{onSubmit:te,children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[!l.id_proof_number&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"md:col-span-2",children:n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-yellow-800",children:"ID proof details are required for check-in"})})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Proof Type *"}),n.jsxs("select",{name:"id_proof_type",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"aadhaar",children:"Aadhaar Card"}),n.jsx("option",{value:"passport",children:"Passport"}),n.jsx("option",{value:"driving_license",children:"Driving License"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Proof Number *"}),n.jsx("input",{type:"text",name:"id_proof_number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Room *"}),n.jsxs("select",{name:"room_id",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Room"}),_.map(b=>n.jsxs("option",{value:b.id,children:[b.room_number," - ",b.room_types.name," (",b.room_types.base_rate,"/night)"]},b.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Guests *"}),n.jsx("input",{type:"number",name:"number_of_guests",min:"1",defaultValue:(p==null?void 0:p.number_of_guests)||1,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Check-Out Date *"}),n.jsx("input",{type:"date",name:"check_out_date",min:new Date().toISOString().split("T")[0],defaultValue:p==null?void 0:p.check_out_date,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Advance Payment ()"}),n.jsx("input",{type:"number",name:"advance_payment",step:"0.01",defaultValue:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>{f(!1),w(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Complete Check-In"})]})]})]})}),D&&n.jsx(zx,{document:D,onClose:()=>A(null)}),W&&l&&n.jsx(Fx,{guestId:l.id,guestName:l.full_name,onClose:()=>ee(!1)})]})}function bd({booking:t,folioCharges:e,payments:r,taxes:s}){const a=`${ie.invoice.prefix}-${t.id.slice(0,8).toUpperCase()}`,i=new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),o=e.reduce((v,_)=>v+Number(_.amount),0),l=o*s.cgst/100,c=o*s.sgst/100,d=o+l+c,u=r.reduce((v,_)=>v+Number(_.amount),0),h=d-u,m=new Date(t.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),x=new Date(t.actual_check_out_date||t.expected_check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"});return n.jsxs("div",{className:"invoice-container bg-white p-8 max-w-[210mm] mx-auto font-sans",children:[n.jsx("div",{className:"border-b-2 border-gray-800 pb-4 mb-6",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:ie.name}),n.jsx("p",{className:"text-gray-600 mt-1",children:ie.address.line1}),n.jsx("p",{className:"text-gray-600",children:ie.address.line2}),n.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:[" ",ie.contact.phone," |  ",ie.contact.email]}),n.jsxs("p",{className:"text-gray-600 text-sm",children:["GSTIN: ",ie.gstin]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("h2",{className:"text-2xl font-bold text-blue-700",children:"TAX INVOICE"}),n.jsxs("p",{className:"text-gray-700 mt-2",children:[n.jsx("span",{className:"font-semibold",children:"Invoice No:"})," ",a]}),n.jsxs("p",{className:"text-gray-700",children:[n.jsx("span",{className:"font-semibold",children:"Date:"})," ",i]})]})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Bill To:"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.full_name}),n.jsxs("p",{className:"text-gray-600",children:[" ",t.guests.mobile]}),t.guests.address&&n.jsx("p",{className:"text-gray-600 text-sm mt-1",children:t.guests.address})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Stay Details:"}),n.jsxs("p",{className:"text-gray-700",children:[n.jsx("span",{className:"font-medium",children:"Room:"})," ",t.rooms.room_number," (",t.rooms.room_types.name,")"]}),n.jsxs("p",{className:"text-gray-700",children:[n.jsx("span",{className:"font-medium",children:"Check-In:"})," ",m]}),n.jsxs("p",{className:"text-gray-700",children:[n.jsx("span",{className:"font-medium",children:"Check-Out:"})," ",x]}),n.jsxs("p",{className:"text-gray-700",children:[n.jsx("span",{className:"font-medium",children:"Guests:"})," ",t.number_of_guests]})]})]}),n.jsxs("table",{className:"w-full mb-6",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-gray-800 text-white",children:[n.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Date"}),n.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Description"}),n.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"Amount ()"})]})}),n.jsx("tbody",{children:e.map((v,_)=>n.jsxs("tr",{className:_%2===0?"bg-white":"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:new Date(v.charge_date).toLocaleDateString("en-IN")}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-800",children:v.description}),n.jsxs("td",{className:"px-4 py-2 text-sm text-gray-800 text-right",children:["",v.amount.toFixed(2)]})]},v.id))})]}),n.jsx("div",{className:"flex justify-end mb-6",children:n.jsxs("div",{className:"w-72",children:[n.jsxs("div",{className:"flex justify-between py-1 text-gray-700",children:[n.jsx("span",{children:"Subtotal"}),n.jsxs("span",{children:["",o.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between py-1 text-gray-700",children:[n.jsxs("span",{children:["CGST (",s.cgst,"%)"]}),n.jsxs("span",{children:["",l.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between py-1 text-gray-700",children:[n.jsxs("span",{children:["SGST (",s.sgst,"%)"]}),n.jsxs("span",{children:["",c.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between py-2 text-lg font-bold border-t-2 border-gray-800 mt-2",children:[n.jsx("span",{children:"Grand Total"}),n.jsxs("span",{children:["",d.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between py-1 text-green-700",children:[n.jsx("span",{children:"Amount Paid"}),n.jsxs("span",{children:["",u.toFixed(2)]})]}),h>0&&n.jsxs("div",{className:"flex justify-between py-1 text-red-700 font-semibold",children:[n.jsx("span",{children:"Balance Due"}),n.jsxs("span",{children:["",h.toFixed(2)]})]}),h<=0&&n.jsxs("div",{className:"flex justify-between py-1 text-green-700 font-semibold",children:[n.jsx("span",{children:"Status"}),n.jsx("span",{children:"PAID "})]})]})}),r.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Payment History:"}),n.jsx("div",{className:"text-sm text-gray-600",children:r.map(v=>n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsxs("span",{children:[new Date(v.payment_date).toLocaleDateString("en-IN")," - ",v.payment_mode.toUpperCase()]}),n.jsxs("span",{children:["",v.amount.toFixed(2)]})]},v.id))})]}),n.jsxs("div",{className:"border-t pt-4 mt-6",children:[n.jsx("h4",{className:"font-semibold text-gray-700 text-sm mb-2",children:"Terms & Conditions:"}),n.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:ie.invoice.termsAndConditions.map((v,_)=>n.jsx("li",{children:v},_))})]}),n.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-gray-600 text-sm",children:[n.jsx("p",{children:"Thank you for staying with us!"}),n.jsx("p",{className:"font-semibold text-gray-800",children:ie.name})]})]})}function qx({booking:t}){const e=`${ie.grc.prefix}-${t.id.slice(0,8).toUpperCase()}`,r=new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),s=new Date().toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),a=new Date(t.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),i=new Date(t.check_in_date).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),o=new Date(t.expected_check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),l=c=>c?{aadhaar:"Aadhaar Card",passport:"Passport",driving_license:"Driving License",other:"Other"}[c]||c:"N/A";return n.jsxs("div",{className:"grc-container bg-white p-8 max-w-[210mm] mx-auto font-sans",children:[n.jsxs("div",{className:"border-b-2 border-gray-800 pb-4 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:ie.name}),n.jsx("p",{className:"text-gray-600 mt-1",children:ie.address.full}),n.jsxs("p",{className:"text-gray-600 text-sm",children:[" ",ie.contact.phone," |  ",ie.contact.email]})]}),n.jsxs("div",{className:"mt-4 text-center",children:[n.jsx("h2",{className:"text-xl font-bold text-blue-700 uppercase tracking-wide",children:ie.grc.formTitle}),n.jsx("p",{className:"text-gray-600 text-sm",children:"(Form C - As per Government Regulations)"})]})]}),n.jsxs("div",{className:"flex justify-between mb-6 text-gray-700",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"GRC No:"})," ",e]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"Date:"})," ",r," | ",s]})]}),n.jsxs("div",{className:"border border-gray-300 rounded-lg p-4 mb-6",children:[n.jsx("h3",{className:"font-bold text-gray-800 mb-4 pb-2 border-b",children:"Guest Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Full Name"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.full_name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Mobile Number"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.mobile})]}),t.guests.email&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.email})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Number of Guests"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.number_of_guests})]}),t.guests.address&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.address})]})]})]}),n.jsxs("div",{className:"border border-gray-300 rounded-lg p-4 mb-6",children:[n.jsx("h3",{className:"font-bold text-gray-800 mb-4 pb-2 border-b",children:"Identity Verification"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"ID Proof Type"}),n.jsx("p",{className:"font-medium text-gray-900",children:l(t.guests.id_proof_type)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"ID Proof Number"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.guests.id_proof_number||"N/A"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Nationality"}),n.jsx("p",{className:"font-medium text-gray-900",children:"Indian"})]})]})]}),n.jsxs("div",{className:"border border-gray-300 rounded-lg p-4 mb-6",children:[n.jsx("h3",{className:"font-bold text-gray-800 mb-4 pb-2 border-b",children:"Accommodation Details"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Room Number"}),n.jsx("p",{className:"font-medium text-gray-900 text-lg",children:t.rooms.room_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Room Type"}),n.jsx("p",{className:"font-medium text-gray-900",children:t.rooms.room_types.name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Check-In Date & Time"}),n.jsxs("p",{className:"font-medium text-gray-900",children:[a," at ",i]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Expected Check-Out Date"}),n.jsx("p",{className:"font-medium text-gray-900",children:o})]})]})]}),n.jsx("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-4 mb-8",children:n.jsx("p",{className:"text-sm text-gray-700",children:"I hereby declare that the information provided above is true and correct to the best of my knowledge. I agree to abide by the hotel rules and regulations during my stay."})}),n.jsxs("div",{className:"grid grid-cols-2 gap-8 mt-12",children:[n.jsx("div",{className:"text-center",children:n.jsxs("div",{className:"border-t border-gray-400 pt-2 mx-8",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Guest Signature"}),n.jsx("p",{className:"font-medium text-gray-800 mt-1",children:t.guests.full_name})]})}),n.jsx("div",{className:"text-center",children:n.jsxs("div",{className:"border-t border-gray-400 pt-2 mx-8",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Front Desk Signature"}),n.jsx("p",{className:"font-medium text-gray-800 mt-1",children:"Authorized Signatory"})]})})]}),n.jsxs("div",{className:"mt-12 pt-4 border-t text-center text-gray-600 text-sm",children:[n.jsxs("p",{children:["Thank you for choosing ",ie.name]}),n.jsx("p",{className:"text-xs mt-1",children:"This is a computer-generated document"})]})]})}function $i({children:t,title:e,buttonText:r="Print",buttonClassName:s="flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition"}){const a=N.useRef(null),i=()=>{if(!a.current)return;const o=window.open("","_blank");if(!o){alert("Please allow popups to print documents");return}o.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>${e}</title>
          
      <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          line-height: 1.5;
          color: #1f2937;
          background: white;
        }
        .invoice-container, .grc-container {
          padding: 20mm;
          max-width: 210mm;
          margin: 0 auto;
        }
        
        /* Tailwind-like utility classes for print */
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .font-medium { font-weight: 500; }
        
        .text-3xl { font-size: 1.875rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-xl { font-size: 1.25rem; }
        .text-lg { font-size: 1.125rem; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        
        .text-gray-900 { color: #111827; }
        .text-gray-800 { color: #1f2937; }
        .text-gray-700 { color: #374151; }
        .text-gray-600 { color: #4b5563; }
        .text-blue-700 { color: #1d4ed8; }
        .text-green-700 { color: #15803d; }
        .text-red-700 { color: #b91c1c; }
        .text-white { color: white; }
        
        .bg-white { background-color: white; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-gray-800 { background-color: #1f2937; }
        
        .border { border: 1px solid #d1d5db; }
        .border-t { border-top: 1px solid #d1d5db; }
        .border-b { border-bottom: 1px solid #d1d5db; }
        .border-t-2 { border-top: 2px solid #1f2937; }
        .border-b-2 { border-bottom: 2px solid #1f2937; }
        .border-gray-300 { border-color: #d1d5db; }
        .border-gray-400 { border-color: #9ca3af; }
        .border-gray-800 { border-color: #1f2937; }
        
        .rounded-lg { border-radius: 0.5rem; }
        
        .p-4 { padding: 1rem; }
        .p-8 { padding: 2rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .pb-2 { padding-bottom: 0.5rem; }
        .pb-4 { padding-bottom: 1rem; }
        .pt-2 { padding-top: 0.5rem; }
        .pt-4 { padding-top: 1rem; }
        
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-8 { margin-top: 2rem; }
        .mt-12 { margin-top: 3rem; }
        .mx-8 { margin-left: 2rem; margin-right: 2rem; }
        
        .flex { display: flex; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .gap-8 { gap: 2rem; }
        .justify-between { justify-content: space-between; }
        .justify-end { justify-content: flex-end; }
        .items-start { align-items: flex-start; }
        
        .col-span-2 { grid-column: span 2; }
        
        .w-full { width: 100%; }
        .w-72 { width: 18rem; }
        
        .uppercase { text-transform: uppercase; }
        .tracking-wide { letter-spacing: 0.05em; }
        
        .list-disc { list-style-type: disc; }
        .list-inside { list-style-position: inside; }
        
        /* Table styles */
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.5rem 1rem; }
        thead tr { background-color: #1f2937; color: white; }
        tbody tr:nth-child(even) { background-color: #f9fafb; }
        
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body {
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
          }
          .invoice-container, .grc-container {
            padding: 15mm;
          }
        }
      </style>
    
        </head>
        <body>
          ${a.current.innerHTML}
        </body>
      </html>
    `),o.document.close(),setTimeout(()=>{o.print()},250)};return n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:i,className:s,children:[n.jsx(um,{className:"w-4 h-4 mr-2"}),r]}),n.jsx("div",{style:{display:"none"},children:n.jsx("div",{ref:a,children:t})})]})}function Hx(){const{user:t}=Mt(),[e,r]=N.useState([]),[s,a]=N.useState(null),[i,o]=N.useState([]),[l,c]=N.useState([]),[d,u]=N.useState(!1),[h,m]=N.useState(!1),[x,v]=N.useState(!1),[_,C]=N.useState(!1),[g,f]=N.useState(!1),[p,w]=N.useState(null),[S,k]=N.useState([]),[j,E]=N.useState({cgst:6,sgst:6}),[D,A]=N.useState(!0);N.useEffect(()=>{ee(),W()},[]);const W=async()=>{const{data:$}=await T.from("tax_config").select("*").eq("is_active",!0),B=$==null?void 0:$.find(V=>V.tax_name==="CGST"),H=$==null?void 0:$.find(V=>V.tax_name==="SGST");E({cgst:(B==null?void 0:B.tax_percentage)||6,sgst:(H==null?void 0:H.tax_percentage)||6})},ee=async()=>{try{const{data:$,error:B}=await T.from("bookings").select("*, guests(*), rooms(*, room_types(*))").eq("status","checked_in").order("check_in_date",{ascending:!1});if(B)throw B;r($||[])}catch($){console.error("Error loading bookings:",$)}finally{A(!1)}};Za(ee),Tx(()=>{s&&R(s.id)});const R=async $=>{const{data:B}=await T.from("folio_charges").select("*").eq("booking_id",$).order("charge_date"),{data:H}=await T.from("payments").select("*").eq("booking_id",$).order("payment_date");o(B||[]),c(H||[])},U=$=>{a($),R($.id)},Q=async $=>{if($.preventDefault(),!s)return;const B=new FormData($.currentTarget),H={booking_id:s.id,charge_date:B.get("charge_date"),description:B.get("description"),amount:parseFloat(B.get("amount")),charge_type:B.get("charge_type"),posted_by:t==null?void 0:t.id};await T.from("folio_charges").insert([H]),R(s.id),u(!1)},te=()=>{const $=i.reduce((Te,Pr)=>Te+Number(Pr.amount),0),B=l.reduce((Te,Pr)=>Te+Number(Pr.amount),0),H=$,V=H*j.cgst/100,he=H*j.sgst/100,Me=H+V+he,Ee=Me-B;return{subtotal:H,cgstAmount:V,sgstAmount:he,grandTotal:Me,totalPayments:B,balance:Ee}},b=async $=>{if($.preventDefault(),!s)return;const B=new FormData($.currentTarget),H=parseFloat(B.get("payment_amount"))||0,V=B.get("payment_mode");w({amount:H,mode:V}),m(!1),f(!0)},y=async()=>{if(s)try{p&&p.amount>0&&await T.from("payments").insert([{booking_id:s.id,payment_date:new Date().toISOString(),amount:p.amount,payment_mode:p.mode,received_by:t==null?void 0:t.id}]);const{data:$}=await T.from("folio_charges").select("*").eq("booking_id",s.id),{data:B}=await T.from("payments").select("*").eq("booking_id",s.id),{data:H}=await T.from("bookings").select("guest_id").eq("id",s.id).single();if(H){const V={...s,guests:{...s.guests,id:H.guest_id}};await Ox(V,$||[],B||[],j),await $x(V,j)}await T.from("bookings").update({status:"checked_out",actual_check_out_date:new Date().toISOString(),checked_out_by:t==null?void 0:t.id}).eq("id",s.id),await T.from("rooms").update({status:"vacant_dirty"}).eq("id",s.rooms.id),f(!1),w(null),a(null),ee(),alert("Check-out completed successfully! Invoice and GRC have been archived.")}catch($){alert("Error during checkout: "+($.message||"Unknown error"))}},I=async $=>{if($.preventDefault(),!s)return;const H=new FormData($.currentTarget).get("new_checkout_date");try{const V=new Date(s.expected_check_out_date),he=new Date(H),Me=Math.ceil((he.getTime()-V.getTime())/(1e3*60*60*24));if(Me>0)for(let Ee=0;Ee<Me;Ee++){const Te=new Date(V);Te.setDate(V.getDate()+Ee),await T.from("folio_charges").insert([{booking_id:s.id,charge_date:Te.toISOString().split("T")[0],description:`Room Rent - ${s.rooms.room_types.name} (Extended)`,amount:s.rooms.room_types.base_rate,charge_type:"room_rent",posted_by:t==null?void 0:t.id}])}await T.from("bookings").update({expected_check_out_date:H}).eq("id",s.id),v(!1),R(s.id),ee(),alert(`Stay extended by ${Me} night(s). Room charges added.`)}catch(V){alert("Error extending stay: "+(V.message||"Unknown error"))}},O=async()=>{const{data:$}=await T.from("rooms").select("id, room_number, room_types(name)").eq("status","vacant_clean").order("room_number"),B=($||[]).map(H=>({id:H.id,room_number:H.room_number,room_types:Array.isArray(H.room_types)?H.room_types[0]||null:H.room_types}));k(B)},q=async $=>{if($.preventDefault(),!s)return;const H=new FormData($.currentTarget).get("new_room_id");try{await T.from("rooms").update({status:"vacant_dirty"}).eq("id",s.rooms.id),await T.from("rooms").update({status:"occupied"}).eq("id",H),await T.from("bookings").update({room_id:H}).eq("id",s.id),C(!1),a(null),ee(),alert("Room changed successfully!")}catch(V){alert("Error changing room: "+(V.message||"Unknown error"))}},z=$=>{const B=new Date($),V=Math.abs(new Date().getTime()-B.getTime());return Math.ceil(V/(1e3*60*60*24))||1};return D?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading in-house guests..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"In-House Guests"}),n.jsx("p",{className:"text-gray-600",children:"Manage active bookings and guest folios"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"p-4 border-b",children:n.jsxs("h2",{className:"font-semibold text-gray-800",children:["Active Bookings (",e.length,")"]})}),n.jsxs("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:[e.map($=>n.jsxs("button",{onClick:()=>U($),className:`w-full p-4 text-left hover:bg-gray-50 transition ${(s==null?void 0:s.id)===$.id?"bg-blue-50":""}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:$.guests.full_name}),n.jsx("p",{className:"text-sm text-gray-600",children:$.guests.mobile})]}),n.jsx("span",{className:"text-lg font-bold text-blue-600",children:$.rooms.room_number})]}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[n.jsx("span",{children:$.rooms.room_types.name}),n.jsxs("span",{children:["Day ",z($.check_in_date)]})]})]},$.id)),e.length===0&&n.jsx("div",{className:"p-8 text-center text-gray-500",children:n.jsx("p",{children:"No in-house guests"})})]})]})}),n.jsx("div",{className:"lg:col-span-2",children:s?n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsxs("div",{className:"p-6 border-b",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:s.guests.full_name}),n.jsxs("p",{className:"text-gray-600",children:["Room ",s.rooms.room_number," - ",s.rooms.room_types.name]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Check-In"}),n.jsx("p",{className:"font-medium",children:new Date(s.check_in_date).toLocaleDateString()})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.jsxs("button",{onClick:()=>u(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Charge"]}),n.jsx($i,{title:`Invoice - ${s.guests.full_name}`,buttonText:"Print Invoice",buttonClassName:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition",children:n.jsx(bd,{booking:s,folioCharges:i,payments:l,taxes:j})}),n.jsx($i,{title:`GRC - ${s.guests.full_name}`,buttonText:"Print GRC",buttonClassName:"flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition",children:n.jsx(qx,{booking:s})}),n.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:[n.jsx(dx,{className:"w-4 h-4 mr-2"}),"Extend Stay"]}),n.jsxs("button",{onClick:()=>{O(),C(!0)},className:"flex items-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition",children:[n.jsx(lx,{className:"w-4 h-4 mr-2"}),"Change Room"]}),n.jsxs("button",{onClick:()=>m(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[n.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Check Out"]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[n.jsx(jx,{className:"w-5 h-5 mr-2"}),"Guest Folio"]}),n.jsx("div",{className:"overflow-x-auto mb-6",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Date"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Description"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"Amount"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map($=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date($.charge_date).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-800",children:$.description}),n.jsxs("td",{className:"px-4 py-3 text-sm text-gray-800 text-right",children:["",$.amount.toFixed(2)]})]},$.id))})]})}),n.jsxs("div",{className:"border-t pt-4 space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Subtotal"}),n.jsxs("span",{className:"font-medium",children:["",te().subtotal.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:["CGST (",j.cgst,"%)"]}),n.jsxs("span",{className:"font-medium",children:["",te().cgstAmount.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:["SGST (",j.sgst,"%)"]}),n.jsxs("span",{className:"font-medium",children:["",te().sgstAmount.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[n.jsx("span",{children:"Grand Total"}),n.jsxs("span",{children:["",te().grandTotal.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsx("span",{children:"Total Paid"}),n.jsxs("span",{className:"font-medium",children:["",te().totalPayments.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold text-red-600",children:[n.jsx("span",{children:"Balance Due"}),n.jsxs("span",{children:["",te().balance.toFixed(2)]})]})]})]})]}):n.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[n.jsx(yt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Select a booking to view folio details"})]})})]})]}),d&&s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Add Charge"}),n.jsxs("form",{onSubmit:Q,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),n.jsx("input",{type:"date",name:"charge_date",defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Charge Type"}),n.jsxs("select",{name:"charge_type",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"room_rent",children:"Room Rent"}),n.jsx("option",{value:"extra_bed",children:"Extra Bed"}),n.jsx("option",{value:"early_checkin",children:"Early Check-in"}),n.jsx("option",{value:"late_checkout",children:"Late Check-out"}),n.jsx("option",{value:"miscellaneous",children:"Miscellaneous"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",name:"description",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount ()"}),n.jsx("input",{type:"number",name:"amount",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Charge"})]})]})]})}),h&&s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Check Out"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[n.jsxs("div",{className:"flex justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),n.jsxs("span",{className:"font-bold text-lg",children:["",te().grandTotal.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Paid:"}),n.jsxs("span",{className:"text-green-600 font-medium",children:["",te().totalPayments.toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2 mt-2",children:[n.jsx("span",{children:"Balance Due:"}),n.jsxs("span",{className:"text-red-600",children:["",te().balance.toFixed(2)]})]})]}),n.jsxs("form",{onSubmit:b,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount ()"}),n.jsx("input",{type:"number",name:"payment_amount",step:"0.01",defaultValue:Math.max(0,te().balance).toFixed(2),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),n.jsxs("select",{name:"payment_mode",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"upi",children:"UPI"}),n.jsx("option",{value:"card",children:"Card"})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Complete Check-Out"})]})]})]})}),x&&s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Extend Stay"}),n.jsx("button",{onClick:()=>v(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:s.guests.full_name})," - Room ",s.rooms.room_number]}),n.jsxs("p",{className:"text-xs text-blue-600",children:["Current checkout: ",new Date(s.expected_check_out_date).toLocaleDateString("en-IN")]})]}),n.jsxs("form",{onSubmit:I,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Check-Out Date *"}),n.jsx("input",{type:"date",name:"new_checkout_date",min:new Date(s.expected_check_out_date).toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Room charges will be added for additional nights"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Extend Stay"})]})]})]})}),_&&s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Change Room"}),n.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg mb-4",children:[n.jsx("p",{className:"text-sm text-yellow-800",children:n.jsx("strong",{children:s.guests.full_name})}),n.jsxs("p",{className:"text-xs text-yellow-600",children:["Current room: ",s.rooms.room_number," (",s.rooms.room_types.name,")"]})]}),n.jsxs("form",{onSubmit:q,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Room *"}),n.jsxs("select",{name:"new_room_id",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select Room"}),S.map($=>{var B;return n.jsxs("option",{value:$.id,children:[$.room_number," - ",((B=$.room_types)==null?void 0:B.name)||"Unknown"]},$.id)})]}),S.length===0&&n.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No vacant clean rooms available"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:()=>C(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:S.length===0,className:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Change Room"})]})]})]})}),g&&s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[95vh] overflow-hidden flex flex-col",children:[n.jsx("div",{className:"p-4 border-b bg-blue-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:" Invoice Preview"}),n.jsx("p",{className:"text-sm text-blue-700",children:"Please print the invoice before completing checkout"})]}),n.jsx("button",{onClick:()=>{f(!1),w(null)},className:"p-2 hover:bg-blue-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]})}),n.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:n.jsx($i,{title:`Invoice - ${s.guests.full_name}`,children:n.jsx(bd,{booking:s,folioCharges:i,payments:l,taxes:j})})}),n.jsxs("div",{className:"p-4 border-t bg-gray-50 flex gap-3",children:[n.jsx("button",{onClick:()=>{f(!1),m(!0),w(null)},className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:" Back to Checkout"}),n.jsx("button",{onClick:y,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold",children:" Complete Checkout"})]})]})})]})}function Vx(){const{user:t}=Mt(),[e,r]=N.useState([]),[s,a]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(!0),[d,u]=N.useState(""),[h,m]=N.useState([]),[x,v]=N.useState(!1),[_,C]=N.useState(!1),[g,f]=N.useState(null),[p,w]=N.useState(""),[S,k]=N.useState(!1),[j,E]=N.useState({guestName:"",mobile:"",email:"",idType:"Aadhaar",idNumber:"",address:"",roomTypeId:"",roomId:"",numberOfGuests:1,nights:1,advancePayment:0,paymentMode:"cash"}),[D,A]=N.useState([]);N.useEffect(()=>{W()},[]);const W=async()=>{c(!0);try{const b=new Date().toISOString().split("T")[0],y=new Date;y.setDate(y.getDate()+1);const{data:I}=await T.from("reservations").select("*, guests(*), room_types(*)").eq("status","confirmed").eq("check_in_date",b).order("guests(full_name)"),{data:O}=await T.from("reservations").select("*, guests(*), room_types(*)").eq("status","confirmed").lt("check_in_date",b).order("check_in_date"),{data:q}=await T.from("rooms").select("*, room_types(*)").eq("status","vacant_clean").order("room_number"),{data:z}=await T.from("room_types").select("id, name, base_rate").eq("is_active",!0).order("name");r(I||[]),a(O||[]),o(q||[]),A(z||[])}catch(b){console.error("Error loading check-in data:",b)}finally{c(!1)}};Za(W);const ee=async b=>{if(u(b),b.length<2){m([]);return}const{data:y}=await T.from("guests").select("*").or(`full_name.ilike.%${b}%,mobile.ilike.%${b}%`).limit(5);m(y||[])},R=b=>{f(b),w(b.assigned_room_id||""),C(!0)},U=async()=>{if(!(!g||!p)){k(!0);try{const b=i.find(B=>B.id===p);if(!b)throw new Error("Room not found");const y=new Date,I=new Date(g.check_out_date),O=Math.ceil((I.getTime()-y.getTime())/(1e3*60*60*24)),{data:q,error:z}=await T.from("bookings").insert([{guest_id:g.guests.id,room_id:p,check_in_date:new Date().toISOString(),expected_check_out_date:g.check_out_date,number_of_guests:g.number_of_guests,status:"checked_in",checked_in_by:t==null?void 0:t.id}]).select().single();if(z)throw z;const $=b.room_types.base_rate*O;await T.from("folio_charges").insert([{booking_id:q.id,charge_date:new Date().toISOString(),description:`Room Charge - ${b.room_types.name} (${O} nights)`,amount:$,charge_type:"room"}]),await T.from("rooms").update({status:"occupied"}).eq("id",p),await T.from("reservations").update({status:"checked_in"}).eq("id",g.id),C(!1),f(null),w(""),W(),alert(`Guest ${g.guests.full_name} checked in successfully to Room ${b.room_number}!`)}catch(b){console.error("Error processing check-in:",b),alert("Failed to process check-in. Please try again.")}finally{k(!1)}}},Q=async b=>{if(b.preventDefault(),!(!j.guestName||!j.mobile||!j.roomId)){k(!0);try{const{data:y}=await T.from("guests").select("id").eq("mobile",j.mobile).single();let I=y==null?void 0:y.id;if(!I){const{data:H,error:V}=await T.from("guests").insert([{full_name:j.guestName,mobile:j.mobile,email:j.email||null,id_proof_type:j.idType,id_proof_number:j.idNumber,address:j.address||null}]).select().single();if(V)throw V;I=H==null?void 0:H.id}const O=i.find(H=>H.id===j.roomId);if(!O||!I)throw new Error("Room or guest not found");const q=new Date;q.setDate(q.getDate()+j.nights);const{data:z,error:$}=await T.from("bookings").insert([{guest_id:I,room_id:j.roomId,check_in_date:new Date().toISOString(),expected_check_out_date:q.toISOString(),number_of_guests:j.numberOfGuests,advance_payment:j.advancePayment,status:"checked_in",checked_in_by:t==null?void 0:t.id}]).select().single();if($)throw $;const B=O.room_types.base_rate*j.nights;await T.from("folio_charges").insert([{booking_id:z.id,charge_date:new Date().toISOString(),description:`Room Charge - ${O.room_types.name} (${j.nights} nights)`,amount:B,charge_type:"room"}]),j.advancePayment>0&&await T.from("payments").insert([{booking_id:z.id,payment_date:new Date().toISOString(),amount:j.advancePayment,payment_mode:j.paymentMode,received_by:t==null?void 0:t.id}]),await T.from("rooms").update({status:"occupied"}).eq("id",j.roomId),v(!1),E({guestName:"",mobile:"",email:"",idType:"Aadhaar",idNumber:"",address:"",roomTypeId:"",roomId:"",numberOfGuests:1,nights:1,advancePayment:0,paymentMode:"cash"}),W(),alert(`Walk-in guest ${j.guestName} checked in successfully to Room ${O.room_number}!`)}catch(y){console.error("Error processing walk-in:",y),alert("Failed to process walk-in. Please try again.")}finally{k(!1)}}},te=b=>i.filter(y=>y.room_types.id===b);return l?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading arrivals..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:[n.jsx(Is,{className:"w-8 h-8 text-green-600"}),"Check-In Desk"]}),n.jsx("p",{className:"text-gray-600",children:"Quick check-in for arrivals and walk-in guests"})]}),n.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium",children:[n.jsx(Er,{className:"w-5 h-5"}),"Walk-In Check-In"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(yt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),n.jsx("div",{className:"text-sm text-gray-600",children:"Today's Arrivals"})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:n.jsx(Cr,{className:"w-5 h-5 text-orange-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.length}),n.jsx("div",{className:"text-sm text-gray-600",children:"Overdue"})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:n.jsx(ea,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.length}),n.jsx("div",{className:"text-sm text-gray-600",children:"Rooms Ready"})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center",children:n.jsx(Da,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.reduce((b,y)=>b+y.number_of_guests,0)}),n.jsx("div",{className:"text-sm text-gray-600",children:"Expected Guests"})]})]})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx(hm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"Search guest by name or mobile...",value:d,onChange:b=>ee(b.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.length>0&&n.jsx("div",{className:"mt-2 border rounded-lg overflow-hidden",children:h.map(b=>n.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 border-b last:border-b-0",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:b.full_name}),n.jsxs("div",{className:"text-sm text-gray-500",children:[" ",b.mobile]})]}),n.jsx("button",{onClick:()=>{E(y=>({...y,guestName:b.full_name,mobile:b.mobile,email:b.email||"",idType:b.id_proof_type||"Aadhaar",idNumber:b.id_proof_number||"",address:b.address||""})),v(!0),u(""),m([])},className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:"Check-In"})]},b.id))})]}),s.length>0&&n.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-orange-800 mb-3 flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5"}),"Overdue Check-Ins (",s.length,")"]}),n.jsx("div",{className:"space-y-2",children:s.map(b=>n.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg p-3 border border-orange-200",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:n.jsx(nr,{className:"w-5 h-5 text-orange-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:b.guests.full_name}),n.jsxs("div",{className:"text-sm text-gray-500",children:[b.room_types.name,"  Due: ",new Date(b.check_in_date).toLocaleDateString("en-IN")]})]})]}),n.jsxs("button",{onClick:()=>R(b),className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition",children:["Check-In ",n.jsx(om,{className:"w-4 h-4"})]})]},b.id))})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"p-4 border-b",children:n.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5 text-blue-600"}),"Today's Arrivals - ",new Date().toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"})]})}),e.length===0?n.jsxs("div",{className:"p-12 text-center text-gray-500",children:[n.jsx(Is,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),n.jsx("p",{className:"text-lg font-medium",children:"No arrivals scheduled for today"}),n.jsx("p",{className:"text-sm mt-2",children:'Use "Walk-In Check-In" for unscheduled guests'})]}):n.jsx("div",{className:"divide-y",children:e.map(b=>n.jsx("div",{className:"p-4 hover:bg-gray-50 transition",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(nr,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-gray-800 text-lg",children:b.guests.full_name}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(hn,{className:"w-4 h-4"}),b.guests.mobile]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ea,{className:"w-4 h-4"}),b.room_types.name]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Da,{className:"w-4 h-4"}),b.number_of_guests," guest(s)"]})]}),n.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Stay: ",new Date(b.check_in_date).toLocaleDateString("en-IN"),"  ",new Date(b.check_out_date).toLocaleDateString("en-IN")]})]})]}),n.jsxs("button",{onClick:()=>R(b),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium",children:[n.jsx(Is,{className:"w-5 h-5"}),"Check-In"]})]})},b.id))})]})]}),_&&g&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Complete Check-In"}),n.jsx("p",{className:"text-sm text-gray-600",children:g.guests.full_name})]}),n.jsx("button",{onClick:()=>{C(!1),f(null)},className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Mobile:"}),n.jsx("span",{className:"ml-2 font-medium",children:g.guests.mobile})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Guests:"}),n.jsx("span",{className:"ml-2 font-medium",children:g.number_of_guests})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Room Type:"}),n.jsx("span",{className:"ml-2 font-medium",children:g.room_types.name})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Checkout:"}),n.jsx("span",{className:"ml-2 font-medium",children:new Date(g.check_out_date).toLocaleDateString("en-IN")})]})]})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Assign Room (",g.room_types.name,")"]}),n.jsxs("select",{value:p,onChange:b=>w(b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",required:!0,children:[n.jsx("option",{value:"",children:"Select a room..."}),i.filter(b=>b.room_types.id===g.room_types.id).map(b=>n.jsxs("option",{value:b.id,children:["Room ",b.room_number," (Floor ",b.floor,")"]},b.id))]}),i.filter(b=>b.room_types.id===g.room_types.id).length===0&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:"No clean rooms available for this type"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{onClick:()=>{C(!1),f(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:U,disabled:!p||S,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:S?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(un,{className:"w-5 h-5"}),"Confirm Check-In"]})})]})]})]})}),x&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Walk-In Check-In"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Register a new guest without prior reservation"})]}),n.jsx("button",{onClick:()=>v(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[n.jsx(nr,{className:"w-4 h-4"}),"Guest Details"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),n.jsx("input",{type:"text",value:j.guestName,onChange:b=>E(y=>({...y,guestName:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile *"}),n.jsx("input",{type:"tel",value:j.mobile,onChange:b=>E(y=>({...y,mobile:b.target.value})),pattern:"[0-9]{10}",placeholder:"10-digit mobile",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:j.email,onChange:b=>E(y=>({...y,email:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Proof Type"}),n.jsxs("select",{value:j.idType,onChange:b=>E(y=>({...y,idType:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[n.jsx("option",{children:"Aadhaar"}),n.jsx("option",{children:"Passport"}),n.jsx("option",{children:"Driving License"}),n.jsx("option",{children:"Voter ID"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Number"}),n.jsx("input",{type:"text",value:j.idNumber,onChange:b=>E(y=>({...y,idNumber:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("input",{type:"text",value:j.address,onChange:b=>E(y=>({...y,address:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[n.jsx(ea,{className:"w-4 h-4"}),"Room Selection"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room Type *"}),n.jsxs("select",{value:j.roomTypeId,onChange:b=>E(y=>({...y,roomTypeId:b.target.value,roomId:""})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",required:!0,children:[n.jsx("option",{value:"",children:"Select type..."}),D.map(b=>n.jsxs("option",{value:b.id,children:[b.name," (",b.base_rate,"/night)"]},b.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room *"}),n.jsxs("select",{value:j.roomId,onChange:b=>E(y=>({...y,roomId:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",required:!0,disabled:!j.roomTypeId,children:[n.jsx("option",{value:"",children:"Select room..."}),te(j.roomTypeId).map(b=>n.jsxs("option",{value:b.id,children:[b.room_number," (Floor ",b.floor,")"]},b.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Guests"}),n.jsx("input",{type:"number",min:1,max:4,value:j.numberOfGuests,onChange:b=>E(y=>({...y,numberOfGuests:parseInt(b.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[n.jsx(px,{className:"w-4 h-4"}),"Stay & Payment"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Nights"}),n.jsx("input",{type:"number",min:1,max:30,value:j.nights,onChange:b=>E(y=>({...y,nights:parseInt(b.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Advance Payment ()"}),n.jsx("input",{type:"number",min:0,value:j.advancePayment,onChange:b=>E(y=>({...y,advancePayment:parseFloat(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),n.jsxs("select",{value:j.paymentMode,onChange:b=>E(y=>({...y,paymentMode:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"card",children:"Card"}),n.jsx("option",{value:"upi",children:"UPI"}),n.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]})]})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!j.guestName||!j.mobile||!j.roomId||S,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium",children:S?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Is,{className:"w-5 h-5"}),"Complete Check-In"]})})]})]})]})})]})}function Wx(){const[t,e]=N.useState("summary"),[r,s]=N.useState({todayArrivals:0,todayDepartures:0,inHouseGuests:0,occupancyRate:0,todayRevenue:0,monthRevenue:0,totalRooms:0}),[a,i]=N.useState([]),[o,l]=N.useState([]),[c,d]=N.useState(!0),[u,h]=N.useState(new Date().toISOString().split("T")[0]);N.useEffect(()=>{m()},[u]);const m=async()=>{try{const x=u,v=`${x.substring(0,7)}-01`,{data:_}=await T.from("rooms").select("*"),C=(_==null?void 0:_.length)||0,{data:g}=await T.from("bookings").select("*, guests(*), rooms(*, room_types(*))").eq("status","checked_in"),f=(g==null?void 0:g.length)||0,p=C>0?f/C*100:0,{data:w}=await T.from("reservations").select("*").eq("check_in_date",x).eq("status","confirmed"),{data:S}=await T.from("bookings").select("*").eq("expected_check_out_date",x).eq("status","checked_in"),{data:k}=await T.from("payments").select("amount").gte("payment_date",`${x}T00:00:00`).lte("payment_date",`${x}T23:59:59`),j=(k==null?void 0:k.reduce((U,Q)=>U+Number(Q.amount),0))||0,{data:E}=await T.from("payments").select("amount").gte("payment_date",`${v}T00:00:00`),D=(E==null?void 0:E.reduce((U,Q)=>U+Number(Q.amount),0))||0,{data:A}=await T.from("reservations").select("*, guests(*), room_types(*)").eq("check_in_date",x).eq("status","confirmed"),W=(A==null?void 0:A.map(U=>({guest_name:U.guests.full_name,room_number:"TBA",room_type:U.room_types.name,check_in_date:U.check_in_date})))||[],{data:ee}=await T.from("bookings").select("*, guests(*), rooms(*, room_types(*))").eq("expected_check_out_date",x).eq("status","checked_in"),R=(ee==null?void 0:ee.map(U=>({guest_name:U.guests.full_name,room_number:U.rooms.room_number,room_type:U.rooms.room_types.name,check_out_date:U.expected_check_out_date})))||[];s({todayArrivals:(w==null?void 0:w.length)||0,todayDepartures:(S==null?void 0:S.length)||0,inHouseGuests:f,occupancyRate:p,todayRevenue:j,monthRevenue:D,totalRooms:C}),i(W),l(R)}catch(x){console.error("Error loading report data:",x)}finally{d(!1)}};return c?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading reports..."})]})})}):n.jsx(ke,{children:n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Reports"}),n.jsx("p",{className:"text-gray-600",children:"Business insights and operational reports"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"date",value:u,onChange:x=>h(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),n.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Fl,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Today's Arrivals"}),n.jsx(yt,{className:"w-5 h-5 text-green-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-gray-800",children:r.todayArrivals})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Today's Departures"}),n.jsx(yt,{className:"w-5 h-5 text-orange-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-gray-800",children:r.todayDepartures})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"In-House Guests"}),n.jsx(Da,{className:"w-5 h-5 text-blue-600"})]}),n.jsx("p",{className:"text-3xl font-bold text-gray-800",children:r.inHouseGuests})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Occupancy Rate"}),n.jsx(xd,{className:"w-5 h-5 text-blue-600"})]}),n.jsxs("p",{className:"text-3xl font-bold text-gray-800",children:[r.occupancyRate.toFixed(1),"%"]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.inHouseGuests," of ",r.totalRooms," rooms"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Today's Revenue"}),n.jsx(lm,{className:"w-5 h-5 text-green-600"})]}),n.jsxs("p",{className:"text-4xl font-bold text-green-600",children:["",r.todayRevenue.toFixed(0)]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Month-to-Date Revenue"}),n.jsx(xd,{className:"w-5 h-5 text-blue-600"})]}),n.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:["",r.monthRevenue.toFixed(0)]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[n.jsx("div",{className:"border-b",children:n.jsxs("nav",{className:"flex space-x-8 px-6",children:[n.jsx("button",{onClick:()=>e("arrivals"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="arrivals"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Arrivals List"}),n.jsx("button",{onClick:()=>e("departures"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="departures"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Departures List"})]})}),n.jsxs("div",{className:"p-6",children:[t==="arrivals"&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Expected Arrivals"}),n.jsxs("div",{className:"overflow-x-auto",children:[n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guest Name"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room Type"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check-In Date"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map((x,v)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:x.guest_name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x.room_type}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(x.check_in_date).toLocaleDateString()})]},v))})]}),a.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No arrivals scheduled for this date"})]})]}),t==="departures"&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Expected Departures"}),n.jsxs("div",{className:"overflow-x-auto",children:[n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guest Name"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room Number"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room Type"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check-Out Date"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map((x,v)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:x.guest_name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x.room_number}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x.room_type}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(x.check_out_date).toLocaleDateString()})]},v))})]}),o.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No departures scheduled for this date"})]})]})]})]})]})})}function Gx(){const[t,e]=N.useState("room-types"),[r,s]=N.useState([]),[a,i]=N.useState([]),[o,l]=N.useState(!1),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,x]=N.useState(null),[v,_]=N.useState([]),[C,g]=N.useState(!1);N.useEffect(()=>{p(),w()},[]);const f=N.useCallback(async()=>{g(!0);try{const{data:D}=await T.from("login_logs").select("*").order("login_time",{ascending:!1}).limit(100);_(D||[])}catch(D){console.error("Error loading login logs:",D)}finally{g(!1)}},[]);N.useEffect(()=>{t==="audit-logs"&&f()},[t,f]);const p=async()=>{const{data:D}=await T.from("room_types").select("*").order("name");s(D||[])},w=async()=>{const{data:D}=await T.from("rooms").select("*").order("room_number");i(D||[])},S=async D=>{D.preventDefault();const A=new FormData(D.currentTarget),W={name:A.get("name"),base_rate:parseFloat(A.get("base_rate")),max_occupancy:parseInt(A.get("max_occupancy")),description:A.get("description")};u?await T.from("room_types").update(W).eq("id",u.id):await T.from("room_types").insert([W]),p(),l(!1),h(null)},k=async D=>{D.preventDefault();const A=new FormData(D.currentTarget),W={room_number:A.get("room_number"),room_type_id:A.get("room_type_id"),floor:parseInt(A.get("floor")),status:A.get("status")};m?await T.from("rooms").update(W).eq("id",m.id):await T.from("rooms").insert([W]),w(),d(!1),x(null)},j=async D=>{confirm("Are you sure you want to delete this room type?")&&(await T.from("room_types").delete().eq("id",D),p())},E=async D=>{confirm("Are you sure you want to delete this room?")&&(await T.from("rooms").delete().eq("id",D),w())};return n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Settings"}),n.jsx("p",{className:"text-gray-600",children:"Manage room types, rooms, and system configuration"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[n.jsx("div",{className:"border-b",children:n.jsxs("nav",{className:"flex space-x-8 px-6",children:[n.jsx("button",{onClick:()=>e("room-types"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="room-types"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Room Types"}),n.jsx("button",{onClick:()=>e("rooms"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="rooms"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Rooms"}),n.jsx("button",{onClick:()=>e("taxes"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="taxes"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Tax Configuration"}),n.jsxs("button",{onClick:()=>e("audit-logs"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-1 ${t==="audit-logs"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:[n.jsx(Cr,{className:"w-4 h-4"}),"Audit Logs"]})]})}),n.jsxs("div",{className:"p-6",children:[t==="room-types"&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Room Types"}),n.jsxs("button",{onClick:()=>{h(null),l(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Room Type"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Base Rate"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Max Occupancy"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(D=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:D.name}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:["",D.base_rate]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:D.max_occupancy}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:D.description}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:[n.jsx("button",{onClick:()=>{h(D),l(!0)},className:"text-blue-600 hover:text-blue-800 mr-3",children:n.jsx(zo,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>j(D.id),className:"text-red-600 hover:text-red-800",children:n.jsx(Fo,{className:"w-4 h-4"})})]})]},D.id))})]})})]}),t==="rooms"&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Rooms"}),n.jsxs("button",{onClick:()=>{x(null),d(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Room"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room Number"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Floor"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(D=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:D.room_number}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:D.floor}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:D.status.replace(/_/g," ")}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:[n.jsx("button",{onClick:()=>{x(D),d(!0)},className:"text-blue-600 hover:text-blue-800 mr-3",children:n.jsx(zo,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>E(D.id),className:"text-red-600 hover:text-red-800",children:n.jsx(Fo,{className:"w-4 h-4"})})]})]},D.id))})]})})]}),t==="taxes"&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Tax Configuration"}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"Default GST rates are configured at 6% CGST and 6% SGST (total 12%)."})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:"CGST"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Central Goods and Services Tax"})]}),n.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"6%"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:"SGST"}),n.jsx("p",{className:"text-sm text-gray-600",children:"State Goods and Services Tax"})]}),n.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"6%"})]})]})]}),t==="audit-logs"&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Login Audit Logs"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Track all PMS login activity for accountability"})]}),n.jsxs("button",{onClick:f,disabled:C,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition disabled:opacity-50",children:[n.jsx(Nx,{className:`w-4 h-4 mr-2 ${C?"animate-spin":""}`}),"Refresh"]})]}),C?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):v.length===0?n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[n.jsx(Cr,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No login records found"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Login activity will appear here after users sign in"})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Login Time"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Browser"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:v.map(D=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:D.user_name||"Unknown"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:D.user_email}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(D.login_time).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:D.user_agent?D.user_agent.includes("Chrome")?"Chrome":D.user_agent.includes("Firefox")?"Firefox":D.user_agent.includes("Safari")?"Safari":D.user_agent.includes("Edge")?"Edge":"Other":"-"})]},D.id))})]})})]})]})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:u?"Edit Room Type":"Add Room Type"}),n.jsxs("form",{onSubmit:S,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),n.jsx("input",{type:"text",name:"name",defaultValue:u==null?void 0:u.name,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base Rate ()"}),n.jsx("input",{type:"number",name:"base_rate",defaultValue:u==null?void 0:u.base_rate,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Occupancy"}),n.jsx("input",{type:"number",name:"max_occupancy",defaultValue:(u==null?void 0:u.max_occupancy)||2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{name:"description",defaultValue:u==null?void 0:u.description,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>{l(!1),h(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})]})]})]})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:m?"Edit Room":"Add Room"}),n.jsxs("form",{onSubmit:k,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room Number"}),n.jsx("input",{type:"text",name:"room_number",defaultValue:m==null?void 0:m.room_number,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room Type"}),n.jsxs("select",{name:"room_type_id",defaultValue:m==null?void 0:m.room_type_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"Select Room Type"}),r.map(D=>n.jsx("option",{value:D.id,children:D.name},D.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),n.jsx("input",{type:"number",name:"floor",defaultValue:m==null?void 0:m.floor,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{name:"status",defaultValue:(m==null?void 0:m.status)||"vacant_clean",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"vacant_clean",children:"Vacant Clean"}),n.jsx("option",{value:"vacant_dirty",children:"Vacant Dirty"}),n.jsx("option",{value:"occupied",children:"Occupied"}),n.jsx("option",{value:"out_of_order",children:"Out of Order"})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>{d(!1),x(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})]})]})]})})]})}function Kx(){var Te,Pr;const{user:t}=Mt(),[e,r]=N.useState([]),[s,a]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(()=>{const L=new Date;return L.setHours(0,0,0,0),L}),[d,u]=N.useState(!0),[h,m]=N.useState(null),[x,v]=N.useState(null),[_,C]=N.useState("14days"),[g,f]=N.useState([]),[p,w]=N.useState(!1),[S,k]=N.useState(!1),[j,E]=N.useState(null),D=_==="14days"?14:30,A=N.useMemo(()=>{const L=[];for(let F=0;F<D;F++){const Z=new Date(l);Z.setDate(l.getDate()+F),L.push(Z)}return L},[l,D]),W=N.useMemo(()=>A.map(L=>{const F=L.toISOString().split("T")[0];let Z=0;return e.forEach(J=>{const oe=s.some(re=>{if(re.room_id!==J.id)return!1;const De=new Date(re.check_in_date).toISOString().split("T")[0],rt=re.actual_check_out_date?new Date(re.actual_check_out_date).toISOString().split("T")[0]:new Date(re.expected_check_out_date).toISOString().split("T")[0];return F>=De&&F<rt}),ne=i.some(re=>{if(re.assigned_room_id!==J.id)return!1;const De=re.check_in_date,rt=re.check_out_date;return F>=De&&F<rt});(oe||ne)&&Z++}),{date:F,occupied:Z,total:e.length,percentage:e.length>0?Math.round(Z/e.length*100):0}}),[A,e,s,i]),ee=N.useCallback(async()=>{u(!0);try{const{data:L}=await T.from("rooms").select("*, room_types(*)").order("room_number"),F=new Date(l);F.setDate(l.getDate()+D);const{data:Z}=await T.from("bookings").select("*, guests(*), rooms(*)").or(`check_in_date.lte.${F.toISOString()},expected_check_out_date.gte.${l.toISOString()}`),{data:J}=await T.from("reservations").select("*, guests(*), room_types(*)").eq("status","confirmed").or(`check_in_date.lte.${F.toISOString().split("T")[0]},check_out_date.gte.${l.toISOString().split("T")[0]}`),oe=L||[];r(oe),a(Z||[]),o(J||[]);const ne={};oe.forEach(re=>{const De=re.room_types.id;ne[De]||(ne[De]={id:De,name:re.room_types.name,rooms:[],isExpanded:!0}),ne[De].rooms.push(re)}),f(Object.values(ne))}catch(L){console.error("Error loading tape chart data:",L)}finally{u(!1)}},[l,D]);N.useEffect(()=>{ee()},[ee]),Za(ee);const R=L=>{const F=_==="14days"?7:14,Z=new Date(l);Z.setDate(l.getDate()+(L==="next"?F:-F)),c(Z)},U=()=>{const L=new Date;L.setHours(0,0,0,0),c(L)},Q=L=>{const F=new Date(L);F.setHours(0,0,0,0),c(F),w(!1)},te=L=>{f(F=>F.map(Z=>Z.id===L?{...Z,isExpanded:!Z.isExpanded}:Z))},b=(L,F)=>{const Z=F.toISOString().split("T")[0];return s.find(J=>{if(J.room_id!==L)return!1;const oe=new Date(J.check_in_date).toISOString().split("T")[0],ne=J.actual_check_out_date?new Date(J.actual_check_out_date).toISOString().split("T")[0]:new Date(J.expected_check_out_date).toISOString().split("T")[0];return Z>=oe&&Z<ne})||null},y=(L,F,Z)=>{const J=Z.toISOString().split("T")[0];return i.find(oe=>{if(oe.assigned_room_id&&oe.assigned_room_id!==L||!oe.assigned_room_id&&oe.room_type_id!==F)return!1;const ne=oe.check_in_date,re=oe.check_out_date;return J>=ne&&J<re})||null},I=(L,F)=>{const Z=new Date(L.check_in_date).toISOString().split("T")[0],J=F.toISOString().split("T")[0];return Z===J},O=(L,F)=>{const Z=L.check_in_date,J=F.toISOString().split("T")[0];return Z===J},q=(L,F)=>{const Z=L.actual_check_out_date?new Date(L.actual_check_out_date):new Date(L.expected_check_out_date);let J=0;const oe=new Date(F);for(;oe<Z&&J<D&&A.findIndex(re=>re.toISOString().split("T")[0]===oe.toISOString().split("T")[0])!==-1;)J++,oe.setDate(oe.getDate()+1);return J},z=(L,F)=>{const Z=new Date(L.check_out_date);let J=0;const oe=new Date(F);for(;oe<Z&&J<D&&A.findIndex(re=>re.toISOString().split("T")[0]===oe.toISOString().split("T")[0])!==-1;)J++,oe.setDate(oe.getDate()+1);return J},$=L=>{switch(L.status){case"checked_in":return"bg-emerald-500 hover:bg-emerald-600 border-l-4 border-emerald-700";case"checked_out":return"bg-slate-400 hover:bg-slate-500 border-l-4 border-slate-600";default:return"bg-sky-500 hover:bg-sky-600 border-l-4 border-sky-700"}},B=()=>"bg-amber-400 hover:bg-amber-500 border-l-4 border-amber-600",H=(L,F)=>{E({roomId:L.id,roomNumber:L.room_number,roomTypeName:L.room_types.name,date:F}),k(!0)},V=async L=>{if(L.preventDefault(),!j)return;const F=new FormData(L.currentTarget),Z=F.get("guest_name"),J=F.get("guest_mobile"),oe=parseInt(F.get("nights"))||1;try{const{data:ne}=await T.from("guests").select("id").eq("mobile",J).single();let re=ne==null?void 0:ne.id;if(!re){const{data:Ut,error:ei}=await T.from("guests").insert([{full_name:Z,mobile:J}]).select().single();if(ei)throw ei;re=Ut==null?void 0:Ut.id}const De=e.find(Ut=>Ut.id===j.roomId);if(!De||!re)return;const rt=new Date(j.date);rt.setDate(rt.getDate()+oe);const{error:ys}=await T.from("reservations").insert([{guest_id:re,room_type_id:De.room_types.id,assigned_room_id:De.id,check_in_date:j.date.toISOString().split("T")[0],check_out_date:rt.toISOString().split("T")[0],number_of_guests:1,status:"confirmed",created_by:t==null?void 0:t.id}]);if(ys)throw ys;k(!1),E(null),ee(),alert("Reservation created successfully!")}catch(ne){console.error("Error creating reservation:",ne),alert("Failed to create reservation. Please try again.")}},he=L=>{const F=new Date;return L.toISOString().split("T")[0]===F.toISOString().split("T")[0]},Me=L=>{const F=L.getDay();return F===0||F===6},Ee=L=>L>=90?"text-red-600":L>=70?"text-orange-600":L>=50?"text-yellow-600":"text-green-600";return d?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading tape chart..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-full mx-auto",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Tape Chart"}),n.jsx("p",{className:"text-gray-600",children:"Visual room availability calendar"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[n.jsxs("button",{onClick:()=>C("14days"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${_==="14days"?"bg-white text-blue-600 shadow":"text-gray-600 hover:text-gray-800"}`,children:[n.jsx(im,{className:"w-4 h-4 inline mr-1"}),"2 Weeks"]}),n.jsxs("button",{onClick:()=>C("30days"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${_==="30days"?"bg-white text-blue-600 shadow":"text-gray-600 hover:text-gray-800"}`,children:[n.jsx(ux,{className:"w-4 h-4 inline mr-1"}),"Month"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>R("prev"),className:"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:n.jsx(mx,{className:"w-5 h-5"})}),n.jsx("button",{onClick:U,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium",children:"Today"}),n.jsx("button",{onClick:()=>w(!0),className:"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:n.jsx(yt,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>R("next"),className:"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:n.jsx(om,{className:"w-5 h-5"})})]})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:n.jsxs("div",{className:"flex flex-wrap gap-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-emerald-500 border-l-2 border-emerald-700"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Checked In"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-amber-400 border-l-2 border-amber-600"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Confirmed Reservation"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-sky-500 border-l-2 border-sky-700"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Pending"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-slate-400 border-l-2 border-slate-600"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Checked Out"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-white border-2 border-gray-200"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Available (Click to Reserve)"})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",style:{minWidth:_==="30days"?"1800px":"1000px"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-gray-800 text-white px-4 py-3 text-left font-semibold w-32 min-w-[120px]",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(wx,{className:"w-4 h-4"}),"Room"]})}),A.map((L,F)=>{var Z,J;return n.jsxs("th",{className:`px-1 py-2 text-center text-xs font-medium ${_==="30days"?"min-w-[50px]":"min-w-[70px]"} ${he(L)?"bg-blue-600 text-white":Me(L)?"bg-gray-100 text-gray-700":"bg-gray-800 text-white"}`,children:[n.jsx("div",{children:L.toLocaleDateString("en-IN",{weekday:"short"}).charAt(0)}),n.jsx("div",{className:_==="30days"?"text-sm":"text-lg",children:L.getDate()}),_==="14days"&&n.jsx("div",{children:L.toLocaleDateString("en-IN",{month:"short"})}),n.jsxs("div",{className:`text-[10px] font-bold ${he(L)?"text-white":Ee(((Z=W[F])==null?void 0:Z.percentage)||0)}`,children:[((J=W[F])==null?void 0:J.percentage)||0,"%"]})]},F)})]})}),n.jsx("tbody",{children:g.map(L=>n.jsxs(n.Fragment,{children:[n.jsx("tr",{className:"bg-gray-100",children:n.jsx("td",{colSpan:D+1,className:"sticky left-0 z-10",children:n.jsxs("button",{onClick:()=>te(L.id),className:"w-full flex items-center gap-2 px-4 py-2 text-left font-semibold text-gray-700 hover:bg-gray-200 transition",children:[L.isExpanded?n.jsx(hx,{className:"w-4 h-4"}):n.jsx(fx,{className:"w-4 h-4"}),L.name," (",L.rooms.length," rooms)"]})})},`group-${L.id}`),L.isExpanded&&L.rooms.map((F,Z)=>n.jsxs("tr",{className:Z%2===0?"bg-white":"bg-gray-50",children:[n.jsxs("td",{className:"sticky left-0 z-10 bg-inherit px-4 py-2 border-r border-gray-200",children:[n.jsx("div",{className:"text-base font-bold text-gray-800",children:F.room_number}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Floor ",F.floor]})]}),A.map((J,oe)=>{const ne=b(F.id,J),re=ne?null:y(F.id,F.room_types.id,J),De=ne&&I(ne,J),rt=re&&O(re,J),ys=ne&&De?q(ne,J):1,Ut=re&&rt?z(re,J):1;return ne&&!De||re&&!rt?null:n.jsx("td",{colSpan:De?ys:rt?Ut:1,className:`px-0.5 py-1 border border-gray-200 relative ${he(J)?"bg-blue-50":""}`,children:De&&ne?n.jsxs("button",{onClick:()=>m(ne),className:`w-full text-white text-xs px-1 py-1.5 rounded ${$(ne)} transition truncate text-left`,children:[n.jsx("div",{className:"font-medium truncate",children:ne.guests.full_name}),ys>1&&n.jsx("div",{className:"opacity-80 truncate text-[10px]",children:ne.status==="checked_in"?" In":"Res"})]}):rt&&re?n.jsxs("button",{onClick:()=>v(re),className:`w-full text-white text-xs px-1 py-1.5 rounded ${B()} transition truncate text-left`,children:[n.jsx("div",{className:"font-medium truncate",children:re.guests.full_name}),Ut>1&&n.jsx("div",{className:"opacity-80 truncate text-[10px]",children:" Res"})]}):n.jsx("button",{onClick:()=>H(F,J),className:"w-full h-8 rounded border border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 transition group",children:n.jsx(Er,{className:"w-3 h-3 text-gray-300 group-hover:text-blue-500 mx-auto"})})},oe)})]},F.id))]}))})]})})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Total Rooms"}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:e.length})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Currently Occupied"}),n.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:s.filter(L=>L.status==="checked_in").length})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Upcoming Reservations"}),n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:i.filter(L=>L.status==="confirmed").length})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Today's Occupancy"}),n.jsxs("div",{className:`text-2xl font-bold ${Ee(((Te=W[0])==null?void 0:Te.percentage)||0)}`,children:[((Pr=W[0])==null?void 0:Pr.percentage)||0,"%"]})]})]})]}),p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Go to Date"}),n.jsx("button",{onClick:()=>w(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsx("input",{type:"date",defaultValue:l.toISOString().split("T")[0],onChange:L=>Q(L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg"})]})}),h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Booking Details"}),n.jsx("button",{onClick:()=>m(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(nr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:h.guests.full_name}),n.jsx("div",{className:"text-sm text-gray-500",children:"Guest Name"})]})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(hn,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:h.guests.mobile}),n.jsx("div",{className:"text-sm text-gray-500",children:"Mobile"})]})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium text-gray-800",children:[new Date(h.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),"  ",new Date(h.expected_check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})]}),n.jsx("div",{className:"text-sm text-gray-500",children:"Stay Dates"})]})]}),n.jsxs("div",{className:"pt-4 border-t",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Room"}),n.jsx("span",{className:"font-medium",children:h.rooms.room_number})]}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Guests"}),n.jsx("span",{className:"font-medium",children:h.number_of_guests})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Status"}),n.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${h.status==="checked_in"?"bg-emerald-100 text-emerald-800":"bg-gray-100 text-gray-800"}`,children:h.status==="checked_in"?"In-House":h.status})]})]})]})]})}),x&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Reservation Details"}),n.jsx("button",{onClick:()=>v(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-lg",children:[n.jsx(nr,{className:"w-5 h-5 text-amber-600"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:x.guests.full_name}),n.jsx("div",{className:"text-sm text-gray-500",children:"Guest Name"})]})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(hn,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:x.guests.mobile}),n.jsx("div",{className:"text-sm text-gray-500",children:"Mobile"})]})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium text-gray-800",children:[new Date(x.check_in_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),"  ",new Date(x.check_out_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})]}),n.jsx("div",{className:"text-sm text-gray-500",children:"Reservation Dates"})]})]}),n.jsxs("div",{className:"pt-4 border-t",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Room Type"}),n.jsx("span",{className:"font-medium",children:x.room_types.name})]}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-gray-600",children:"Guests"}),n.jsx("span",{className:"font-medium",children:x.number_of_guests})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Status"}),n.jsx("span",{className:"px-2 py-1 rounded text-sm font-medium bg-amber-100 text-amber-800",children:"Confirmed"})]})]})]})]})}),S&&j&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Quick Reservation"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Room ",j.roomNumber,"  ",j.roomTypeName]})]}),n.jsx("button",{onClick:()=>{k(!1),E(null)},className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("form",{onSubmit:V,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-in Date"}),n.jsx("input",{type:"text",value:j.date.toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"}),disabled:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Nights"}),n.jsx("input",{type:"number",name:"nights",defaultValue:1,min:1,max:30,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guest Name"}),n.jsx("input",{type:"text",name:"guest_name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),n.jsx("input",{type:"tel",name:"guest_mobile",pattern:"[0-9]{10}",placeholder:"10-digit mobile",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx("button",{type:"button",onClick:()=>{k(!1),E(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Reservation"})]})]})]})})]})}function Qx(){const{user:t}=Mt(),[e,r]=N.useState({totalRooms:0,occupiedRooms:0,vacantClean:0,vacantDirty:0,checkInsToday:0,checkOutsToday:0,stayovers:0,todayRevenue:0,pendingCharges:0}),[s,a]=N.useState([]),[i,o]=N.useState(!0),[l,c]=N.useState(!1),[d,u]=N.useState(!1),[h,m]=N.useState(!1),[x,v]=N.useState(null),_=new Date().toISOString().split("T")[0],C=new Date().toLocaleDateString("en-IN",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}),g=N.useCallback(async()=>{o(!0);try{const{data:w}=await T.from("rooms").select("*"),{data:S}=await T.from("bookings").select("*, guests(*), rooms(*, room_types(*))").eq("status","checked_in"),{data:k}=await T.from("bookings").select("*").gte("check_in_date",`${_}T00:00:00`).lte("check_in_date",`${_}T23:59:59`),{data:j}=await T.from("bookings").select("*").eq("status","checked_out").gte("actual_check_out_date",`${_}T00:00:00`).lte("actual_check_out_date",`${_}T23:59:59`),{data:E}=await T.from("payments").select("amount").gte("payment_date",`${_}T00:00:00`).lte("payment_date",`${_}T23:59:59`),D=(E==null?void 0:E.reduce((W,ee)=>W+Number(ee.amount),0))||0,A=(S==null?void 0:S.filter(W=>new Date(W.check_in_date).toISOString().split("T")[0]<_).length)||0;r({totalRooms:(w==null?void 0:w.length)||0,occupiedRooms:(w==null?void 0:w.filter(W=>W.status==="occupied").length)||0,vacantClean:(w==null?void 0:w.filter(W=>W.status==="vacant_clean").length)||0,vacantDirty:(w==null?void 0:w.filter(W=>W.status==="vacant_dirty").length)||0,checkInsToday:(k==null?void 0:k.length)||0,checkOutsToday:(j==null?void 0:j.length)||0,stayovers:A,todayRevenue:D,pendingCharges:A}),a(S||[])}catch(w){console.error("Error loading audit data:",w)}finally{o(!1)}},[_]);N.useEffect(()=>{g()},[g]);const f=async()=>{c(!0);try{let w=0,S=0;for(const k of s)if(new Date(k.check_in_date).toISOString().split("T")[0]<_){const E=k.rooms.room_types.base_rate,{data:D}=await T.from("folio_charges").select("*").eq("booking_id",k.id).eq("charge_date",_).eq("charge_type","room_rent");(!D||D.length===0)&&(await T.from("folio_charges").insert([{booking_id:k.id,charge_date:_,description:`Room Rent - ${k.rooms.room_number} (${k.rooms.room_types.name})`,amount:E,charge_type:"room_rent",posted_by:t==null?void 0:t.id}]),w++,S+=E)}v({chargesPosted:w,totalAmount:S}),m(!0),u(!1)}catch(w){console.error("Error running night audit:",w),alert("Error running night audit. Please try again.")}finally{c(!1)}},p=e.totalRooms>0?Math.round(e.occupiedRooms/e.totalRooms*100):0;return i?n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading audit data..."})]})})}):n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"mb-8",children:n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:n.jsx(dm,{className:"w-8 h-8 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Night Audit"}),n.jsx("p",{className:"text-gray-600",children:C})]})]})}),h&&x&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-8",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(un,{className:"w-8 h-8 text-green-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Night Audit Complete!"}),n.jsxs("p",{className:"text-green-700",children:["Posted ",x.chargesPosted," room charges totaling ",x.totalAmount.toFixed(2)]})]})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Occupancy Rate"}),n.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[p,"%"]}),n.jsxs("div",{className:"text-xs text-gray-500",children:[e.occupiedRooms," of ",e.totalRooms," rooms"]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Today's Revenue"}),n.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",e.todayRevenue.toFixed(0)]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Check-Ins Today"}),n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.checkInsToday})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Check-Outs Today"}),n.jsx("div",{className:"text-2xl font-bold text-orange-600",children:e.checkOutsToday})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(Xa,{className:"w-5 h-5 text-gray-600"}),"Room Status Summary"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[n.jsx("span",{className:"text-gray-600",children:"Occupied"}),n.jsx("span",{className:"font-semibold text-red-600",children:e.occupiedRooms})]}),n.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[n.jsx("span",{className:"text-gray-600",children:"Vacant Clean"}),n.jsx("span",{className:"font-semibold text-green-600",children:e.vacantClean})]}),n.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[n.jsx("span",{className:"text-gray-600",children:"Vacant Dirty"}),n.jsx("span",{className:"font-semibold text-yellow-600",children:e.vacantDirty})]}),n.jsxs("div",{className:"flex justify-between items-center py-2",children:[n.jsx("span",{className:"text-gray-600",children:"Total Rooms"}),n.jsx("span",{className:"font-semibold text-gray-800",children:e.totalRooms})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-600"}),"Pending Actions"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[n.jsx("span",{className:"text-gray-600",children:"Stayover Guests"}),n.jsx("span",{className:"font-semibold text-gray-800",children:e.stayovers})]}),n.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[n.jsx("span",{className:"text-gray-600",children:"Room Charges to Post"}),n.jsx("span",{className:"font-semibold text-indigo-600",children:e.pendingCharges})]}),n.jsxs("div",{className:"flex justify-between items-center py-2",children:[n.jsx("span",{className:"text-gray-600",children:"Rooms Needing Cleaning"}),n.jsx("span",{className:"font-semibold text-yellow-600",children:e.vacantDirty})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-8",children:[n.jsxs("div",{className:"p-6 border-b",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Stayover Guests (",e.stayovers,")"]}),n.jsx("p",{className:"text-sm text-gray-600",children:"Room charges will be posted for these guests"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500",children:"Room"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500",children:"Guest"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500",children:"Room Type"}),n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"Rate"})]})}),n.jsxs("tbody",{className:"divide-y",children:[s.filter(w=>new Date(w.check_in_date).toISOString().split("T")[0]<_).map(w=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 font-medium text-gray-800",children:w.rooms.room_number}),n.jsx("td",{className:"px-4 py-3 text-gray-700",children:w.guests.full_name}),n.jsx("td",{className:"px-4 py-3 text-gray-600",children:w.rooms.room_types.name}),n.jsxs("td",{className:"px-4 py-3 text-right font-medium text-gray-800",children:["",w.rooms.room_types.base_rate.toFixed(2)]})]},w.id)),e.stayovers===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-gray-500",children:"No stayover guests for tonight"})})]})]})})]}),!h&&n.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold mb-1",children:"Ready to Run Night Audit?"}),n.jsxs("p",{className:"opacity-90",children:["This will post room charges for all ",e.stayovers," stayover guests"]})]}),n.jsx("button",{onClick:()=>u(!0),disabled:e.stayovers===0,className:"px-6 py-3 bg-white text-indigo-600 font-semibold rounded-lg hover:bg-gray-100 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Run Night Audit"})]})})]}),d&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(am,{className:"w-6 h-6 text-indigo-600"}),"Confirm Night Audit"]}),n.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg mb-4",children:[n.jsx("p",{className:"text-indigo-800",children:"This action will:"}),n.jsxs("ul",{className:"mt-2 space-y-1 text-indigo-700",children:[n.jsxs("li",{children:[" Post room charges for ",e.stayovers," stayover guests"]}),n.jsx("li",{children:" Add daily room rent to each guest's folio"})]})]}),n.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to proceed?"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:f,disabled:l,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:l?"Processing...":"Confirm"})]})]})})]})}const Jx=[{day:0,name:"Sunday",multiplier:1},{day:1,name:"Monday",multiplier:1},{day:2,name:"Tuesday",multiplier:1},{day:3,name:"Wednesday",multiplier:1},{day:4,name:"Thursday",multiplier:1},{day:5,name:"Friday",multiplier:1.2},{day:6,name:"Saturday",multiplier:1.3}];function Yx(){const[t,e]=N.useState([]),[r,s]=N.useState([]),[a,i]=N.useState(Jx),[o,l]=N.useState(!0),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,x]=N.useState(new Date),[v,_]=N.useState({name:"",start_date:"",end_date:"",multiplier:1}),C=N.useCallback(async()=>{l(!0);try{const{data:R}=await T.from("room_types").select("*").order("name");e(R||[]);const U=localStorage.getItem("sharda_seasonal_rates");U&&s(JSON.parse(U));const Q=localStorage.getItem("sharda_day_rates");Q&&i(JSON.parse(Q))}catch(R){console.error("Error loading rate data:",R)}finally{l(!1)}},[]);N.useEffect(()=>{C()},[C]);const g=R=>{localStorage.setItem("sharda_seasonal_rates",JSON.stringify(R)),s(R)},f=R=>{localStorage.setItem("sharda_day_rates",JSON.stringify(R)),i(R)},p=()=>{h(null),_({name:"",start_date:"",end_date:"",multiplier:1}),d(!0)},w=R=>{h(R),_({name:R.name,start_date:R.start_date,end_date:R.end_date,multiplier:R.multiplier}),d(!0)},S=R=>{if(R.preventDefault(),u){const U=r.map(Q=>Q.id===u.id?{...Q,...v}:Q);g(U)}else{const U={id:Date.now().toString(),...v,is_active:!0};g([...r,U])}d(!1)},k=R=>{confirm("Delete this seasonal rate?")&&g(r.filter(U=>U.id!==R))},j=(R,U)=>{const Q=a.map(te=>te.day===R?{...te,multiplier:U}:te);f(Q)},E=(R,U)=>{let Q=R;const te=a.find(I=>I.day===U.getDay());te&&(Q*=te.multiplier);const b=U.toISOString().split("T")[0],y=r.find(I=>I.is_active&&b>=I.start_date&&b<=I.end_date);return y&&(Q*=y.multiplier),Math.round(Q)},D=()=>{const R=m.getFullYear(),U=m.getMonth(),Q=new Date(R,U,1),te=new Date(R,U+1,0),b=[];for(let y=0;y<Q.getDay();y++)b.push(null);for(let y=1;y<=te.getDate();y++)b.push(new Date(R,U,y));return b},A=R=>{const U=new Date(m);U.setMonth(m.getMonth()+(R==="next"?1:-1)),x(U)},W=R=>{const U=R.toISOString().split("T")[0];return r.find(Q=>Q.is_active&&U>=Q.start_date&&U<=Q.end_date)};if(o)return n.jsx(ke,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading rate calendar..."})]})})});const ee=D();return n.jsxs(ke,{children:[n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:n.jsx(yt,{className:"w-8 h-8 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Rate Calendar"}),n.jsx("p",{className:"text-gray-600",children:"Manage seasonal and day-of-week pricing"})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Day of Week Rates"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Multiplier applied to base rate"}),n.jsx("div",{className:"space-y-3",children:a.map(R=>n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:`text-gray-700 ${R.day===0||R.day===6?"font-semibold":""}`,children:R.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",step:"0.1",min:"0.5",max:"3",value:R.multiplier,onChange:U=>j(R.day,parseFloat(U.target.value)||1),className:"w-20 px-2 py-1 border rounded text-center text-sm"}),n.jsx("span",{className:"text-xs text-gray-500",children:""})]})]},R.day))})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Seasonal Rates"}),n.jsx("button",{onClick:p,className:"p-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition",children:n.jsx(Er,{className:"w-4 h-4"})})]}),r.length===0?n.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No seasonal rates configured"}):n.jsx("div",{className:"space-y-3",children:r.map(R=>n.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"font-medium text-gray-800",children:R.name}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>w(R),className:"p-1 hover:bg-gray-200 rounded",children:n.jsx(zo,{className:"w-4 h-4 text-gray-500"})}),n.jsx("button",{onClick:()=>k(R.id),className:"p-1 hover:bg-red-100 rounded",children:n.jsx(Fo,{className:"w-4 h-4 text-red-500"})})]})]}),n.jsxs("div",{className:"text-xs text-gray-600",children:[new Date(R.start_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short"})," - ",new Date(R.end_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short"})]}),n.jsxs("div",{className:"text-sm font-medium text-emerald-600",children:[R.multiplier," multiplier"]})]},R.id))})]})]}),n.jsx("div",{className:"lg:col-span-2",children:n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[n.jsx("button",{onClick:()=>A("prev"),className:"px-3 py-1 bg-gray-100 rounded hover:bg-gray-200",children:" Prev"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:m.toLocaleDateString("en-IN",{month:"long",year:"numeric"})}),n.jsx("button",{onClick:()=>A("next"),className:"px-3 py-1 bg-gray-100 rounded hover:bg-gray-200",children:"Next "})]}),n.jsx("div",{className:"p-4 border-b bg-gray-50",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Preview rates for:"}),n.jsx("select",{className:"px-3 py-1 border rounded text-sm",children:t.map(R=>n.jsxs("option",{value:R.id,children:[R.name," (Base: ",R.base_rate,")"]},R.id))})]})}),n.jsxs("div",{className:"p-4",children:[n.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(R=>n.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-2",children:R},R))}),n.jsx("div",{className:"grid grid-cols-7 gap-1",children:ee.map((R,U)=>{var O;if(!R)return n.jsx("div",{className:"p-2"},`empty-${U}`);const Q=W(R),te=((O=t[0])==null?void 0:O.base_rate)||1e3,b=E(te,R),y=R.getDay()===0||R.getDay()===6,I=R.toISOString().split("T")[0]===new Date().toISOString().split("T")[0];return n.jsxs("div",{className:`p-2 border rounded text-center min-h-[70px] ${Q?"bg-emerald-50 border-emerald-200":y?"bg-blue-50 border-blue-200":"bg-white"} ${I?"ring-2 ring-blue-500":""}`,children:[n.jsx("div",{className:`text-sm font-medium ${I?"text-blue-600":"text-gray-700"}`,children:R.getDate()}),n.jsxs("div",{className:"text-xs text-gray-600 mt-1 flex items-center justify-center",children:[n.jsx(Ca,{className:"w-3 h-3"}),b]}),Q&&n.jsx("div",{className:"text-[10px] text-emerald-600 truncate mt-1",children:Q.name})]},R.toISOString())})})]}),n.jsx("div",{className:"p-4 border-t bg-gray-50",children:n.jsxs("div",{className:"flex flex-wrap gap-4 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-white border"}),n.jsx("span",{children:"Weekday"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-blue-50 border border-blue-200"}),n.jsx("span",{children:"Weekend"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-emerald-50 border border-emerald-200"}),n.jsx("span",{children:"Seasonal"})]})]})})]})})]})]}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:u?"Edit Season":"Add Season"}),n.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:n.jsx(je,{className:"w-5 h-5 text-gray-500"})})]}),n.jsxs("form",{onSubmit:S,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Season Name"}),n.jsx("input",{type:"text",value:v.name,onChange:R=>_({...v,name:R.target.value}),placeholder:"e.g., Diwali Festival, Summer Peak",className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),n.jsx("input",{type:"date",value:v.start_date,onChange:R=>_({...v,start_date:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),n.jsx("input",{type:"date",value:v.end_date,onChange:R=>_({...v,end_date:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rate Multiplier"}),n.jsx("input",{type:"number",step:"0.1",min:"0.5",max:"5",value:v.multiplier,onChange:R=>_({...v,multiplier:parseFloat(R.target.value)||1}),className:"w-full px-3 py-2 border rounded-lg",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"1.0 = normal rate, 1.5 = 50% increase, 0.8 = 20% discount"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2",children:[n.jsx(un,{className:"w-4 h-4"}),"Save"]})]})]})]})})]})}function Xx(){const[t,e]=N.useState("dashboard");N.useEffect(()=>{const s=()=>{const a=window.location.hash.slice(1);e(a||"dashboard")};return window.addEventListener("hashchange",s),s(),()=>window.removeEventListener("hashchange",s)},[]);const r=()=>{switch(t){case"tapechart":return n.jsx(Kx,{});case"reservations":return n.jsx(Rx,{});case"checkin":return n.jsx(Vx,{});case"guests":return n.jsx(Bx,{});case"inhouse":return n.jsx(Hx,{});case"reports":return n.jsx(Wx,{});case"settings":return n.jsx(Gx,{});case"nightaudit":return n.jsx(Qx,{});case"ratecalendar":return n.jsx(Yx,{});default:return n.jsx(Dx,{})}};return n.jsx(ax,{children:n.jsx(Ex,{children:r()})})}Oh(document.getElementById("root")).render(n.jsx(N.StrictMode,{children:n.jsx(Xx,{})}));
